
<html>
<head>

  <meta http-equiv="Content-Type" content="text/html; charset=US-ASCII" />
  <title>pim_vty.c</title>

  <link rel="stylesheet" href="../style.css"/>
  <script src="../jquery-3.5.1.min.js"></script>
</head>
<body>

<pre><code class = "cpp">
<a name="ln1">/*</a>
<a name="ln2">  PIM for Quagga</a>
<a name="ln3">  Copyright (C) 2008  Everton da Silva Marques</a>
<a name="ln4"> </a>
<a name="ln5">  This program is free software; you can redistribute it and/or modify</a>
<a name="ln6">  it under the terms of the GNU General Public License as published by</a>
<a name="ln7">  the Free Software Foundation; either version 2 of the License, or</a>
<a name="ln8">  (at your option) any later version.</a>
<a name="ln9"> </a>
<a name="ln10">  This program is distributed in the hope that it will be useful, but</a>
<a name="ln11">  WITHOUT ANY WARRANTY; without even the implied warranty of</a>
<a name="ln12">  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</a>
<a name="ln13">  General Public License for more details.</a>
<a name="ln14">  </a>
<a name="ln15">  You should have received a copy of the GNU General Public License</a>
<a name="ln16">  along with this program; see the file COPYING; if not, write to the</a>
<a name="ln17">  Free Software Foundation, Inc., 51 Franklin St, Fifth Floor, Boston,</a>
<a name="ln18">  MA 02110-1301 USA</a>
<a name="ln19">  </a>
<a name="ln20">  $QuaggaId: $Format:%an, %ai, %h$ $</a>
<a name="ln21">*/</a>
<a name="ln22"> </a>
<a name="ln23">#include &lt;zebra.h&gt;</a>
<a name="ln24"> </a>
<a name="ln25">#include &quot;if.h&quot;</a>
<a name="ln26">#include &quot;linklist.h&quot;</a>
<a name="ln27"> </a>
<a name="ln28">#include &quot;pimd.h&quot;</a>
<a name="ln29">#include &quot;pim_vty.h&quot;</a>
<a name="ln30">#include &quot;pim_iface.h&quot;</a>
<a name="ln31">#include &quot;pim_cmd.h&quot;</a>
<a name="ln32">#include &quot;pim_str.h&quot;</a>
<a name="ln33">#include &quot;pim_ssmpingd.h&quot;</a>
<a name="ln34">#include &quot;pim_pim.h&quot;</a>
<a name="ln35">#include &quot;pim_static.h&quot;</a>
<a name="ln36"> </a>
<a name="ln37">int pim_debug_config_write(struct vty *vty)</a>
<a name="ln38">{</a>
<a name="ln39">  int writes = 0;</a>
<a name="ln40"> </a>
<a name="ln41">  if (PIM_DEBUG_IGMP_EVENTS) {</a>
<a name="ln42">    vty_out(vty, &quot;debug igmp events%s&quot;, VTY_NEWLINE);</a>
<a name="ln43">    ++writes;</a>
<a name="ln44">  }</a>
<a name="ln45">  if (PIM_DEBUG_IGMP_PACKETS) {</a>
<a name="ln46">    vty_out(vty, &quot;debug igmp packets%s&quot;, VTY_NEWLINE);</a>
<a name="ln47">    ++writes;</a>
<a name="ln48">  }</a>
<a name="ln49">  if (PIM_DEBUG_IGMP_TRACE) {</a>
<a name="ln50">    vty_out(vty, &quot;debug igmp trace%s&quot;, VTY_NEWLINE);</a>
<a name="ln51">    ++writes;</a>
<a name="ln52">  }</a>
<a name="ln53"> </a>
<a name="ln54">  if (PIM_DEBUG_MROUTE) {</a>
<a name="ln55">    vty_out(vty, &quot;debug mroute%s&quot;, VTY_NEWLINE);</a>
<a name="ln56">    ++writes;</a>
<a name="ln57">  }</a>
<a name="ln58"> </a>
<a name="ln59">  if (PIM_DEBUG_PIM_EVENTS) {</a>
<a name="ln60">    vty_out(vty, &quot;debug pim events%s&quot;, VTY_NEWLINE);</a>
<a name="ln61">    ++writes;</a>
<a name="ln62">  }</a>
<a name="ln63">  if (PIM_DEBUG_PIM_PACKETS) {</a>
<a name="ln64">    vty_out(vty, &quot;debug pim packets%s&quot;, VTY_NEWLINE);</a>
<a name="ln65">    ++writes;</a>
<a name="ln66">  }</a>
<a name="ln67">  if (PIM_DEBUG_PIM_PACKETDUMP_SEND) {</a>
<a name="ln68">    vty_out(vty, &quot;debug pim packet-dump send%s&quot;, VTY_NEWLINE);</a>
<a name="ln69">    ++writes;</a>
<a name="ln70">  }</a>
<a name="ln71">  if (PIM_DEBUG_PIM_PACKETDUMP_RECV) {</a>
<a name="ln72">    vty_out(vty, &quot;debug pim packet-dump receive%s&quot;, VTY_NEWLINE);</a>
<a name="ln73">    ++writes;</a>
<a name="ln74">  }</a>
<a name="ln75">  if (PIM_DEBUG_PIM_TRACE) {</a>
<a name="ln76">    vty_out(vty, &quot;debug pim trace%s&quot;, VTY_NEWLINE);</a>
<a name="ln77">    ++writes;</a>
<a name="ln78">  }</a>
<a name="ln79"> </a>
<a name="ln80">  if (PIM_DEBUG_ZEBRA) {</a>
<a name="ln81">    vty_out(vty, &quot;debug pim zebra%s&quot;, VTY_NEWLINE);</a>
<a name="ln82">    ++writes;</a>
<a name="ln83">  }</a>
<a name="ln84"> </a>
<a name="ln85">  if (PIM_DEBUG_SSMPINGD) {</a>
<a name="ln86">    vty_out(vty, &quot;debug ssmpingd%s&quot;, VTY_NEWLINE);</a>
<a name="ln87">    ++writes;</a>
<a name="ln88">  }</a>
<a name="ln89"> </a>
<a name="ln90">  return writes;</a>
<a name="ln91">}</a>
<a name="ln92"> </a>
<a name="ln93">int pim_global_config_write(struct vty *vty)</a>
<a name="ln94">{</a>
<a name="ln95">  int writes = 0;</a>
<a name="ln96"> </a>
<a name="ln97">  if (PIM_MROUTE_IS_ENABLED) {</a>
<a name="ln98">    vty_out(vty, &quot;%s%s&quot;, PIM_CMD_IP_MULTICAST_ROUTING, VTY_NEWLINE);</a>
<a name="ln99">    ++writes;</a>
<a name="ln100">  }</a>
<a name="ln101"> </a>
<a name="ln102">  if (qpim_ssmpingd_list) {</a>
<a name="ln103">    struct listnode *node;</a>
<a name="ln104">    struct ssmpingd_sock *ss;</a>
<a name="ln105">    vty_out(vty, &quot;!%s&quot;, VTY_NEWLINE);</a>
<a name="ln106">    ++writes;</a>
<a name="ln107">    for (ALL_LIST_ELEMENTS_RO(qpim_ssmpingd_list, node, ss)) {</a>
<a name="ln108">      char source_str[100];</a>
<a name="ln109">      pim_inet4_dump(&quot;&lt;src?&gt;&quot;, ss-&gt;source_addr, source_str, sizeof(source_str));</a>
<a name="ln110">      vty_out(vty, &quot;ip ssmpingd %s%s&quot;, source_str, VTY_NEWLINE);</a>
<a name="ln111">      ++writes;</a>
<a name="ln112">    }</a>
<a name="ln113">  }</a>
<a name="ln114"> </a>
<a name="ln115">  return writes;</a>
<a name="ln116">}</a>
<a name="ln117"> </a>
<a name="ln118">int pim_interface_config_write(struct vty *vty)</a>
<a name="ln119">{</a>
<a name="ln120">  int writes = 0;</a>
<a name="ln121">  struct listnode *node;</a>
<a name="ln122">  struct interface *ifp;</a>
<a name="ln123"> </a>
<a name="ln124">  for (ALL_LIST_ELEMENTS_RO(iflist, node, ifp)) {</a>
<a name="ln125"> </a>
<a name="ln126">    /* IF name */</a>
<a name="ln127">    vty_out(vty, &quot;interface %s%s&quot;, ifp-&gt;name, VTY_NEWLINE);</a>
<a name="ln128">    ++writes;</a>
<a name="ln129"> </a>
<a name="ln130">    if (ifp-&gt;info) {</a>
<a name="ln131">      struct pim_interface *pim_ifp = ifp-&gt;info;</a>
<a name="ln132"> </a>
<a name="ln133">      /* IF ip pim ssm */</a>
<a name="ln134">      if (PIM_IF_TEST_PIM(pim_ifp-&gt;options)) {</a>
<a name="ln135">	vty_out(vty, &quot; ip pim ssm%s&quot;, VTY_NEWLINE);</a>
<a name="ln136">	++writes;</a>
<a name="ln137">      }</a>
<a name="ln138"> </a>
<a name="ln139">      /* IF ip pim drpriority */</a>
<a name="ln140">      if (pim_ifp-&gt;pim_dr_priority != PIM_DEFAULT_DR_PRIORITY) {</a>
<a name="ln141">	vty_out(vty, &quot; ip pim drpriority %d%s&quot;, pim_ifp-&gt;pim_dr_priority,</a>
<a name="ln142">		VTY_NEWLINE);</a>
<a name="ln143">	++writes;</a>
<a name="ln144">      }</a>
<a name="ln145"> </a>
<a name="ln146">      /* IF ip pim hello */</a>
<a name="ln147">      if (pim_ifp-&gt;pim_hello_period != PIM_DEFAULT_HELLO_PERIOD) {</a>
<a name="ln148">	vty_out(vty, &quot; ip pim hello %d&quot;, pim_ifp-&gt;pim_hello_period);</a>
<a name="ln149">	if (pim_ifp-&gt;pim_default_holdtime != -1)</a>
<a name="ln150">	  vty_out(vty, &quot; %d&quot;, pim_ifp-&gt;pim_default_holdtime);</a>
<a name="ln151">	vty_out(vty, &quot;%s&quot;, VTY_NEWLINE);</a>
<a name="ln152">      }</a>
<a name="ln153"> </a>
<a name="ln154">      /* IF ip igmp */</a>
<a name="ln155">      if (PIM_IF_TEST_IGMP(pim_ifp-&gt;options)) {</a>
<a name="ln156">	vty_out(vty, &quot; ip igmp%s&quot;, VTY_NEWLINE);</a>
<a name="ln157">	++writes;</a>
<a name="ln158">      }</a>
<a name="ln159"> </a>
<a name="ln160">      /* IF ip igmp query-interval */</a>
<a name="ln161">      if (pim_ifp-&gt;igmp_default_query_interval != IGMP_GENERAL_QUERY_INTERVAL)</a>
<a name="ln162">	{</a>
<a name="ln163">	  vty_out(vty, &quot; %s %d%s&quot;,</a>
<a name="ln164">		  PIM_CMD_IP_IGMP_QUERY_INTERVAL,</a>
<a name="ln165">		  pim_ifp-&gt;igmp_default_query_interval,</a>
<a name="ln166">		  VTY_NEWLINE);</a>
<a name="ln167">	  ++writes;</a>
<a name="ln168">	}</a>
<a name="ln169"> </a>
<a name="ln170">      /* IF ip igmp query-max-response-time */</a>
<a name="ln171">      if (pim_ifp-&gt;igmp_query_max_response_time_dsec != IGMP_QUERY_MAX_RESPONSE_TIME_DSEC)</a>
<a name="ln172">	{</a>
<a name="ln173">	  vty_out(vty, &quot; %s %d%s&quot;,</a>
<a name="ln174">		  PIM_CMD_IP_IGMP_QUERY_MAX_RESPONSE_TIME_DSEC,</a>
<a name="ln175">		  pim_ifp-&gt;igmp_query_max_response_time_dsec,</a>
<a name="ln176">		  VTY_NEWLINE);</a>
<a name="ln177">	  ++writes;</a>
<a name="ln178">	}</a>
<a name="ln179"> </a>
<a name="ln180">      /* IF ip igmp join */</a>
<a name="ln181">      if (pim_ifp-&gt;igmp_join_list) {</a>
<a name="ln182">	struct listnode *node;</a>
<a name="ln183">	struct igmp_join *ij;</a>
<a name="ln184">	for (ALL_LIST_ELEMENTS_RO(pim_ifp-&gt;igmp_join_list, node, ij)) {</a>
<a name="ln185">	  char group_str[100];</a>
<a name="ln186">	  char source_str[100];</a>
<a name="ln187">	  pim_inet4_dump(&quot;&lt;grp?&gt;&quot;, ij-&gt;group_addr, group_str, sizeof(group_str));</a>
<a name="ln188">	  pim_inet4_dump(&quot;&lt;src?&gt;&quot;, ij-&gt;source_addr, source_str, sizeof(source_str));</a>
<a name="ln189">	  vty_out(vty, &quot; ip igmp join %s %s%s&quot;,</a>
<a name="ln190">		  group_str, source_str,</a>
<a name="ln191">		  VTY_NEWLINE);</a>
<a name="ln192">	  ++writes;</a>
<a name="ln193">	}</a>
<a name="ln194">      }</a>
<a name="ln195"> </a>
<a name="ln196">	writes += pim_static_write_mroute (vty, ifp);</a>
<a name="ln197">    }</a>
<a name="ln198">    vty_out(vty, &quot;!%s&quot;, VTY_NEWLINE);</a>
<a name="ln199">    ++writes;</a>
<a name="ln200">  }</a>
<a name="ln201"> </a>
<a name="ln202">  return writes;</a>
<a name="ln203">}</a>

</code></pre>
<div class="balloon" rel="6"><p><span style="font-size:18px">&uarr;</span> <a href="https://pvs-studio.com/en/docs/warnings/v1042/" target="_blank">V1042</a> This file is marked with copyleft license, which requires you to open the derived source code.</p></div>

<link rel="stylesheet" href="highlight.css">
<script src="highlight.pack.js"></script>
<script src="highlightjs-line-numbers.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
<script>hljs.initLineNumbersOnLoad();</script>
<script>
  $(document).ready(function() {
      $('.balloon').each(function () {
          var bl = $(this);
          var line = bl.attr('rel');
          var text = $('a[name="ln'+line+'"]').text();

          var space_count = 0;
          for(var i = 0; i<text.length; i++){
              var char = text[i];
              if((char !== ' ')&&(char !== '\t'))break;
              if(char === '\t')space_count++;
              space_count++;
          }

          bl.css('margin-left', space_count*8);
          $('a[name="ln'+line+'"]').after(bl);
      });

      window.location = window.location;
  });
</script>
</body>
</html>
