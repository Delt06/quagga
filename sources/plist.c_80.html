
<html>
<head>

  <meta http-equiv="Content-Type" content="text/html; charset=US-ASCII" />
  <title>plist.c</title>

  <link rel="stylesheet" href="../style.css"/>
  <script src="../jquery-3.5.1.min.js"></script>
</head>
<body>

<pre><code class = "cpp">
<a name="ln1">/* Prefix list functions.</a>
<a name="ln2"> * Copyright (C) 1999 Kunihiro Ishiguro</a>
<a name="ln3"> *</a>
<a name="ln4"> * This file is part of GNU Zebra.</a>
<a name="ln5"> *</a>
<a name="ln6"> * GNU Zebra is free software; you can redistribute it and/or modify</a>
<a name="ln7"> * it under the terms of the GNU General Public License as published</a>
<a name="ln8"> * by the Free Software Foundation; either version 2, or (at your</a>
<a name="ln9"> * option) any later version.</a>
<a name="ln10"> *</a>
<a name="ln11"> * GNU Zebra is distributed in the hope that it will be useful, but</a>
<a name="ln12"> * WITHOUT ANY WARRANTY; without even the implied warranty of</a>
<a name="ln13"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</a>
<a name="ln14"> * General Public License for more details.</a>
<a name="ln15"> *</a>
<a name="ln16"> * You should have received a copy of the GNU General Public License</a>
<a name="ln17"> * along with GNU Zebra; see the file COPYING.  If not, write to the</a>
<a name="ln18"> * Free Software Foundation, Inc., 59 Temple Place - Suite 330,</a>
<a name="ln19"> * Boston, MA 02111-1307, USA.</a>
<a name="ln20"> */</a>
<a name="ln21"> </a>
<a name="ln22">#include &lt;zebra.h&gt;</a>
<a name="ln23"> </a>
<a name="ln24">#include &quot;prefix.h&quot;</a>
<a name="ln25">#include &quot;command.h&quot;</a>
<a name="ln26">#include &quot;memory.h&quot;</a>
<a name="ln27">#include &quot;plist.h&quot;</a>
<a name="ln28">#include &quot;sockunion.h&quot;</a>
<a name="ln29">#include &quot;buffer.h&quot;</a>
<a name="ln30">#include &quot;stream.h&quot;</a>
<a name="ln31">#include &quot;log.h&quot;</a>
<a name="ln32"> </a>
<a name="ln33">#include &quot;plist_int.h&quot;</a>
<a name="ln34"> </a>
<a name="ln35">/* List of struct prefix_list. */</a>
<a name="ln36">struct prefix_list_list</a>
<a name="ln37">{</a>
<a name="ln38">  struct prefix_list *head;</a>
<a name="ln39">  struct prefix_list *tail;</a>
<a name="ln40">};</a>
<a name="ln41"> </a>
<a name="ln42">/* Master structure of prefix_list. */</a>
<a name="ln43">struct prefix_master</a>
<a name="ln44">{</a>
<a name="ln45">  /* List of prefix_list which name is number. */</a>
<a name="ln46">  struct prefix_list_list num;</a>
<a name="ln47"> </a>
<a name="ln48">  /* List of prefix_list which name is string. */</a>
<a name="ln49">  struct prefix_list_list str;</a>
<a name="ln50"> </a>
<a name="ln51">  /* Whether sequential number is used. */</a>
<a name="ln52">  int seqnum;</a>
<a name="ln53"> </a>
<a name="ln54">  /* The latest update. */</a>
<a name="ln55">  struct prefix_list *recent;</a>
<a name="ln56"> </a>
<a name="ln57">  /* Hook function which is executed when new prefix_list is added. */</a>
<a name="ln58">  void (*add_hook) (struct prefix_list *);</a>
<a name="ln59"> </a>
<a name="ln60">  /* Hook function which is executed when prefix_list is deleted. */</a>
<a name="ln61">  void (*delete_hook) (struct prefix_list *);</a>
<a name="ln62">};</a>
<a name="ln63"> </a>
<a name="ln64">/* Static structure of IPv4 prefix_list's master. */</a>
<a name="ln65">static struct prefix_master prefix_master_ipv4 = </a>
<a name="ln66">{ </a>
<a name="ln67">  {NULL, NULL},</a>
<a name="ln68">  {NULL, NULL},</a>
<a name="ln69">  1,</a>
<a name="ln70">  NULL,</a>
<a name="ln71">  NULL,</a>
<a name="ln72">};</a>
<a name="ln73"> </a>
<a name="ln74">#ifdef HAVE_IPV6</a>
<a name="ln75">/* Static structure of IPv6 prefix-list's master. */</a>
<a name="ln76">static struct prefix_master prefix_master_ipv6 = </a>
<a name="ln77">{ </a>
<a name="ln78">  {NULL, NULL},</a>
<a name="ln79">  {NULL, NULL},</a>
<a name="ln80">  1,</a>
<a name="ln81">  NULL,</a>
<a name="ln82">  NULL,</a>
<a name="ln83">};</a>
<a name="ln84">#endif /* HAVE_IPV6*/</a>
<a name="ln85"> </a>
<a name="ln86">/* Static structure of BGP ORF prefix_list's master. */</a>
<a name="ln87">static struct prefix_master prefix_master_orf_v4 =</a>
<a name="ln88">{</a>
<a name="ln89">  {NULL, NULL},</a>
<a name="ln90">  {NULL, NULL},</a>
<a name="ln91">  1,</a>
<a name="ln92">  NULL,</a>
<a name="ln93">  NULL,</a>
<a name="ln94">};</a>
<a name="ln95"> </a>
<a name="ln96">/* Static structure of BGP ORF prefix_list's master. */</a>
<a name="ln97">static struct prefix_master prefix_master_orf_v6 =</a>
<a name="ln98">{</a>
<a name="ln99">  {NULL, NULL},</a>
<a name="ln100">  {NULL, NULL},</a>
<a name="ln101">  1,</a>
<a name="ln102">  NULL,</a>
<a name="ln103">  NULL,</a>
<a name="ln104">};</a>
<a name="ln105"> </a>
<a name="ln106">static struct prefix_master *</a>
<a name="ln107">prefix_master_get (afi_t afi, int orf)</a>
<a name="ln108">{</a>
<a name="ln109">  if (afi == AFI_IP)</a>
<a name="ln110">    return orf ? &amp;prefix_master_orf_v4 : &amp;prefix_master_ipv4;</a>
<a name="ln111">  if (afi == AFI_IP6)</a>
<a name="ln112">    return orf ? &amp;prefix_master_orf_v6 : &amp;prefix_master_ipv6;</a>
<a name="ln113">  return NULL;</a>
<a name="ln114">}</a>
<a name="ln115"> </a>
<a name="ln116">const char *prefix_list_name (struct prefix_list *plist)</a>
<a name="ln117">{</a>
<a name="ln118">  return plist-&gt;name;</a>
<a name="ln119">}</a>
<a name="ln120"> </a>
<a name="ln121">/* Lookup prefix_list from list of prefix_list by name. */</a>
<a name="ln122">static struct prefix_list *</a>
<a name="ln123">prefix_list_lookup_do (afi_t afi, int orf, const char *name)</a>
<a name="ln124">{</a>
<a name="ln125">  struct prefix_list *plist;</a>
<a name="ln126">  struct prefix_master *master;</a>
<a name="ln127"> </a>
<a name="ln128">  if (name == NULL)</a>
<a name="ln129">    return NULL;</a>
<a name="ln130"> </a>
<a name="ln131">  master = prefix_master_get (afi, orf);</a>
<a name="ln132">  if (master == NULL)</a>
<a name="ln133">    return NULL;</a>
<a name="ln134"> </a>
<a name="ln135">  for (plist = master-&gt;num.head; plist; plist = plist-&gt;next)</a>
<a name="ln136">    if (strcmp (plist-&gt;name, name) == 0)</a>
<a name="ln137">      return plist;</a>
<a name="ln138"> </a>
<a name="ln139">  for (plist = master-&gt;str.head; plist; plist = plist-&gt;next)</a>
<a name="ln140">    if (strcmp (plist-&gt;name, name) == 0)</a>
<a name="ln141">      return plist;</a>
<a name="ln142"> </a>
<a name="ln143">  return NULL;</a>
<a name="ln144">}</a>
<a name="ln145"> </a>
<a name="ln146">struct prefix_list *</a>
<a name="ln147">prefix_list_lookup (afi_t afi, const char *name)</a>
<a name="ln148">{</a>
<a name="ln149">  return prefix_list_lookup_do (afi, 0, name);</a>
<a name="ln150">}</a>
<a name="ln151"> </a>
<a name="ln152">struct prefix_list *</a>
<a name="ln153">prefix_bgp_orf_lookup (afi_t afi, const char *name)</a>
<a name="ln154">{</a>
<a name="ln155">  return prefix_list_lookup_do (afi, 1, name);</a>
<a name="ln156">}</a>
<a name="ln157"> </a>
<a name="ln158">static struct prefix_list *</a>
<a name="ln159">prefix_list_new (void)</a>
<a name="ln160">{</a>
<a name="ln161">  struct prefix_list *new;</a>
<a name="ln162"> </a>
<a name="ln163">  new = XCALLOC (MTYPE_PREFIX_LIST, sizeof (struct prefix_list));</a>
<a name="ln164">  return new;</a>
<a name="ln165">}</a>
<a name="ln166"> </a>
<a name="ln167">static void</a>
<a name="ln168">prefix_list_free (struct prefix_list *plist)</a>
<a name="ln169">{</a>
<a name="ln170">  XFREE (MTYPE_PREFIX_LIST, plist);</a>
<a name="ln171">}</a>
<a name="ln172"> </a>
<a name="ln173">static struct prefix_list_entry *</a>
<a name="ln174">prefix_list_entry_new (void)</a>
<a name="ln175">{</a>
<a name="ln176">  struct prefix_list_entry *new;</a>
<a name="ln177"> </a>
<a name="ln178">  new = XCALLOC (MTYPE_PREFIX_LIST_ENTRY, sizeof (struct prefix_list_entry));</a>
<a name="ln179">  return new;</a>
<a name="ln180">}</a>
<a name="ln181"> </a>
<a name="ln182">static void</a>
<a name="ln183">prefix_list_entry_free (struct prefix_list_entry *pentry)</a>
<a name="ln184">{</a>
<a name="ln185">  XFREE (MTYPE_PREFIX_LIST_ENTRY, pentry);</a>
<a name="ln186">}</a>
<a name="ln187"> </a>
<a name="ln188">/* Insert new prefix list to list of prefix_list.  Each prefix_list</a>
<a name="ln189">   is sorted by the name. */</a>
<a name="ln190">static struct prefix_list *</a>
<a name="ln191">prefix_list_insert (afi_t afi, int orf, const char *name)</a>
<a name="ln192">{</a>
<a name="ln193">  unsigned int i;</a>
<a name="ln194">  long number;</a>
<a name="ln195">  struct prefix_list *plist;</a>
<a name="ln196">  struct prefix_list *point;</a>
<a name="ln197">  struct prefix_list_list *list;</a>
<a name="ln198">  struct prefix_master *master;</a>
<a name="ln199"> </a>
<a name="ln200">  master = prefix_master_get (afi, orf);</a>
<a name="ln201">  if (master == NULL)</a>
<a name="ln202">    return NULL;</a>
<a name="ln203"> </a>
<a name="ln204">  /* Allocate new prefix_list and copy given name. */</a>
<a name="ln205">  plist = prefix_list_new ();</a>
<a name="ln206">  plist-&gt;name = XSTRDUP (MTYPE_PREFIX_LIST_STR, name);</a>
<a name="ln207">  plist-&gt;master = master;</a>
<a name="ln208"> </a>
<a name="ln209">  /* If name is made by all digit character.  We treat it as</a>
<a name="ln210">     number. */</a>
<a name="ln211">  for (number = 0, i = 0; i &lt; strlen (name); i++)</a>
<a name="ln212">    {</a>
<a name="ln213">      if (isdigit ((int) name[i]))</a>
<a name="ln214">	number = (number * 10) + (name[i] - '0');</a>
<a name="ln215">      else</a>
<a name="ln216">	break;</a>
<a name="ln217">    }</a>
<a name="ln218"> </a>
<a name="ln219">  /* In case of name is all digit character */</a>
<a name="ln220">  if (i == strlen (name))</a>
<a name="ln221">    {</a>
<a name="ln222">      plist-&gt;type = PREFIX_TYPE_NUMBER;</a>
<a name="ln223"> </a>
<a name="ln224">      /* Set prefix_list to number list. */</a>
<a name="ln225">      list = &amp;master-&gt;num;</a>
<a name="ln226"> </a>
<a name="ln227">      for (point = list-&gt;head; point; point = point-&gt;next)</a>
<a name="ln228">	if (atol (point-&gt;name) &gt;= number)</a>
<a name="ln229">	  break;</a>
<a name="ln230">    }</a>
<a name="ln231">  else</a>
<a name="ln232">    {</a>
<a name="ln233">      plist-&gt;type = PREFIX_TYPE_STRING;</a>
<a name="ln234"> </a>
<a name="ln235">      /* Set prefix_list to string list. */</a>
<a name="ln236">      list = &amp;master-&gt;str;</a>
<a name="ln237">  </a>
<a name="ln238">      /* Set point to insertion point. */</a>
<a name="ln239">      for (point = list-&gt;head; point; point = point-&gt;next)</a>
<a name="ln240">	if (strcmp (point-&gt;name, name) &gt;= 0)</a>
<a name="ln241">	  break;</a>
<a name="ln242">    }</a>
<a name="ln243"> </a>
<a name="ln244">  /* In case of this is the first element of master. */</a>
<a name="ln245">  if (list-&gt;head == NULL)</a>
<a name="ln246">    {</a>
<a name="ln247">      list-&gt;head = list-&gt;tail = plist;</a>
<a name="ln248">      return plist;</a>
<a name="ln249">    }</a>
<a name="ln250"> </a>
<a name="ln251">  /* In case of insertion is made at the tail of access_list. */</a>
<a name="ln252">  if (point == NULL)</a>
<a name="ln253">    {</a>
<a name="ln254">      plist-&gt;prev = list-&gt;tail;</a>
<a name="ln255">      list-&gt;tail-&gt;next = plist;</a>
<a name="ln256">      list-&gt;tail = plist;</a>
<a name="ln257">      return plist;</a>
<a name="ln258">    }</a>
<a name="ln259"> </a>
<a name="ln260">  /* In case of insertion is made at the head of access_list. */</a>
<a name="ln261">  if (point == list-&gt;head)</a>
<a name="ln262">    {</a>
<a name="ln263">      plist-&gt;next = list-&gt;head;</a>
<a name="ln264">      list-&gt;head-&gt;prev = plist;</a>
<a name="ln265">      list-&gt;head = plist;</a>
<a name="ln266">      return plist;</a>
<a name="ln267">    }</a>
<a name="ln268"> </a>
<a name="ln269">  /* Insertion is made at middle of the access_list. */</a>
<a name="ln270">  plist-&gt;next = point;</a>
<a name="ln271">  plist-&gt;prev = point-&gt;prev;</a>
<a name="ln272"> </a>
<a name="ln273">  if (point-&gt;prev)</a>
<a name="ln274">    point-&gt;prev-&gt;next = plist;</a>
<a name="ln275">  point-&gt;prev = plist;</a>
<a name="ln276"> </a>
<a name="ln277">  return plist;</a>
<a name="ln278">}</a>
<a name="ln279"> </a>
<a name="ln280">static struct prefix_list *</a>
<a name="ln281">prefix_list_get (afi_t afi, int orf, const char *name)</a>
<a name="ln282">{</a>
<a name="ln283">  struct prefix_list *plist;</a>
<a name="ln284"> </a>
<a name="ln285">  plist = prefix_list_lookup_do (afi, orf, name);</a>
<a name="ln286"> </a>
<a name="ln287">  if (plist == NULL)</a>
<a name="ln288">    plist = prefix_list_insert (afi, orf, name);</a>
<a name="ln289">  return plist;</a>
<a name="ln290">}</a>
<a name="ln291"> </a>
<a name="ln292">/* Delete prefix-list from prefix_list_master and free it. */</a>
<a name="ln293">static void</a>
<a name="ln294">prefix_list_delete (struct prefix_list *plist)</a>
<a name="ln295">{</a>
<a name="ln296">  struct prefix_list_list *list;</a>
<a name="ln297">  struct prefix_master *master;</a>
<a name="ln298">  struct prefix_list_entry *pentry;</a>
<a name="ln299">  struct prefix_list_entry *next;</a>
<a name="ln300"> </a>
<a name="ln301">  /* If prefix-list contain prefix_list_entry free all of it. */</a>
<a name="ln302">  for (pentry = plist-&gt;head; pentry; pentry = next)</a>
<a name="ln303">    {</a>
<a name="ln304">      next = pentry-&gt;next;</a>
<a name="ln305">      prefix_list_entry_free (pentry);</a>
<a name="ln306">      plist-&gt;count--;</a>
<a name="ln307">    }</a>
<a name="ln308"> </a>
<a name="ln309">  master = plist-&gt;master;</a>
<a name="ln310"> </a>
<a name="ln311">  if (plist-&gt;type == PREFIX_TYPE_NUMBER)</a>
<a name="ln312">    list = &amp;master-&gt;num;</a>
<a name="ln313">  else</a>
<a name="ln314">    list = &amp;master-&gt;str;</a>
<a name="ln315"> </a>
<a name="ln316">  if (plist-&gt;next)</a>
<a name="ln317">    plist-&gt;next-&gt;prev = plist-&gt;prev;</a>
<a name="ln318">  else</a>
<a name="ln319">    list-&gt;tail = plist-&gt;prev;</a>
<a name="ln320"> </a>
<a name="ln321">  if (plist-&gt;prev)</a>
<a name="ln322">    plist-&gt;prev-&gt;next = plist-&gt;next;</a>
<a name="ln323">  else</a>
<a name="ln324">    list-&gt;head = plist-&gt;next;</a>
<a name="ln325"> </a>
<a name="ln326">  if (plist-&gt;desc)</a>
<a name="ln327">    XFREE (MTYPE_TMP, plist-&gt;desc);</a>
<a name="ln328"> </a>
<a name="ln329">  /* Make sure master's recent changed prefix-list information is</a>
<a name="ln330">     cleared. */</a>
<a name="ln331">  master-&gt;recent = NULL;</a>
<a name="ln332"> </a>
<a name="ln333">  if (plist-&gt;name)</a>
<a name="ln334">    XFREE (MTYPE_PREFIX_LIST_STR, plist-&gt;name);</a>
<a name="ln335">  </a>
<a name="ln336">  prefix_list_free (plist);</a>
<a name="ln337">  </a>
<a name="ln338">  if (master-&gt;delete_hook)</a>
<a name="ln339">    (*master-&gt;delete_hook) (NULL);</a>
<a name="ln340">}</a>
<a name="ln341"> </a>
<a name="ln342">static struct prefix_list_entry *</a>
<a name="ln343">prefix_list_entry_make (struct prefix *prefix, enum prefix_list_type type,</a>
<a name="ln344">			int seq, int le, int ge, int any)</a>
<a name="ln345">{</a>
<a name="ln346">  struct prefix_list_entry *pentry;</a>
<a name="ln347"> </a>
<a name="ln348">  pentry = prefix_list_entry_new ();</a>
<a name="ln349"> </a>
<a name="ln350">  if (any)</a>
<a name="ln351">    pentry-&gt;any = 1;</a>
<a name="ln352"> </a>
<a name="ln353">  prefix_copy (&amp;pentry-&gt;prefix, prefix);</a>
<a name="ln354">  pentry-&gt;type = type;</a>
<a name="ln355">  pentry-&gt;seq = seq;</a>
<a name="ln356">  pentry-&gt;le = le;</a>
<a name="ln357">  pentry-&gt;ge = ge;</a>
<a name="ln358"> </a>
<a name="ln359">  return pentry;</a>
<a name="ln360">}</a>
<a name="ln361"> </a>
<a name="ln362">/* Add hook function. */</a>
<a name="ln363">void</a>
<a name="ln364">prefix_list_add_hook (void (*func) (struct prefix_list *plist))</a>
<a name="ln365">{</a>
<a name="ln366">  prefix_master_ipv4.add_hook = func;</a>
<a name="ln367">#ifdef HAVE_IPV6</a>
<a name="ln368">  prefix_master_ipv6.add_hook = func;</a>
<a name="ln369">#endif /* HAVE_IPV6 */</a>
<a name="ln370">}</a>
<a name="ln371"> </a>
<a name="ln372">/* Delete hook function. */</a>
<a name="ln373">void</a>
<a name="ln374">prefix_list_delete_hook (void (*func) (struct prefix_list *plist))</a>
<a name="ln375">{</a>
<a name="ln376">  prefix_master_ipv4.delete_hook = func;</a>
<a name="ln377">#ifdef HAVE_IPV6</a>
<a name="ln378">  prefix_master_ipv6.delete_hook = func;</a>
<a name="ln379">#endif /* HAVE_IPVt6 */</a>
<a name="ln380">}</a>
<a name="ln381"> </a>
<a name="ln382">/* Calculate new sequential number. */</a>
<a name="ln383">static int</a>
<a name="ln384">prefix_new_seq_get (struct prefix_list *plist)</a>
<a name="ln385">{</a>
<a name="ln386">  int maxseq;</a>
<a name="ln387">  int newseq;</a>
<a name="ln388">  struct prefix_list_entry *pentry;</a>
<a name="ln389"> </a>
<a name="ln390">  maxseq = newseq = 0;</a>
<a name="ln391"> </a>
<a name="ln392">  for (pentry = plist-&gt;head; pentry; pentry = pentry-&gt;next)</a>
<a name="ln393">    {</a>
<a name="ln394">      if (maxseq &lt; pentry-&gt;seq)</a>
<a name="ln395">	maxseq = pentry-&gt;seq;</a>
<a name="ln396">    }</a>
<a name="ln397"> </a>
<a name="ln398">  newseq = ((maxseq / 5) * 5) + 5;</a>
<a name="ln399">  </a>
<a name="ln400">  return newseq;</a>
<a name="ln401">}</a>
<a name="ln402"> </a>
<a name="ln403">/* Return prefix list entry which has same seq number. */</a>
<a name="ln404">static struct prefix_list_entry *</a>
<a name="ln405">prefix_seq_check (struct prefix_list *plist, int seq)</a>
<a name="ln406">{</a>
<a name="ln407">  struct prefix_list_entry *pentry;</a>
<a name="ln408"> </a>
<a name="ln409">  for (pentry = plist-&gt;head; pentry; pentry = pentry-&gt;next)</a>
<a name="ln410">    if (pentry-&gt;seq == seq)</a>
<a name="ln411">      return pentry;</a>
<a name="ln412">  return NULL;</a>
<a name="ln413">}</a>
<a name="ln414"> </a>
<a name="ln415">static struct prefix_list_entry *</a>
<a name="ln416">prefix_list_entry_lookup (struct prefix_list *plist, struct prefix *prefix,</a>
<a name="ln417">			  enum prefix_list_type type, int seq, int le, int ge)</a>
<a name="ln418">{</a>
<a name="ln419">  struct prefix_list_entry *pentry;</a>
<a name="ln420"> </a>
<a name="ln421">  for (pentry = plist-&gt;head; pentry; pentry = pentry-&gt;next)</a>
<a name="ln422">    if (prefix_same (&amp;pentry-&gt;prefix, prefix) &amp;&amp; pentry-&gt;type == type)</a>
<a name="ln423">      {</a>
<a name="ln424">	if (seq &gt;= 0 &amp;&amp; pentry-&gt;seq != seq)</a>
<a name="ln425">	  continue;</a>
<a name="ln426"> </a>
<a name="ln427">	if (pentry-&gt;le != le)</a>
<a name="ln428">	  continue;</a>
<a name="ln429">	if (pentry-&gt;ge != ge)</a>
<a name="ln430">	  continue;</a>
<a name="ln431"> </a>
<a name="ln432">	return pentry;</a>
<a name="ln433">      }</a>
<a name="ln434"> </a>
<a name="ln435">  return NULL;</a>
<a name="ln436">}</a>
<a name="ln437"> </a>
<a name="ln438">static void</a>
<a name="ln439">prefix_list_entry_delete (struct prefix_list *plist, </a>
<a name="ln440">			  struct prefix_list_entry *pentry,</a>
<a name="ln441">			  int update_list)</a>
<a name="ln442">{</a>
<a name="ln443">  if (plist == NULL || pentry == NULL)</a>
<a name="ln444">    return;</a>
<a name="ln445">  if (pentry-&gt;prev)</a>
<a name="ln446">    pentry-&gt;prev-&gt;next = pentry-&gt;next;</a>
<a name="ln447">  else</a>
<a name="ln448">    plist-&gt;head = pentry-&gt;next;</a>
<a name="ln449">  if (pentry-&gt;next)</a>
<a name="ln450">    pentry-&gt;next-&gt;prev = pentry-&gt;prev;</a>
<a name="ln451">  else</a>
<a name="ln452">    plist-&gt;tail = pentry-&gt;prev;</a>
<a name="ln453"> </a>
<a name="ln454">  prefix_list_entry_free (pentry);</a>
<a name="ln455"> </a>
<a name="ln456">  plist-&gt;count--;</a>
<a name="ln457"> </a>
<a name="ln458">  if (update_list)</a>
<a name="ln459">    {</a>
<a name="ln460">      if (plist-&gt;master-&gt;delete_hook)</a>
<a name="ln461">	(*plist-&gt;master-&gt;delete_hook) (plist);</a>
<a name="ln462"> </a>
<a name="ln463">      if (plist-&gt;head == NULL &amp;&amp; plist-&gt;tail == NULL &amp;&amp; plist-&gt;desc == NULL)</a>
<a name="ln464">	prefix_list_delete (plist);</a>
<a name="ln465">      else</a>
<a name="ln466">	plist-&gt;master-&gt;recent = plist;</a>
<a name="ln467">    }</a>
<a name="ln468">}</a>
<a name="ln469"> </a>
<a name="ln470">static void</a>
<a name="ln471">prefix_list_entry_add (struct prefix_list *plist,</a>
<a name="ln472">		       struct prefix_list_entry *pentry)</a>
<a name="ln473">{</a>
<a name="ln474">  struct prefix_list_entry *replace;</a>
<a name="ln475">  struct prefix_list_entry *point;</a>
<a name="ln476"> </a>
<a name="ln477">  /* Automatic asignment of seq no. */</a>
<a name="ln478">  if (pentry-&gt;seq == -1)</a>
<a name="ln479">    pentry-&gt;seq = prefix_new_seq_get (plist);</a>
<a name="ln480"> </a>
<a name="ln481">  /* Is there any same seq prefix list entry? */</a>
<a name="ln482">  replace = prefix_seq_check (plist, pentry-&gt;seq);</a>
<a name="ln483">  if (replace)</a>
<a name="ln484">    prefix_list_entry_delete (plist, replace, 0);</a>
<a name="ln485"> </a>
<a name="ln486">  /* Check insert point. */</a>
<a name="ln487">  for (point = plist-&gt;head; point; point = point-&gt;next)</a>
<a name="ln488">    if (point-&gt;seq &gt;= pentry-&gt;seq)</a>
<a name="ln489">      break;</a>
<a name="ln490"> </a>
<a name="ln491">  /* In case of this is the first element of the list. */</a>
<a name="ln492">  pentry-&gt;next = point;</a>
<a name="ln493"> </a>
<a name="ln494">  if (point)</a>
<a name="ln495">    {</a>
<a name="ln496">      if (point-&gt;prev)</a>
<a name="ln497">	point-&gt;prev-&gt;next = pentry;</a>
<a name="ln498">      else</a>
<a name="ln499">	plist-&gt;head = pentry;</a>
<a name="ln500"> </a>
<a name="ln501">      pentry-&gt;prev = point-&gt;prev;</a>
<a name="ln502">      point-&gt;prev = pentry;</a>
<a name="ln503">    }</a>
<a name="ln504">  else</a>
<a name="ln505">    {</a>
<a name="ln506">      if (plist-&gt;tail)</a>
<a name="ln507">	plist-&gt;tail-&gt;next = pentry;</a>
<a name="ln508">      else</a>
<a name="ln509">	plist-&gt;head = pentry;</a>
<a name="ln510"> </a>
<a name="ln511">      pentry-&gt;prev = plist-&gt;tail;</a>
<a name="ln512">      plist-&gt;tail = pentry;</a>
<a name="ln513">    }</a>
<a name="ln514"> </a>
<a name="ln515">  /* Increment count. */</a>
<a name="ln516">  plist-&gt;count++;</a>
<a name="ln517"> </a>
<a name="ln518">  /* Run hook function. */</a>
<a name="ln519">  if (plist-&gt;master-&gt;add_hook)</a>
<a name="ln520">    (*plist-&gt;master-&gt;add_hook) (plist);</a>
<a name="ln521"> </a>
<a name="ln522">  plist-&gt;master-&gt;recent = plist;</a>
<a name="ln523">}</a>
<a name="ln524"> </a>
<a name="ln525">/* Return string of prefix_list_type. */</a>
<a name="ln526">static const char *</a>
<a name="ln527">prefix_list_type_str (struct prefix_list_entry *pentry)</a>
<a name="ln528">{</a>
<a name="ln529">  switch (pentry-&gt;type)</a>
<a name="ln530">    {</a>
<a name="ln531">    case PREFIX_PERMIT:</a>
<a name="ln532">      return &quot;permit&quot;;</a>
<a name="ln533">    case PREFIX_DENY:</a>
<a name="ln534">      return &quot;deny&quot;;</a>
<a name="ln535">    default:</a>
<a name="ln536">      return &quot;&quot;;</a>
<a name="ln537">    }</a>
<a name="ln538">}</a>
<a name="ln539"> </a>
<a name="ln540">static int</a>
<a name="ln541">prefix_list_entry_match (struct prefix_list_entry *pentry, struct prefix *p)</a>
<a name="ln542">{</a>
<a name="ln543">  int ret;</a>
<a name="ln544"> </a>
<a name="ln545">  ret = prefix_match (&amp;pentry-&gt;prefix, p);</a>
<a name="ln546">  if (! ret)</a>
<a name="ln547">    return 0;</a>
<a name="ln548">  </a>
<a name="ln549">  /* In case of le nor ge is specified, exact match is performed. */</a>
<a name="ln550">  if (! pentry-&gt;le &amp;&amp; ! pentry-&gt;ge)</a>
<a name="ln551">    {</a>
<a name="ln552">      if (pentry-&gt;prefix.prefixlen != p-&gt;prefixlen)</a>
<a name="ln553">	return 0;</a>
<a name="ln554">    }</a>
<a name="ln555">  else</a>
<a name="ln556">    {  </a>
<a name="ln557">      if (pentry-&gt;le)</a>
<a name="ln558">	if (p-&gt;prefixlen &gt; pentry-&gt;le)</a>
<a name="ln559">	  return 0;</a>
<a name="ln560"> </a>
<a name="ln561">      if (pentry-&gt;ge)</a>
<a name="ln562">	if (p-&gt;prefixlen &lt; pentry-&gt;ge)</a>
<a name="ln563">	  return 0;</a>
<a name="ln564">    }</a>
<a name="ln565">  return 1;</a>
<a name="ln566">}</a>
<a name="ln567"> </a>
<a name="ln568">enum prefix_list_type</a>
<a name="ln569">prefix_list_apply (struct prefix_list *plist, void *object)</a>
<a name="ln570">{</a>
<a name="ln571">  struct prefix_list_entry *pentry;</a>
<a name="ln572">  struct prefix *p;</a>
<a name="ln573"> </a>
<a name="ln574">  p = (struct prefix *) object;</a>
<a name="ln575"> </a>
<a name="ln576">  if (plist == NULL)</a>
<a name="ln577">    return PREFIX_DENY;</a>
<a name="ln578"> </a>
<a name="ln579">  if (plist-&gt;count == 0)</a>
<a name="ln580">    return PREFIX_PERMIT;</a>
<a name="ln581"> </a>
<a name="ln582">  for (pentry = plist-&gt;head; pentry; pentry = pentry-&gt;next)</a>
<a name="ln583">    {</a>
<a name="ln584">      pentry-&gt;refcnt++;</a>
<a name="ln585">      if (prefix_list_entry_match (pentry, p))</a>
<a name="ln586">	{</a>
<a name="ln587">	  pentry-&gt;hitcnt++;</a>
<a name="ln588">	  return pentry-&gt;type;</a>
<a name="ln589">	}</a>
<a name="ln590">    }</a>
<a name="ln591"> </a>
<a name="ln592">  return PREFIX_DENY;</a>
<a name="ln593">}</a>
<a name="ln594"> </a>
<a name="ln595">static void __attribute__ ((unused))</a>
<a name="ln596">prefix_list_print (struct prefix_list *plist)</a>
<a name="ln597">{</a>
<a name="ln598">  struct prefix_list_entry *pentry;</a>
<a name="ln599"> </a>
<a name="ln600">  if (plist == NULL)</a>
<a name="ln601">    return;</a>
<a name="ln602"> </a>
<a name="ln603">  printf (&quot;ip prefix-list %s: %d entries\n&quot;, plist-&gt;name, plist-&gt;count);</a>
<a name="ln604"> </a>
<a name="ln605">  for (pentry = plist-&gt;head; pentry; pentry = pentry-&gt;next)</a>
<a name="ln606">    {</a>
<a name="ln607">      if (pentry-&gt;any)</a>
<a name="ln608">	printf (&quot;any %s\n&quot;, prefix_list_type_str (pentry));</a>
<a name="ln609">      else</a>
<a name="ln610">	{</a>
<a name="ln611">	  struct prefix *p;</a>
<a name="ln612">	  char buf[BUFSIZ];</a>
<a name="ln613">	  </a>
<a name="ln614">	  p = &amp;pentry-&gt;prefix;</a>
<a name="ln615">	  </a>
<a name="ln616">	  printf (&quot;  seq %d %s %s/%d&quot;, </a>
<a name="ln617">		  pentry-&gt;seq,</a>
<a name="ln618">		  prefix_list_type_str (pentry),</a>
<a name="ln619">		  inet_ntop (p-&gt;family, &amp;p-&gt;u.prefix, buf, BUFSIZ),</a>
<a name="ln620">		  p-&gt;prefixlen);</a>
<a name="ln621">	  if (pentry-&gt;ge)</a>
<a name="ln622">	    printf (&quot; ge %d&quot;, pentry-&gt;ge);</a>
<a name="ln623">	  if (pentry-&gt;le)</a>
<a name="ln624">	    printf (&quot; le %d&quot;, pentry-&gt;le);</a>
<a name="ln625">	  printf (&quot;\n&quot;);</a>
<a name="ln626">	}</a>
<a name="ln627">    }</a>
<a name="ln628">}</a>
<a name="ln629"> </a>
<a name="ln630">/* Retrun 1 when plist already include pentry policy. */</a>
<a name="ln631">static struct prefix_list_entry *</a>
<a name="ln632">prefix_entry_dup_check (struct prefix_list *plist,</a>
<a name="ln633">			struct prefix_list_entry *new)</a>
<a name="ln634">{</a>
<a name="ln635">  struct prefix_list_entry *pentry;</a>
<a name="ln636">  int seq = 0;</a>
<a name="ln637"> </a>
<a name="ln638">  if (new-&gt;seq == -1)</a>
<a name="ln639">    seq = prefix_new_seq_get (plist);</a>
<a name="ln640">  else</a>
<a name="ln641">    seq = new-&gt;seq;</a>
<a name="ln642"> </a>
<a name="ln643">  for (pentry = plist-&gt;head; pentry; pentry = pentry-&gt;next)</a>
<a name="ln644">    {</a>
<a name="ln645">      if (prefix_same (&amp;pentry-&gt;prefix, &amp;new-&gt;prefix)</a>
<a name="ln646">	  &amp;&amp; pentry-&gt;type == new-&gt;type</a>
<a name="ln647">	  &amp;&amp; pentry-&gt;le == new-&gt;le</a>
<a name="ln648">	  &amp;&amp; pentry-&gt;ge == new-&gt;ge</a>
<a name="ln649">	  &amp;&amp; pentry-&gt;seq != seq)</a>
<a name="ln650">	return pentry;</a>
<a name="ln651">    }</a>
<a name="ln652">  return NULL;</a>
<a name="ln653">}</a>
<a name="ln654"> </a>
<a name="ln655">static int</a>
<a name="ln656">vty_invalid_prefix_range (struct vty *vty, const char *prefix)</a>
<a name="ln657">{</a>
<a name="ln658">  vty_out (vty, &quot;%% Invalid prefix range for %s, make sure: len &lt; ge-value &lt;= le-value%s&quot;,</a>
<a name="ln659">           prefix, VTY_NEWLINE);</a>
<a name="ln660">  return CMD_WARNING;</a>
<a name="ln661">}</a>
<a name="ln662"> </a>
<a name="ln663">static int</a>
<a name="ln664">vty_prefix_list_install (struct vty *vty, afi_t afi, const char *name, </a>
<a name="ln665">                         const char *seq, const char *typestr,</a>
<a name="ln666">			 const char *prefix, const char *ge, const char *le)</a>
<a name="ln667">{</a>
<a name="ln668">  int ret;</a>
<a name="ln669">  enum prefix_list_type type;</a>
<a name="ln670">  struct prefix_list *plist;</a>
<a name="ln671">  struct prefix_list_entry *pentry;</a>
<a name="ln672">  struct prefix_list_entry *dup;</a>
<a name="ln673">  struct prefix p;</a>
<a name="ln674">  int any = 0;</a>
<a name="ln675">  int seqnum = -1;</a>
<a name="ln676">  int lenum = 0;</a>
<a name="ln677">  int genum = 0;</a>
<a name="ln678">  </a>
<a name="ln679">  /* This code only works for IP.  Provide a safe-guard and user-visible</a>
<a name="ln680">   * warning</a>
<a name="ln681">   */</a>
<a name="ln682">  if (!(afi == AFI_IP || afi == AFI_IP6))</a>
<a name="ln683">    {</a>
<a name="ln684">      vty_out (vty, &quot;%% prefix must be IPv4 or IPv6!%s&quot;, VTY_NEWLINE);</a>
<a name="ln685">      return CMD_WARNING;</a>
<a name="ln686">    }</a>
<a name="ln687">  </a>
<a name="ln688">  /* Sequential number. */</a>
<a name="ln689">  if (seq)</a>
<a name="ln690">    seqnum = atoi (seq);</a>
<a name="ln691"> </a>
<a name="ln692">  /* ge and le number */</a>
<a name="ln693">  if (ge)</a>
<a name="ln694">    genum = atoi (ge);</a>
<a name="ln695">  if (le)</a>
<a name="ln696">    lenum = atoi (le);</a>
<a name="ln697"> </a>
<a name="ln698">  /* Check filter type. */</a>
<a name="ln699">  if (strncmp (&quot;permit&quot;, typestr, 1) == 0)</a>
<a name="ln700">    type = PREFIX_PERMIT;</a>
<a name="ln701">  else if (strncmp (&quot;deny&quot;, typestr, 1) == 0)</a>
<a name="ln702">    type = PREFIX_DENY;</a>
<a name="ln703">  else</a>
<a name="ln704">    {</a>
<a name="ln705">      vty_out (vty, &quot;%% prefix type must be permit or deny%s&quot;, VTY_NEWLINE);</a>
<a name="ln706">      return CMD_WARNING;</a>
<a name="ln707">    }</a>
<a name="ln708"> </a>
<a name="ln709">  /* &quot;any&quot; is special token for matching any IPv4 addresses.  */</a>
<a name="ln710">  switch (afi)</a>
<a name="ln711">    {</a>
<a name="ln712">    case AFI_IP:</a>
<a name="ln713">      if (strncmp (&quot;any&quot;, prefix, strlen (prefix)) == 0)</a>
<a name="ln714">	{</a>
<a name="ln715">	  ret = str2prefix_ipv4 (&quot;0.0.0.0/0&quot;, (struct prefix_ipv4 *) &amp;p);</a>
<a name="ln716">	  genum = 0;</a>
<a name="ln717">	  lenum = IPV4_MAX_BITLEN;</a>
<a name="ln718">	  any = 1;</a>
<a name="ln719">	}</a>
<a name="ln720">      else</a>
<a name="ln721">	ret = str2prefix_ipv4 (prefix, (struct prefix_ipv4 *) &amp;p);</a>
<a name="ln722"> </a>
<a name="ln723">      if (ret &lt;= 0)</a>
<a name="ln724">	{</a>
<a name="ln725">	  vty_out (vty, &quot;%% Malformed IPv4 prefix%s&quot;, VTY_NEWLINE);</a>
<a name="ln726">	  return CMD_WARNING;</a>
<a name="ln727">	}</a>
<a name="ln728">      break;</a>
<a name="ln729">    case AFI_IP6:</a>
<a name="ln730">      if (strncmp (&quot;any&quot;, prefix, strlen (prefix)) == 0)</a>
<a name="ln731">	{</a>
<a name="ln732">	  ret = str2prefix_ipv6 (&quot;::/0&quot;, (struct prefix_ipv6 *) &amp;p);</a>
<a name="ln733">	  genum = 0;</a>
<a name="ln734">	  lenum = IPV6_MAX_BITLEN;</a>
<a name="ln735">	  any = 1;</a>
<a name="ln736">	}</a>
<a name="ln737">      else</a>
<a name="ln738">	ret = str2prefix_ipv6 (prefix, (struct prefix_ipv6 *) &amp;p);</a>
<a name="ln739"> </a>
<a name="ln740">      if (ret &lt;= 0)</a>
<a name="ln741">	{</a>
<a name="ln742">	  vty_out (vty, &quot;%% Malformed IPv6 prefix%s&quot;, VTY_NEWLINE);</a>
<a name="ln743">	  return CMD_WARNING;</a>
<a name="ln744">	}</a>
<a name="ln745">      break;</a>
<a name="ln746">    case AFI_ETHER:</a>
<a name="ln747">    default:</a>
<a name="ln748">      vty_out (vty, &quot;%% Unrecognized AFI (%d)%s&quot;, afi, VTY_NEWLINE);</a>
<a name="ln749">      return CMD_WARNING;</a>
<a name="ln750">      break;</a>
<a name="ln751">    }</a>
<a name="ln752"> </a>
<a name="ln753">  /* ge and le check. */</a>
<a name="ln754">  if (genum &amp;&amp; (genum &lt;= p.prefixlen))</a>
<a name="ln755">    return vty_invalid_prefix_range (vty, prefix);</a>
<a name="ln756"> </a>
<a name="ln757">  if (lenum &amp;&amp; (lenum &lt;= p.prefixlen))</a>
<a name="ln758">    return vty_invalid_prefix_range (vty, prefix);</a>
<a name="ln759"> </a>
<a name="ln760">  if (lenum &amp;&amp; (genum &gt; lenum))</a>
<a name="ln761">    return vty_invalid_prefix_range (vty, prefix);</a>
<a name="ln762"> </a>
<a name="ln763">  if (genum &amp;&amp; (lenum == (afi == AFI_IP ? 32 : 128)))</a>
<a name="ln764">    lenum = 0;</a>
<a name="ln765"> </a>
<a name="ln766">  /* Get prefix_list with name. */</a>
<a name="ln767">  plist = prefix_list_get (afi, 0, name);</a>
<a name="ln768"> </a>
<a name="ln769">  /* Make prefix entry. */</a>
<a name="ln770">  pentry = prefix_list_entry_make (&amp;p, type, seqnum, lenum, genum, any);</a>
<a name="ln771">    </a>
<a name="ln772">  /* Check same policy. */</a>
<a name="ln773">  dup = prefix_entry_dup_check (plist, pentry);</a>
<a name="ln774"> </a>
<a name="ln775">  if (dup)</a>
<a name="ln776">    {</a>
<a name="ln777">      prefix_list_entry_free (pentry);</a>
<a name="ln778">      vty_out (vty, &quot;%% Insertion failed - prefix-list entry exists:%s&quot;,</a>
<a name="ln779">	       VTY_NEWLINE);</a>
<a name="ln780">      vty_out (vty, &quot;   seq %d %s %s&quot;, dup-&gt;seq, typestr, prefix);</a>
<a name="ln781">      if (! any &amp;&amp; genum)</a>
<a name="ln782">	vty_out (vty, &quot; ge %d&quot;, genum);</a>
<a name="ln783">      if (! any &amp;&amp; lenum)</a>
<a name="ln784">	vty_out (vty, &quot; le %d&quot;, lenum);</a>
<a name="ln785">      vty_out (vty, &quot;%s&quot;, VTY_NEWLINE);</a>
<a name="ln786">      return CMD_WARNING;</a>
<a name="ln787">    }</a>
<a name="ln788"> </a>
<a name="ln789">  /* Install new filter to the access_list. */</a>
<a name="ln790">  prefix_list_entry_add (plist, pentry);</a>
<a name="ln791"> </a>
<a name="ln792">  return CMD_SUCCESS;</a>
<a name="ln793">}</a>
<a name="ln794"> </a>
<a name="ln795">static int</a>
<a name="ln796">vty_prefix_list_uninstall (struct vty *vty, afi_t afi, const char *name, </a>
<a name="ln797">                           const char *seq, const char *typestr,</a>
<a name="ln798">			   const char *prefix, const char *ge, const char *le)</a>
<a name="ln799">{</a>
<a name="ln800">  int ret;</a>
<a name="ln801">  enum prefix_list_type type;</a>
<a name="ln802">  struct prefix_list *plist;</a>
<a name="ln803">  struct prefix_list_entry *pentry;</a>
<a name="ln804">  struct prefix p;</a>
<a name="ln805">  int seqnum = -1;</a>
<a name="ln806">  int lenum = 0;</a>
<a name="ln807">  int genum = 0;</a>
<a name="ln808"> </a>
<a name="ln809">  /* Check prefix list name. */</a>
<a name="ln810">  plist = prefix_list_lookup (afi, name);</a>
<a name="ln811">  if (! plist)</a>
<a name="ln812">    {</a>
<a name="ln813">      vty_out (vty, &quot;%% Can't find specified prefix-list%s&quot;, VTY_NEWLINE);</a>
<a name="ln814">      return CMD_WARNING;</a>
<a name="ln815">    }</a>
<a name="ln816"> </a>
<a name="ln817">  /* Only prefix-list name specified, delete the entire prefix-list. */</a>
<a name="ln818">  if (seq == NULL &amp;&amp; typestr == NULL &amp;&amp; prefix == NULL &amp;&amp; </a>
<a name="ln819">      ge == NULL &amp;&amp; le == NULL)</a>
<a name="ln820">    {</a>
<a name="ln821">      prefix_list_delete (plist);</a>
<a name="ln822">      return CMD_SUCCESS;</a>
<a name="ln823">    }</a>
<a name="ln824"> </a>
<a name="ln825">  /* We must have, at a minimum, both the type and prefix here */</a>
<a name="ln826">  if ((typestr == NULL) || (prefix == NULL))</a>
<a name="ln827">    {</a>
<a name="ln828">      vty_out (vty, &quot;%% Both prefix and type required%s&quot;, VTY_NEWLINE);</a>
<a name="ln829">      return CMD_WARNING;</a>
<a name="ln830">    }</a>
<a name="ln831"> </a>
<a name="ln832">  /* Check sequence number. */</a>
<a name="ln833">  if (seq)</a>
<a name="ln834">    seqnum = atoi (seq);</a>
<a name="ln835"> </a>
<a name="ln836">  /* ge and le number */</a>
<a name="ln837">  if (ge)</a>
<a name="ln838">    genum = atoi (ge);</a>
<a name="ln839">  if (le)</a>
<a name="ln840">    lenum = atoi (le);</a>
<a name="ln841"> </a>
<a name="ln842">  /* Check of filter type. */</a>
<a name="ln843">  if (strncmp (&quot;permit&quot;, typestr, 1) == 0)</a>
<a name="ln844">    type = PREFIX_PERMIT;</a>
<a name="ln845">  else if (strncmp (&quot;deny&quot;, typestr, 1) == 0)</a>
<a name="ln846">    type = PREFIX_DENY;</a>
<a name="ln847">  else</a>
<a name="ln848">    {</a>
<a name="ln849">      vty_out (vty, &quot;%% prefix type must be permit or deny%s&quot;, VTY_NEWLINE);</a>
<a name="ln850">      return CMD_WARNING;</a>
<a name="ln851">    }</a>
<a name="ln852"> </a>
<a name="ln853">  /* &quot;any&quot; is special token for matching any IPv4 addresses.  */</a>
<a name="ln854">  if (afi == AFI_IP)</a>
<a name="ln855">    {</a>
<a name="ln856">      if (strncmp (&quot;any&quot;, prefix, strlen (prefix)) == 0)</a>
<a name="ln857">	{</a>
<a name="ln858">	  ret = str2prefix_ipv4 (&quot;0.0.0.0/0&quot;, (struct prefix_ipv4 *) &amp;p);</a>
<a name="ln859">	  genum = 0;</a>
<a name="ln860">	  lenum = IPV4_MAX_BITLEN;</a>
<a name="ln861">	}</a>
<a name="ln862">      else</a>
<a name="ln863">	ret = str2prefix_ipv4 (prefix, (struct prefix_ipv4 *) &amp;p);</a>
<a name="ln864"> </a>
<a name="ln865">      if (ret &lt;= 0)</a>
<a name="ln866">	{</a>
<a name="ln867">	  vty_out (vty, &quot;%% Malformed IPv4 prefix%s&quot;, VTY_NEWLINE);</a>
<a name="ln868">	  return CMD_WARNING;</a>
<a name="ln869">	}</a>
<a name="ln870">    }</a>
<a name="ln871">#ifdef HAVE_IPV6</a>
<a name="ln872">  else if (afi == AFI_IP6)</a>
<a name="ln873">    {</a>
<a name="ln874">      if (strncmp (&quot;any&quot;, prefix, strlen (prefix)) == 0)</a>
<a name="ln875">	{</a>
<a name="ln876">	  ret = str2prefix_ipv6 (&quot;::/0&quot;, (struct prefix_ipv6 *) &amp;p);</a>
<a name="ln877">	  genum = 0;</a>
<a name="ln878">	  lenum = IPV6_MAX_BITLEN;</a>
<a name="ln879">	}</a>
<a name="ln880">      else</a>
<a name="ln881">	ret = str2prefix_ipv6 (prefix, (struct prefix_ipv6 *) &amp;p);</a>
<a name="ln882"> </a>
<a name="ln883">      if (ret &lt;= 0)</a>
<a name="ln884">	{</a>
<a name="ln885">	  vty_out (vty, &quot;%% Malformed IPv6 prefix%s&quot;, VTY_NEWLINE);</a>
<a name="ln886">	  return CMD_WARNING;</a>
<a name="ln887">	}</a>
<a name="ln888">    }</a>
<a name="ln889">#endif /* HAVE_IPV6 */</a>
<a name="ln890"> </a>
<a name="ln891">  /* Lookup prefix entry. */</a>
<a name="ln892">  pentry = prefix_list_entry_lookup(plist, &amp;p, type, seqnum, lenum, genum);</a>
<a name="ln893"> </a>
<a name="ln894">  if (pentry == NULL)</a>
<a name="ln895">    {</a>
<a name="ln896">      vty_out (vty, &quot;%% Can't find specified prefix-list%s&quot;, VTY_NEWLINE);</a>
<a name="ln897">      return CMD_WARNING;</a>
<a name="ln898">    }</a>
<a name="ln899"> </a>
<a name="ln900">  /* Install new filter to the access_list. */</a>
<a name="ln901">  prefix_list_entry_delete (plist, pentry, 1);</a>
<a name="ln902"> </a>
<a name="ln903">  return CMD_SUCCESS;</a>
<a name="ln904">}</a>
<a name="ln905"> </a>
<a name="ln906">static int</a>
<a name="ln907">vty_prefix_list_desc_unset (struct vty *vty, afi_t afi, const char *name)</a>
<a name="ln908">{</a>
<a name="ln909">  struct prefix_list *plist;</a>
<a name="ln910"> </a>
<a name="ln911">  plist = prefix_list_lookup (afi, name);</a>
<a name="ln912">  if (! plist)</a>
<a name="ln913">    {</a>
<a name="ln914">      vty_out (vty, &quot;%% Can't find specified prefix-list%s&quot;, VTY_NEWLINE);</a>
<a name="ln915">      return CMD_WARNING;</a>
<a name="ln916">    }</a>
<a name="ln917"> </a>
<a name="ln918">  if (plist-&gt;desc)</a>
<a name="ln919">    {</a>
<a name="ln920">      XFREE (MTYPE_TMP, plist-&gt;desc);</a>
<a name="ln921">      plist-&gt;desc = NULL;</a>
<a name="ln922">    }</a>
<a name="ln923"> </a>
<a name="ln924">  if (plist-&gt;head == NULL &amp;&amp; plist-&gt;tail == NULL &amp;&amp; plist-&gt;desc == NULL)</a>
<a name="ln925">    prefix_list_delete (plist);</a>
<a name="ln926"> </a>
<a name="ln927">  return CMD_SUCCESS;</a>
<a name="ln928">}</a>
<a name="ln929"> </a>
<a name="ln930">enum display_type</a>
<a name="ln931">{</a>
<a name="ln932">  normal_display,</a>
<a name="ln933">  summary_display,</a>
<a name="ln934">  detail_display,</a>
<a name="ln935">  sequential_display,</a>
<a name="ln936">  longer_display,</a>
<a name="ln937">  first_match_display</a>
<a name="ln938">};</a>
<a name="ln939"> </a>
<a name="ln940">static void</a>
<a name="ln941">vty_show_prefix_entry (struct vty *vty, afi_t afi, struct prefix_list *plist,</a>
<a name="ln942">		       struct prefix_master *master, enum display_type dtype,</a>
<a name="ln943">		       int seqnum)</a>
<a name="ln944">{</a>
<a name="ln945">  struct prefix_list_entry *pentry;</a>
<a name="ln946"> </a>
<a name="ln947">  /* Print the name of the protocol */</a>
<a name="ln948">  if (zlog_default)</a>
<a name="ln949">      vty_out (vty, &quot;%s: &quot;, zlog_proto_names[zlog_default-&gt;protocol]);</a>
<a name="ln950">                                                                           </a>
<a name="ln951">  if (dtype == normal_display)</a>
<a name="ln952">    {</a>
<a name="ln953">      vty_out (vty, &quot;ip%s prefix-list %s: %d entries%s&quot;,</a>
<a name="ln954">	       afi == AFI_IP ? &quot;&quot; : &quot;v6&quot;,</a>
<a name="ln955">	       plist-&gt;name, plist-&gt;count, VTY_NEWLINE);</a>
<a name="ln956">      if (plist-&gt;desc)</a>
<a name="ln957">	vty_out (vty, &quot;   Description: %s%s&quot;, plist-&gt;desc, VTY_NEWLINE);</a>
<a name="ln958">    }</a>
<a name="ln959">  else if (dtype == summary_display || dtype == detail_display)</a>
<a name="ln960">    {</a>
<a name="ln961">      vty_out (vty, &quot;ip%s prefix-list %s:%s&quot;,</a>
<a name="ln962">	       afi == AFI_IP ? &quot;&quot; : &quot;v6&quot;, plist-&gt;name, VTY_NEWLINE);</a>
<a name="ln963"> </a>
<a name="ln964">      if (plist-&gt;desc)</a>
<a name="ln965">	vty_out (vty, &quot;   Description: %s%s&quot;, plist-&gt;desc, VTY_NEWLINE);</a>
<a name="ln966"> </a>
<a name="ln967">      vty_out (vty, &quot;   count: %d, range entries: %d, sequences: %d - %d%s&quot;,</a>
<a name="ln968">	       plist-&gt;count, plist-&gt;rangecount, </a>
<a name="ln969">	       plist-&gt;head ? plist-&gt;head-&gt;seq : 0, </a>
<a name="ln970">	       plist-&gt;tail ? plist-&gt;tail-&gt;seq : 0,</a>
<a name="ln971">	       VTY_NEWLINE);</a>
<a name="ln972">    }</a>
<a name="ln973"> </a>
<a name="ln974">  if (dtype != summary_display)</a>
<a name="ln975">    {</a>
<a name="ln976">      for (pentry = plist-&gt;head; pentry; pentry = pentry-&gt;next)</a>
<a name="ln977">	{</a>
<a name="ln978">	  if (dtype == sequential_display &amp;&amp; pentry-&gt;seq != seqnum)</a>
<a name="ln979">	    continue;</a>
<a name="ln980">	    </a>
<a name="ln981">	  vty_out (vty, &quot;   &quot;);</a>
<a name="ln982"> </a>
<a name="ln983">	  if (master-&gt;seqnum)</a>
<a name="ln984">	    vty_out (vty, &quot;seq %d &quot;, pentry-&gt;seq);</a>
<a name="ln985"> </a>
<a name="ln986">	  vty_out (vty, &quot;%s &quot;, prefix_list_type_str (pentry));</a>
<a name="ln987"> </a>
<a name="ln988">	  if (pentry-&gt;any)</a>
<a name="ln989">	    vty_out (vty, &quot;any&quot;);</a>
<a name="ln990">	  else</a>
<a name="ln991">	    {</a>
<a name="ln992">	      struct prefix *p = &amp;pentry-&gt;prefix;</a>
<a name="ln993">	      char buf[BUFSIZ];</a>
<a name="ln994"> </a>
<a name="ln995">	      vty_out (vty, &quot;%s/%d&quot;,</a>
<a name="ln996">		       inet_ntop (p-&gt;family, &amp;p-&gt;u.prefix, buf, BUFSIZ),</a>
<a name="ln997">		       p-&gt;prefixlen);</a>
<a name="ln998"> </a>
<a name="ln999">	      if (pentry-&gt;ge)</a>
<a name="ln1000">		vty_out (vty, &quot; ge %d&quot;, pentry-&gt;ge);</a>
<a name="ln1001">	      if (pentry-&gt;le)</a>
<a name="ln1002">		vty_out (vty, &quot; le %d&quot;, pentry-&gt;le);</a>
<a name="ln1003">	    }</a>
<a name="ln1004"> </a>
<a name="ln1005">	  if (dtype == detail_display || dtype == sequential_display)</a>
<a name="ln1006">	    vty_out (vty, &quot; (hit count: %ld, refcount: %ld)&quot;, </a>
<a name="ln1007">		     pentry-&gt;hitcnt, pentry-&gt;refcnt);</a>
<a name="ln1008">	  </a>
<a name="ln1009">	  vty_out (vty, &quot;%s&quot;, VTY_NEWLINE);</a>
<a name="ln1010">	}</a>
<a name="ln1011">    }</a>
<a name="ln1012">}</a>
<a name="ln1013"> </a>
<a name="ln1014">static int</a>
<a name="ln1015">vty_show_prefix_list (struct vty *vty, afi_t afi, const char *name,</a>
<a name="ln1016">		      const char *seq, enum display_type dtype)</a>
<a name="ln1017">{</a>
<a name="ln1018">  struct prefix_list *plist;</a>
<a name="ln1019">  struct prefix_master *master;</a>
<a name="ln1020">  int seqnum = 0;</a>
<a name="ln1021"> </a>
<a name="ln1022">  master = prefix_master_get (afi, 0);</a>
<a name="ln1023">  if (master == NULL)</a>
<a name="ln1024">    return CMD_WARNING;</a>
<a name="ln1025"> </a>
<a name="ln1026">  if (seq)</a>
<a name="ln1027">    seqnum = atoi (seq);</a>
<a name="ln1028"> </a>
<a name="ln1029">  if (name)</a>
<a name="ln1030">    {</a>
<a name="ln1031">      plist = prefix_list_lookup (afi, name);</a>
<a name="ln1032">      if (! plist)</a>
<a name="ln1033">	{</a>
<a name="ln1034">	  vty_out (vty, &quot;%% Can't find specified prefix-list%s&quot;, VTY_NEWLINE);</a>
<a name="ln1035">	  return CMD_WARNING;</a>
<a name="ln1036">	}</a>
<a name="ln1037">      vty_show_prefix_entry (vty, afi, plist, master, dtype, seqnum);</a>
<a name="ln1038">    }</a>
<a name="ln1039">  else</a>
<a name="ln1040">    {</a>
<a name="ln1041">      if (dtype == detail_display || dtype == summary_display)</a>
<a name="ln1042">	{</a>
<a name="ln1043">	  if (master-&gt;recent)</a>
<a name="ln1044">	    vty_out (vty, &quot;Prefix-list with the last deletion/insertion: %s%s&quot;,</a>
<a name="ln1045">		     master-&gt;recent-&gt;name, VTY_NEWLINE);</a>
<a name="ln1046">	}</a>
<a name="ln1047"> </a>
<a name="ln1048">      for (plist = master-&gt;num.head; plist; plist = plist-&gt;next)</a>
<a name="ln1049">	vty_show_prefix_entry (vty, afi, plist, master, dtype, seqnum);</a>
<a name="ln1050"> </a>
<a name="ln1051">      for (plist = master-&gt;str.head; plist; plist = plist-&gt;next)</a>
<a name="ln1052">	vty_show_prefix_entry (vty, afi, plist, master, dtype, seqnum);</a>
<a name="ln1053">    }</a>
<a name="ln1054"> </a>
<a name="ln1055">  return CMD_SUCCESS;</a>
<a name="ln1056">}</a>
<a name="ln1057"> </a>
<a name="ln1058">static int</a>
<a name="ln1059">vty_show_prefix_list_prefix (struct vty *vty, afi_t afi, const char *name, </a>
<a name="ln1060">			     const char *prefix, enum display_type type)</a>
<a name="ln1061">{</a>
<a name="ln1062">  struct prefix_list *plist;</a>
<a name="ln1063">  struct prefix_list_entry *pentry;</a>
<a name="ln1064">  struct prefix p;</a>
<a name="ln1065">  int ret;</a>
<a name="ln1066">  int match;</a>
<a name="ln1067"> </a>
<a name="ln1068">  plist = prefix_list_lookup (afi, name);</a>
<a name="ln1069">  if (! plist)</a>
<a name="ln1070">    {</a>
<a name="ln1071">      vty_out (vty, &quot;%% Can't find specified prefix-list%s&quot;, VTY_NEWLINE);</a>
<a name="ln1072">      return CMD_WARNING;</a>
<a name="ln1073">    }</a>
<a name="ln1074"> </a>
<a name="ln1075">  ret = str2prefix (prefix, &amp;p);</a>
<a name="ln1076">  if (ret &lt;= 0)</a>
<a name="ln1077">    {</a>
<a name="ln1078">      vty_out (vty, &quot;%% prefix is malformed%s&quot;, VTY_NEWLINE);</a>
<a name="ln1079">      return CMD_WARNING;</a>
<a name="ln1080">    }</a>
<a name="ln1081"> </a>
<a name="ln1082">  for (pentry = plist-&gt;head; pentry; pentry = pentry-&gt;next)</a>
<a name="ln1083">    {</a>
<a name="ln1084">      match = 0;</a>
<a name="ln1085"> </a>
<a name="ln1086">      if (type == normal_display || type == first_match_display)</a>
<a name="ln1087">	if (prefix_same (&amp;p, &amp;pentry-&gt;prefix))</a>
<a name="ln1088">	  match = 1;</a>
<a name="ln1089"> </a>
<a name="ln1090">      if (type == longer_display)</a>
<a name="ln1091">	if (prefix_match (&amp;p, &amp;pentry-&gt;prefix))</a>
<a name="ln1092">	  match = 1;</a>
<a name="ln1093"> </a>
<a name="ln1094">      if (match)</a>
<a name="ln1095">	{</a>
<a name="ln1096">	  vty_out (vty, &quot;   seq %d %s &quot;, </a>
<a name="ln1097">		   pentry-&gt;seq,</a>
<a name="ln1098">		   prefix_list_type_str (pentry));</a>
<a name="ln1099"> </a>
<a name="ln1100">	  if (pentry-&gt;any)</a>
<a name="ln1101">	    vty_out (vty, &quot;any&quot;);</a>
<a name="ln1102">	  else</a>
<a name="ln1103">	    {</a>
<a name="ln1104">	      struct prefix *p = &amp;pentry-&gt;prefix;</a>
<a name="ln1105">	      char buf[BUFSIZ];</a>
<a name="ln1106">	      </a>
<a name="ln1107">	      vty_out (vty, &quot;%s/%d&quot;,</a>
<a name="ln1108">		       inet_ntop (p-&gt;family, &amp;p-&gt;u.prefix, buf, BUFSIZ),</a>
<a name="ln1109">		       p-&gt;prefixlen);</a>
<a name="ln1110"> </a>
<a name="ln1111">	      if (pentry-&gt;ge)</a>
<a name="ln1112">		vty_out (vty, &quot; ge %d&quot;, pentry-&gt;ge);</a>
<a name="ln1113">	      if (pentry-&gt;le)</a>
<a name="ln1114">		vty_out (vty, &quot; le %d&quot;, pentry-&gt;le);</a>
<a name="ln1115">	    }</a>
<a name="ln1116">	  </a>
<a name="ln1117">	  if (type == normal_display || type == first_match_display)</a>
<a name="ln1118">	    vty_out (vty, &quot; (hit count: %ld, refcount: %ld)&quot;, </a>
<a name="ln1119">		     pentry-&gt;hitcnt, pentry-&gt;refcnt);</a>
<a name="ln1120"> </a>
<a name="ln1121">	  vty_out (vty, &quot;%s&quot;, VTY_NEWLINE);</a>
<a name="ln1122"> </a>
<a name="ln1123">	  if (type == first_match_display)</a>
<a name="ln1124">	    return CMD_SUCCESS;</a>
<a name="ln1125">	}</a>
<a name="ln1126">    }</a>
<a name="ln1127">  return CMD_SUCCESS;</a>
<a name="ln1128">}</a>
<a name="ln1129"> </a>
<a name="ln1130">static int</a>
<a name="ln1131">vty_clear_prefix_list (struct vty *vty, afi_t afi, const char *name, </a>
<a name="ln1132">                       const char *prefix)</a>
<a name="ln1133">{</a>
<a name="ln1134">  struct prefix_master *master;</a>
<a name="ln1135">  struct prefix_list *plist;</a>
<a name="ln1136">  struct prefix_list_entry *pentry;</a>
<a name="ln1137">  int ret;</a>
<a name="ln1138">  struct prefix p;</a>
<a name="ln1139"> </a>
<a name="ln1140">  master = prefix_master_get (afi, 0);</a>
<a name="ln1141">  if (master == NULL)</a>
<a name="ln1142">    return CMD_WARNING;</a>
<a name="ln1143"> </a>
<a name="ln1144">  if (name == NULL &amp;&amp; prefix == NULL)</a>
<a name="ln1145">    {</a>
<a name="ln1146">      for (plist = master-&gt;num.head; plist; plist = plist-&gt;next)</a>
<a name="ln1147">	for (pentry = plist-&gt;head; pentry; pentry = pentry-&gt;next)</a>
<a name="ln1148">	  pentry-&gt;hitcnt = 0;</a>
<a name="ln1149"> </a>
<a name="ln1150">      for (plist = master-&gt;str.head; plist; plist = plist-&gt;next)</a>
<a name="ln1151">	for (pentry = plist-&gt;head; pentry; pentry = pentry-&gt;next)</a>
<a name="ln1152">	  pentry-&gt;hitcnt = 0;</a>
<a name="ln1153">    }</a>
<a name="ln1154">  else</a>
<a name="ln1155">    {</a>
<a name="ln1156">      plist = prefix_list_lookup (afi, name);</a>
<a name="ln1157">      if (! plist)</a>
<a name="ln1158">	{</a>
<a name="ln1159">	  vty_out (vty, &quot;%% Can't find specified prefix-list%s&quot;, VTY_NEWLINE);</a>
<a name="ln1160">	  return CMD_WARNING;</a>
<a name="ln1161">	}</a>
<a name="ln1162"> </a>
<a name="ln1163">      if (prefix)</a>
<a name="ln1164">	{</a>
<a name="ln1165">	  ret = str2prefix (prefix, &amp;p);</a>
<a name="ln1166">	  if (ret &lt;= 0)</a>
<a name="ln1167">	    {</a>
<a name="ln1168">	      vty_out (vty, &quot;%% prefix is malformed%s&quot;, VTY_NEWLINE);</a>
<a name="ln1169">	      return CMD_WARNING;</a>
<a name="ln1170">	    }</a>
<a name="ln1171">	}</a>
<a name="ln1172"> </a>
<a name="ln1173">      for (pentry = plist-&gt;head; pentry; pentry = pentry-&gt;next)</a>
<a name="ln1174">	{</a>
<a name="ln1175">	  if (prefix)</a>
<a name="ln1176">	    {</a>
<a name="ln1177">	      if (prefix_match (&amp;pentry-&gt;prefix, &amp;p))</a>
<a name="ln1178">		pentry-&gt;hitcnt = 0;</a>
<a name="ln1179">	    }</a>
<a name="ln1180">	  else</a>
<a name="ln1181">	    pentry-&gt;hitcnt = 0;</a>
<a name="ln1182">	}</a>
<a name="ln1183">    }</a>
<a name="ln1184">  return CMD_SUCCESS;</a>
<a name="ln1185">}</a>
<a name="ln1186"> </a>
<a name="ln1187">DEFUN (ip_prefix_list,</a>
<a name="ln1188">       ip_prefix_list_cmd,</a>
<a name="ln1189">       &quot;ip prefix-list WORD (deny|permit) (A.B.C.D/M|any)&quot;,</a>
<a name="ln1190">       IP_STR</a>
<a name="ln1191">       PREFIX_LIST_STR</a>
<a name="ln1192">       &quot;Name of a prefix list\n&quot;</a>
<a name="ln1193">       &quot;Specify packets to reject\n&quot;</a>
<a name="ln1194">       &quot;Specify packets to forward\n&quot;</a>
<a name="ln1195">       &quot;IP prefix &lt;network&gt;/&lt;length&gt;, e.g., 35.0.0.0/8\n&quot;</a>
<a name="ln1196">       &quot;Any prefix match. Same as \&quot;0.0.0.0/0 le 32\&quot;\n&quot;)</a>
<a name="ln1197">{</a>
<a name="ln1198">  return vty_prefix_list_install (vty, AFI_IP, argv[0], NULL, </a>
<a name="ln1199">				  argv[1], argv[2], NULL, NULL);</a>
<a name="ln1200">}</a>
<a name="ln1201"> </a>
<a name="ln1202">DEFUN (ip_prefix_list_ge,</a>
<a name="ln1203">       ip_prefix_list_ge_cmd,</a>
<a name="ln1204">       &quot;ip prefix-list WORD (deny|permit) A.B.C.D/M ge &lt;0-32&gt;&quot;,</a>
<a name="ln1205">       IP_STR</a>
<a name="ln1206">       PREFIX_LIST_STR</a>
<a name="ln1207">       &quot;Name of a prefix list\n&quot;</a>
<a name="ln1208">       &quot;Specify packets to reject\n&quot;</a>
<a name="ln1209">       &quot;Specify packets to forward\n&quot;</a>
<a name="ln1210">       &quot;IP prefix &lt;network&gt;/&lt;length&gt;, e.g., 35.0.0.0/8\n&quot;</a>
<a name="ln1211">       &quot;Minimum prefix length to be matched\n&quot;</a>
<a name="ln1212">       &quot;Minimum prefix length\n&quot;)</a>
<a name="ln1213">{</a>
<a name="ln1214">  return vty_prefix_list_install (vty, AFI_IP, argv[0], NULL, argv[1], </a>
<a name="ln1215">				 argv[2], argv[3], NULL);</a>
<a name="ln1216">}</a>
<a name="ln1217"> </a>
<a name="ln1218">DEFUN (ip_prefix_list_ge_le,</a>
<a name="ln1219">       ip_prefix_list_ge_le_cmd,</a>
<a name="ln1220">       &quot;ip prefix-list WORD (deny|permit) A.B.C.D/M ge &lt;0-32&gt; le &lt;0-32&gt;&quot;,</a>
<a name="ln1221">       IP_STR</a>
<a name="ln1222">       PREFIX_LIST_STR</a>
<a name="ln1223">       &quot;Name of a prefix list\n&quot;</a>
<a name="ln1224">       &quot;Specify packets to reject\n&quot;</a>
<a name="ln1225">       &quot;Specify packets to forward\n&quot;</a>
<a name="ln1226">       &quot;IP prefix &lt;network&gt;/&lt;length&gt;, e.g., 35.0.0.0/8\n&quot;</a>
<a name="ln1227">       &quot;Minimum prefix length to be matched\n&quot;</a>
<a name="ln1228">       &quot;Minimum prefix length\n&quot;</a>
<a name="ln1229">       &quot;Maximum prefix length to be matched\n&quot;</a>
<a name="ln1230">       &quot;Maximum prefix length\n&quot;)</a>
<a name="ln1231">{</a>
<a name="ln1232">  return vty_prefix_list_install (vty, AFI_IP, argv[0], NULL, argv[1], </a>
<a name="ln1233">				  argv[2], argv[3], argv[4]);</a>
<a name="ln1234">}</a>
<a name="ln1235"> </a>
<a name="ln1236">DEFUN (ip_prefix_list_le,</a>
<a name="ln1237">       ip_prefix_list_le_cmd,</a>
<a name="ln1238">       &quot;ip prefix-list WORD (deny|permit) A.B.C.D/M le &lt;0-32&gt;&quot;,</a>
<a name="ln1239">       IP_STR</a>
<a name="ln1240">       PREFIX_LIST_STR</a>
<a name="ln1241">       &quot;Name of a prefix list\n&quot;</a>
<a name="ln1242">       &quot;Specify packets to reject\n&quot;</a>
<a name="ln1243">       &quot;Specify packets to forward\n&quot;</a>
<a name="ln1244">       &quot;IP prefix &lt;network&gt;/&lt;length&gt;, e.g., 35.0.0.0/8\n&quot;</a>
<a name="ln1245">       &quot;Maximum prefix length to be matched\n&quot;</a>
<a name="ln1246">       &quot;Maximum prefix length\n&quot;)</a>
<a name="ln1247">{</a>
<a name="ln1248">  return vty_prefix_list_install (vty, AFI_IP, argv[0], NULL, argv[1],</a>
<a name="ln1249">				  argv[2], NULL, argv[3]);</a>
<a name="ln1250">}</a>
<a name="ln1251"> </a>
<a name="ln1252">DEFUN (ip_prefix_list_le_ge,</a>
<a name="ln1253">       ip_prefix_list_le_ge_cmd,</a>
<a name="ln1254">       &quot;ip prefix-list WORD (deny|permit) A.B.C.D/M le &lt;0-32&gt; ge &lt;0-32&gt;&quot;,</a>
<a name="ln1255">       IP_STR</a>
<a name="ln1256">       PREFIX_LIST_STR</a>
<a name="ln1257">       &quot;Name of a prefix list\n&quot;</a>
<a name="ln1258">       &quot;Specify packets to reject\n&quot;</a>
<a name="ln1259">       &quot;Specify packets to forward\n&quot;</a>
<a name="ln1260">       &quot;IP prefix &lt;network&gt;/&lt;length&gt;, e.g., 35.0.0.0/8\n&quot;</a>
<a name="ln1261">       &quot;Maximum prefix length to be matched\n&quot;</a>
<a name="ln1262">       &quot;Maximum prefix length\n&quot;</a>
<a name="ln1263">       &quot;Minimum prefix length to be matched\n&quot;</a>
<a name="ln1264">       &quot;Minimum prefix length\n&quot;)</a>
<a name="ln1265">{</a>
<a name="ln1266">  return vty_prefix_list_install (vty, AFI_IP, argv[0], NULL, argv[1],</a>
<a name="ln1267">				  argv[2], argv[4], argv[3]);</a>
<a name="ln1268">}</a>
<a name="ln1269"> </a>
<a name="ln1270">DEFUN (ip_prefix_list_seq,</a>
<a name="ln1271">       ip_prefix_list_seq_cmd,</a>
<a name="ln1272">       &quot;ip prefix-list WORD seq &lt;1-4294967295&gt; (deny|permit) (A.B.C.D/M|any)&quot;,</a>
<a name="ln1273">       IP_STR</a>
<a name="ln1274">       PREFIX_LIST_STR</a>
<a name="ln1275">       &quot;Name of a prefix list\n&quot;</a>
<a name="ln1276">       &quot;sequence number of an entry\n&quot;</a>
<a name="ln1277">       &quot;Sequence number\n&quot;</a>
<a name="ln1278">       &quot;Specify packets to reject\n&quot;</a>
<a name="ln1279">       &quot;Specify packets to forward\n&quot;</a>
<a name="ln1280">       &quot;IP prefix &lt;network&gt;/&lt;length&gt;, e.g., 35.0.0.0/8\n&quot;</a>
<a name="ln1281">       &quot;Any prefix match. Same as \&quot;0.0.0.0/0 le 32\&quot;\n&quot;)</a>
<a name="ln1282">{</a>
<a name="ln1283">  return vty_prefix_list_install (vty, AFI_IP, argv[0], argv[1], argv[2],</a>
<a name="ln1284">				  argv[3], NULL, NULL);</a>
<a name="ln1285">}</a>
<a name="ln1286"> </a>
<a name="ln1287">DEFUN (ip_prefix_list_seq_ge,</a>
<a name="ln1288">       ip_prefix_list_seq_ge_cmd,</a>
<a name="ln1289">       &quot;ip prefix-list WORD seq &lt;1-4294967295&gt; (deny|permit) A.B.C.D/M ge &lt;0-32&gt;&quot;,</a>
<a name="ln1290">       IP_STR</a>
<a name="ln1291">       PREFIX_LIST_STR</a>
<a name="ln1292">       &quot;Name of a prefix list\n&quot;</a>
<a name="ln1293">       &quot;sequence number of an entry\n&quot;</a>
<a name="ln1294">       &quot;Sequence number\n&quot;</a>
<a name="ln1295">       &quot;Specify packets to reject\n&quot;</a>
<a name="ln1296">       &quot;Specify packets to forward\n&quot;</a>
<a name="ln1297">       &quot;IP prefix &lt;network&gt;/&lt;length&gt;, e.g., 35.0.0.0/8\n&quot;</a>
<a name="ln1298">       &quot;Minimum prefix length to be matched\n&quot;</a>
<a name="ln1299">       &quot;Minimum prefix length\n&quot;)</a>
<a name="ln1300">{</a>
<a name="ln1301">  return vty_prefix_list_install (vty, AFI_IP, argv[0], argv[1], argv[2],</a>
<a name="ln1302">				  argv[3], argv[4], NULL);</a>
<a name="ln1303">}</a>
<a name="ln1304"> </a>
<a name="ln1305">DEFUN (ip_prefix_list_seq_ge_le,</a>
<a name="ln1306">       ip_prefix_list_seq_ge_le_cmd,</a>
<a name="ln1307">       &quot;ip prefix-list WORD seq &lt;1-4294967295&gt; (deny|permit) A.B.C.D/M ge &lt;0-32&gt; le &lt;0-32&gt;&quot;,</a>
<a name="ln1308">       IP_STR</a>
<a name="ln1309">       PREFIX_LIST_STR</a>
<a name="ln1310">       &quot;Name of a prefix list\n&quot;</a>
<a name="ln1311">       &quot;sequence number of an entry\n&quot;</a>
<a name="ln1312">       &quot;Sequence number\n&quot;</a>
<a name="ln1313">       &quot;Specify packets to reject\n&quot;</a>
<a name="ln1314">       &quot;Specify packets to forward\n&quot;</a>
<a name="ln1315">       &quot;IP prefix &lt;network&gt;/&lt;length&gt;, e.g., 35.0.0.0/8\n&quot;</a>
<a name="ln1316">       &quot;Minimum prefix length to be matched\n&quot;</a>
<a name="ln1317">       &quot;Minimum prefix length\n&quot;</a>
<a name="ln1318">       &quot;Maximum prefix length to be matched\n&quot;</a>
<a name="ln1319">       &quot;Maximum prefix length\n&quot;)</a>
<a name="ln1320">{</a>
<a name="ln1321">  return vty_prefix_list_install (vty, AFI_IP, argv[0], argv[1], argv[2],</a>
<a name="ln1322">				  argv[3], argv[4], argv[5]);</a>
<a name="ln1323">}</a>
<a name="ln1324"> </a>
<a name="ln1325">DEFUN (ip_prefix_list_seq_le,</a>
<a name="ln1326">       ip_prefix_list_seq_le_cmd,</a>
<a name="ln1327">       &quot;ip prefix-list WORD seq &lt;1-4294967295&gt; (deny|permit) A.B.C.D/M le &lt;0-32&gt;&quot;,</a>
<a name="ln1328">       IP_STR</a>
<a name="ln1329">       PREFIX_LIST_STR</a>
<a name="ln1330">       &quot;Name of a prefix list\n&quot;</a>
<a name="ln1331">       &quot;sequence number of an entry\n&quot;</a>
<a name="ln1332">       &quot;Sequence number\n&quot;</a>
<a name="ln1333">       &quot;Specify packets to reject\n&quot;</a>
<a name="ln1334">       &quot;Specify packets to forward\n&quot;</a>
<a name="ln1335">       &quot;IP prefix &lt;network&gt;/&lt;length&gt;, e.g., 35.0.0.0/8\n&quot;</a>
<a name="ln1336">       &quot;Maximum prefix length to be matched\n&quot;</a>
<a name="ln1337">       &quot;Maximum prefix length\n&quot;)</a>
<a name="ln1338">{</a>
<a name="ln1339">  return vty_prefix_list_install (vty, AFI_IP, argv[0], argv[1], argv[2],</a>
<a name="ln1340">				  argv[3], NULL, argv[4]);</a>
<a name="ln1341">}</a>
<a name="ln1342"> </a>
<a name="ln1343">DEFUN (ip_prefix_list_seq_le_ge,</a>
<a name="ln1344">       ip_prefix_list_seq_le_ge_cmd,</a>
<a name="ln1345">       &quot;ip prefix-list WORD seq &lt;1-4294967295&gt; (deny|permit) A.B.C.D/M le &lt;0-32&gt; ge &lt;0-32&gt;&quot;,</a>
<a name="ln1346">       IP_STR</a>
<a name="ln1347">       PREFIX_LIST_STR</a>
<a name="ln1348">       &quot;Name of a prefix list\n&quot;</a>
<a name="ln1349">       &quot;sequence number of an entry\n&quot;</a>
<a name="ln1350">       &quot;Sequence number\n&quot;</a>
<a name="ln1351">       &quot;Specify packets to reject\n&quot;</a>
<a name="ln1352">       &quot;Specify packets to forward\n&quot;</a>
<a name="ln1353">       &quot;IP prefix &lt;network&gt;/&lt;length&gt;, e.g., 35.0.0.0/8\n&quot;</a>
<a name="ln1354">       &quot;Maximum prefix length to be matched\n&quot;</a>
<a name="ln1355">       &quot;Maximum prefix length\n&quot;</a>
<a name="ln1356">       &quot;Minimum prefix length to be matched\n&quot;</a>
<a name="ln1357">       &quot;Minimum prefix length\n&quot;)</a>
<a name="ln1358">{</a>
<a name="ln1359">  return vty_prefix_list_install (vty, AFI_IP, argv[0], argv[1], argv[2],</a>
<a name="ln1360">				  argv[3], argv[5], argv[4]);</a>
<a name="ln1361">}</a>
<a name="ln1362"> </a>
<a name="ln1363">DEFUN (no_ip_prefix_list,</a>
<a name="ln1364">       no_ip_prefix_list_cmd,</a>
<a name="ln1365">       &quot;no ip prefix-list WORD&quot;,</a>
<a name="ln1366">       NO_STR</a>
<a name="ln1367">       IP_STR</a>
<a name="ln1368">       PREFIX_LIST_STR</a>
<a name="ln1369">       &quot;Name of a prefix list\n&quot;)</a>
<a name="ln1370">{</a>
<a name="ln1371">  return vty_prefix_list_uninstall (vty, AFI_IP, argv[0], NULL, NULL,</a>
<a name="ln1372">				    NULL, NULL, NULL);</a>
<a name="ln1373">}</a>
<a name="ln1374"> </a>
<a name="ln1375">DEFUN (no_ip_prefix_list_prefix,</a>
<a name="ln1376">       no_ip_prefix_list_prefix_cmd,</a>
<a name="ln1377">       &quot;no ip prefix-list WORD (deny|permit) (A.B.C.D/M|any)&quot;,</a>
<a name="ln1378">       NO_STR</a>
<a name="ln1379">       IP_STR</a>
<a name="ln1380">       PREFIX_LIST_STR</a>
<a name="ln1381">       &quot;Name of a prefix list\n&quot;</a>
<a name="ln1382">       &quot;Specify packets to reject\n&quot;</a>
<a name="ln1383">       &quot;Specify packets to forward\n&quot;</a>
<a name="ln1384">       &quot;IP prefix &lt;network&gt;/&lt;length&gt;, e.g., 35.0.0.0/8\n&quot;</a>
<a name="ln1385">       &quot;Any prefix match.  Same as \&quot;0.0.0.0/0 le 32\&quot;\n&quot;)</a>
<a name="ln1386">{</a>
<a name="ln1387">  return vty_prefix_list_uninstall (vty, AFI_IP, argv[0], NULL, argv[1],</a>
<a name="ln1388">				    argv[2], NULL, NULL);</a>
<a name="ln1389">}</a>
<a name="ln1390"> </a>
<a name="ln1391">DEFUN (no_ip_prefix_list_ge,</a>
<a name="ln1392">       no_ip_prefix_list_ge_cmd,</a>
<a name="ln1393">       &quot;no ip prefix-list WORD (deny|permit) A.B.C.D/M ge &lt;0-32&gt;&quot;,</a>
<a name="ln1394">       NO_STR</a>
<a name="ln1395">       IP_STR</a>
<a name="ln1396">       PREFIX_LIST_STR</a>
<a name="ln1397">       &quot;Name of a prefix list\n&quot;</a>
<a name="ln1398">       &quot;Specify packets to reject\n&quot;</a>
<a name="ln1399">       &quot;Specify packets to forward\n&quot;</a>
<a name="ln1400">       &quot;IP prefix &lt;network&gt;/&lt;length&gt;, e.g., 35.0.0.0/8\n&quot;</a>
<a name="ln1401">       &quot;Minimum prefix length to be matched\n&quot;</a>
<a name="ln1402">       &quot;Minimum prefix length\n&quot;)</a>
<a name="ln1403">{</a>
<a name="ln1404">  return vty_prefix_list_uninstall (vty, AFI_IP, argv[0], NULL, argv[1],</a>
<a name="ln1405">				    argv[2], argv[3], NULL);</a>
<a name="ln1406">}</a>
<a name="ln1407"> </a>
<a name="ln1408">DEFUN (no_ip_prefix_list_ge_le,</a>
<a name="ln1409">       no_ip_prefix_list_ge_le_cmd,</a>
<a name="ln1410">       &quot;no ip prefix-list WORD (deny|permit) A.B.C.D/M ge &lt;0-32&gt; le &lt;0-32&gt;&quot;,</a>
<a name="ln1411">       NO_STR</a>
<a name="ln1412">       IP_STR</a>
<a name="ln1413">       PREFIX_LIST_STR</a>
<a name="ln1414">       &quot;Name of a prefix list\n&quot;</a>
<a name="ln1415">       &quot;Specify packets to reject\n&quot;</a>
<a name="ln1416">       &quot;Specify packets to forward\n&quot;</a>
<a name="ln1417">       &quot;IP prefix &lt;network&gt;/&lt;length&gt;, e.g., 35.0.0.0/8\n&quot;</a>
<a name="ln1418">       &quot;Minimum prefix length to be matched\n&quot;</a>
<a name="ln1419">       &quot;Minimum prefix length\n&quot;</a>
<a name="ln1420">       &quot;Maximum prefix length to be matched\n&quot;</a>
<a name="ln1421">       &quot;Maximum prefix length\n&quot;)</a>
<a name="ln1422">{</a>
<a name="ln1423">  return vty_prefix_list_uninstall (vty, AFI_IP, argv[0], NULL, argv[1],</a>
<a name="ln1424">				    argv[2], argv[3], argv[4]);</a>
<a name="ln1425">}</a>
<a name="ln1426"> </a>
<a name="ln1427">DEFUN (no_ip_prefix_list_le,</a>
<a name="ln1428">       no_ip_prefix_list_le_cmd,</a>
<a name="ln1429">       &quot;no ip prefix-list WORD (deny|permit) A.B.C.D/M le &lt;0-32&gt;&quot;,</a>
<a name="ln1430">       NO_STR</a>
<a name="ln1431">       IP_STR</a>
<a name="ln1432">       PREFIX_LIST_STR</a>
<a name="ln1433">       &quot;Name of a prefix list\n&quot;</a>
<a name="ln1434">       &quot;Specify packets to reject\n&quot;</a>
<a name="ln1435">       &quot;Specify packets to forward\n&quot;</a>
<a name="ln1436">       &quot;IP prefix &lt;network&gt;/&lt;length&gt;, e.g., 35.0.0.0/8\n&quot;</a>
<a name="ln1437">       &quot;Maximum prefix length to be matched\n&quot;</a>
<a name="ln1438">       &quot;Maximum prefix length\n&quot;)</a>
<a name="ln1439">{</a>
<a name="ln1440">  return vty_prefix_list_uninstall (vty, AFI_IP, argv[0], NULL, argv[1],</a>
<a name="ln1441">				    argv[2], NULL, argv[3]);</a>
<a name="ln1442">}</a>
<a name="ln1443"> </a>
<a name="ln1444">DEFUN (no_ip_prefix_list_le_ge,</a>
<a name="ln1445">       no_ip_prefix_list_le_ge_cmd,</a>
<a name="ln1446">       &quot;no ip prefix-list WORD (deny|permit) A.B.C.D/M le &lt;0-32&gt; ge &lt;0-32&gt;&quot;,</a>
<a name="ln1447">       NO_STR</a>
<a name="ln1448">       IP_STR</a>
<a name="ln1449">       PREFIX_LIST_STR</a>
<a name="ln1450">       &quot;Name of a prefix list\n&quot;</a>
<a name="ln1451">       &quot;Specify packets to reject\n&quot;</a>
<a name="ln1452">       &quot;Specify packets to forward\n&quot;</a>
<a name="ln1453">       &quot;IP prefix &lt;network&gt;/&lt;length&gt;, e.g., 35.0.0.0/8\n&quot;</a>
<a name="ln1454">       &quot;Maximum prefix length to be matched\n&quot;</a>
<a name="ln1455">       &quot;Maximum prefix length\n&quot;</a>
<a name="ln1456">       &quot;Minimum prefix length to be matched\n&quot;</a>
<a name="ln1457">       &quot;Minimum prefix length\n&quot;)</a>
<a name="ln1458">{</a>
<a name="ln1459">  return vty_prefix_list_uninstall (vty, AFI_IP, argv[0], NULL, argv[1],</a>
<a name="ln1460">				    argv[2], argv[4], argv[3]);</a>
<a name="ln1461">}</a>
<a name="ln1462"> </a>
<a name="ln1463">DEFUN (no_ip_prefix_list_seq,</a>
<a name="ln1464">       no_ip_prefix_list_seq_cmd,</a>
<a name="ln1465">       &quot;no ip prefix-list WORD seq &lt;1-4294967295&gt; (deny|permit) (A.B.C.D/M|any)&quot;,</a>
<a name="ln1466">       NO_STR</a>
<a name="ln1467">       IP_STR</a>
<a name="ln1468">       PREFIX_LIST_STR</a>
<a name="ln1469">       &quot;Name of a prefix list\n&quot;</a>
<a name="ln1470">       &quot;sequence number of an entry\n&quot;</a>
<a name="ln1471">       &quot;Sequence number\n&quot;</a>
<a name="ln1472">       &quot;Specify packets to reject\n&quot;</a>
<a name="ln1473">       &quot;Specify packets to forward\n&quot;</a>
<a name="ln1474">       &quot;IP prefix &lt;network&gt;/&lt;length&gt;, e.g., 35.0.0.0/8\n&quot;</a>
<a name="ln1475">       &quot;Any prefix match.  Same as \&quot;0.0.0.0/0 le 32\&quot;\n&quot;)</a>
<a name="ln1476">{</a>
<a name="ln1477">  return vty_prefix_list_uninstall (vty, AFI_IP, argv[0], argv[1], argv[2],</a>
<a name="ln1478">				    argv[3], NULL, NULL);</a>
<a name="ln1479">}</a>
<a name="ln1480"> </a>
<a name="ln1481">DEFUN (no_ip_prefix_list_seq_ge,</a>
<a name="ln1482">       no_ip_prefix_list_seq_ge_cmd,</a>
<a name="ln1483">       &quot;no ip prefix-list WORD seq &lt;1-4294967295&gt; (deny|permit) A.B.C.D/M ge &lt;0-32&gt;&quot;,</a>
<a name="ln1484">       NO_STR</a>
<a name="ln1485">       IP_STR</a>
<a name="ln1486">       PREFIX_LIST_STR</a>
<a name="ln1487">       &quot;Name of a prefix list\n&quot;</a>
<a name="ln1488">       &quot;sequence number of an entry\n&quot;</a>
<a name="ln1489">       &quot;Sequence number\n&quot;</a>
<a name="ln1490">       &quot;Specify packets to reject\n&quot;</a>
<a name="ln1491">       &quot;Specify packets to forward\n&quot;</a>
<a name="ln1492">       &quot;IP prefix &lt;network&gt;/&lt;length&gt;, e.g., 35.0.0.0/8\n&quot;</a>
<a name="ln1493">       &quot;Minimum prefix length to be matched\n&quot;</a>
<a name="ln1494">       &quot;Minimum prefix length\n&quot;)</a>
<a name="ln1495">{</a>
<a name="ln1496">  return vty_prefix_list_uninstall (vty, AFI_IP, argv[0], argv[1], argv[2],</a>
<a name="ln1497">				    argv[3], argv[4], NULL);</a>
<a name="ln1498">}</a>
<a name="ln1499"> </a>
<a name="ln1500">DEFUN (no_ip_prefix_list_seq_ge_le,</a>
<a name="ln1501">       no_ip_prefix_list_seq_ge_le_cmd,</a>
<a name="ln1502">       &quot;no ip prefix-list WORD seq &lt;1-4294967295&gt; (deny|permit) A.B.C.D/M ge &lt;0-32&gt; le &lt;0-32&gt;&quot;,</a>
<a name="ln1503">       NO_STR</a>
<a name="ln1504">       IP_STR</a>
<a name="ln1505">       PREFIX_LIST_STR</a>
<a name="ln1506">       &quot;Name of a prefix list\n&quot;</a>
<a name="ln1507">       &quot;sequence number of an entry\n&quot;</a>
<a name="ln1508">       &quot;Sequence number\n&quot;</a>
<a name="ln1509">       &quot;Specify packets to reject\n&quot;</a>
<a name="ln1510">       &quot;Specify packets to forward\n&quot;</a>
<a name="ln1511">       &quot;IP prefix &lt;network&gt;/&lt;length&gt;, e.g., 35.0.0.0/8\n&quot;</a>
<a name="ln1512">       &quot;Minimum prefix length to be matched\n&quot;</a>
<a name="ln1513">       &quot;Minimum prefix length\n&quot;</a>
<a name="ln1514">       &quot;Maximum prefix length to be matched\n&quot;</a>
<a name="ln1515">       &quot;Maximum prefix length\n&quot;)</a>
<a name="ln1516">{</a>
<a name="ln1517">  return vty_prefix_list_uninstall (vty, AFI_IP, argv[0], argv[1], argv[2],</a>
<a name="ln1518">				    argv[3], argv[4], argv[5]);</a>
<a name="ln1519">}</a>
<a name="ln1520"> </a>
<a name="ln1521">DEFUN (no_ip_prefix_list_seq_le,</a>
<a name="ln1522">       no_ip_prefix_list_seq_le_cmd,</a>
<a name="ln1523">       &quot;no ip prefix-list WORD seq &lt;1-4294967295&gt; (deny|permit) A.B.C.D/M le &lt;0-32&gt;&quot;,</a>
<a name="ln1524">       NO_STR</a>
<a name="ln1525">       IP_STR</a>
<a name="ln1526">       PREFIX_LIST_STR</a>
<a name="ln1527">       &quot;Name of a prefix list\n&quot;</a>
<a name="ln1528">       &quot;sequence number of an entry\n&quot;</a>
<a name="ln1529">       &quot;Sequence number\n&quot;</a>
<a name="ln1530">       &quot;Specify packets to reject\n&quot;</a>
<a name="ln1531">       &quot;Specify packets to forward\n&quot;</a>
<a name="ln1532">       &quot;IP prefix &lt;network&gt;/&lt;length&gt;, e.g., 35.0.0.0/8\n&quot;</a>
<a name="ln1533">       &quot;Maximum prefix length to be matched\n&quot;</a>
<a name="ln1534">       &quot;Maximum prefix length\n&quot;)</a>
<a name="ln1535">{</a>
<a name="ln1536">  return vty_prefix_list_uninstall (vty, AFI_IP, argv[0], argv[1], argv[2],</a>
<a name="ln1537">				    argv[3], NULL, argv[4]);</a>
<a name="ln1538">}</a>
<a name="ln1539"> </a>
<a name="ln1540">DEFUN (no_ip_prefix_list_seq_le_ge,</a>
<a name="ln1541">       no_ip_prefix_list_seq_le_ge_cmd,</a>
<a name="ln1542">       &quot;no ip prefix-list WORD seq &lt;1-4294967295&gt; (deny|permit) A.B.C.D/M le &lt;0-32&gt; ge &lt;0-32&gt;&quot;,</a>
<a name="ln1543">       NO_STR</a>
<a name="ln1544">       IP_STR</a>
<a name="ln1545">       PREFIX_LIST_STR</a>
<a name="ln1546">       &quot;Name of a prefix list\n&quot;</a>
<a name="ln1547">       &quot;sequence number of an entry\n&quot;</a>
<a name="ln1548">       &quot;Sequence number\n&quot;</a>
<a name="ln1549">       &quot;Specify packets to reject\n&quot;</a>
<a name="ln1550">       &quot;Specify packets to forward\n&quot;</a>
<a name="ln1551">       &quot;IP prefix &lt;network&gt;/&lt;length&gt;, e.g., 35.0.0.0/8\n&quot;</a>
<a name="ln1552">       &quot;Maximum prefix length to be matched\n&quot;</a>
<a name="ln1553">       &quot;Maximum prefix length\n&quot;</a>
<a name="ln1554">       &quot;Minimum prefix length to be matched\n&quot;</a>
<a name="ln1555">       &quot;Minimum prefix length\n&quot;)</a>
<a name="ln1556">{</a>
<a name="ln1557">  return vty_prefix_list_uninstall (vty, AFI_IP, argv[0], argv[1], argv[2],</a>
<a name="ln1558">				    argv[3], argv[5], argv[4]);</a>
<a name="ln1559">}</a>
<a name="ln1560"> </a>
<a name="ln1561">DEFUN (ip_prefix_list_sequence_number,</a>
<a name="ln1562">       ip_prefix_list_sequence_number_cmd,</a>
<a name="ln1563">       &quot;ip prefix-list sequence-number&quot;,</a>
<a name="ln1564">       IP_STR</a>
<a name="ln1565">       PREFIX_LIST_STR</a>
<a name="ln1566">       &quot;Include/exclude sequence numbers in NVGEN\n&quot;)</a>
<a name="ln1567">{</a>
<a name="ln1568">  prefix_master_ipv4.seqnum = 1;</a>
<a name="ln1569">  return CMD_SUCCESS;</a>
<a name="ln1570">}</a>
<a name="ln1571"> </a>
<a name="ln1572">DEFUN (no_ip_prefix_list_sequence_number,</a>
<a name="ln1573">       no_ip_prefix_list_sequence_number_cmd,</a>
<a name="ln1574">       &quot;no ip prefix-list sequence-number&quot;,</a>
<a name="ln1575">       NO_STR</a>
<a name="ln1576">       IP_STR</a>
<a name="ln1577">       PREFIX_LIST_STR</a>
<a name="ln1578">       &quot;Include/exclude sequence numbers in NVGEN\n&quot;)</a>
<a name="ln1579">{</a>
<a name="ln1580">  prefix_master_ipv4.seqnum = 0;</a>
<a name="ln1581">  return CMD_SUCCESS;</a>
<a name="ln1582">}</a>
<a name="ln1583"> </a>
<a name="ln1584">DEFUN (ip_prefix_list_description,</a>
<a name="ln1585">       ip_prefix_list_description_cmd,</a>
<a name="ln1586">       &quot;ip prefix-list WORD description .LINE&quot;,</a>
<a name="ln1587">       IP_STR</a>
<a name="ln1588">       PREFIX_LIST_STR</a>
<a name="ln1589">       &quot;Name of a prefix list\n&quot;</a>
<a name="ln1590">       &quot;Prefix-list specific description\n&quot;</a>
<a name="ln1591">       &quot;Up to 80 characters describing this prefix-list\n&quot;)</a>
<a name="ln1592">{</a>
<a name="ln1593">  struct prefix_list *plist;</a>
<a name="ln1594"> </a>
<a name="ln1595">  plist = prefix_list_get (AFI_IP, 0, argv[0]);</a>
<a name="ln1596">  </a>
<a name="ln1597">  if (plist-&gt;desc)</a>
<a name="ln1598">    {</a>
<a name="ln1599">      XFREE (MTYPE_TMP, plist-&gt;desc);</a>
<a name="ln1600">      plist-&gt;desc = NULL;</a>
<a name="ln1601">    }</a>
<a name="ln1602">  plist-&gt;desc = argv_concat(argv, argc, 1);</a>
<a name="ln1603"> </a>
<a name="ln1604">  return CMD_SUCCESS;</a>
<a name="ln1605">}       </a>
<a name="ln1606"> </a>
<a name="ln1607">DEFUN (no_ip_prefix_list_description,</a>
<a name="ln1608">       no_ip_prefix_list_description_cmd,</a>
<a name="ln1609">       &quot;no ip prefix-list WORD description&quot;,</a>
<a name="ln1610">       NO_STR</a>
<a name="ln1611">       IP_STR</a>
<a name="ln1612">       PREFIX_LIST_STR</a>
<a name="ln1613">       &quot;Name of a prefix list\n&quot;</a>
<a name="ln1614">       &quot;Prefix-list specific description\n&quot;)</a>
<a name="ln1615">{</a>
<a name="ln1616">  return vty_prefix_list_desc_unset (vty, AFI_IP, argv[0]);</a>
<a name="ln1617">}</a>
<a name="ln1618"> </a>
<a name="ln1619">ALIAS (no_ip_prefix_list_description,</a>
<a name="ln1620">       no_ip_prefix_list_description_arg_cmd,</a>
<a name="ln1621">       &quot;no ip prefix-list WORD description .LINE&quot;,</a>
<a name="ln1622">       NO_STR</a>
<a name="ln1623">       IP_STR</a>
<a name="ln1624">       PREFIX_LIST_STR</a>
<a name="ln1625">       &quot;Name of a prefix list\n&quot;</a>
<a name="ln1626">       &quot;Prefix-list specific description\n&quot;</a>
<a name="ln1627">       &quot;Up to 80 characters describing this prefix-list\n&quot;)</a>
<a name="ln1628"> </a>
<a name="ln1629">DEFUN (show_ip_prefix_list,</a>
<a name="ln1630">       show_ip_prefix_list_cmd,</a>
<a name="ln1631">       &quot;show ip prefix-list&quot;,</a>
<a name="ln1632">       SHOW_STR</a>
<a name="ln1633">       IP_STR</a>
<a name="ln1634">       PREFIX_LIST_STR)</a>
<a name="ln1635">{</a>
<a name="ln1636">  return vty_show_prefix_list (vty, AFI_IP, NULL, NULL, normal_display);</a>
<a name="ln1637">}</a>
<a name="ln1638"> </a>
<a name="ln1639">DEFUN (show_ip_prefix_list_name,</a>
<a name="ln1640">       show_ip_prefix_list_name_cmd,</a>
<a name="ln1641">       &quot;show ip prefix-list WORD&quot;,</a>
<a name="ln1642">       SHOW_STR</a>
<a name="ln1643">       IP_STR</a>
<a name="ln1644">       PREFIX_LIST_STR</a>
<a name="ln1645">       &quot;Name of a prefix list\n&quot;)</a>
<a name="ln1646">{</a>
<a name="ln1647">  return vty_show_prefix_list (vty, AFI_IP, argv[0], NULL, normal_display);</a>
<a name="ln1648">}</a>
<a name="ln1649"> </a>
<a name="ln1650">DEFUN (show_ip_prefix_list_name_seq,</a>
<a name="ln1651">       show_ip_prefix_list_name_seq_cmd,</a>
<a name="ln1652">       &quot;show ip prefix-list WORD seq &lt;1-4294967295&gt;&quot;,</a>
<a name="ln1653">       SHOW_STR</a>
<a name="ln1654">       IP_STR</a>
<a name="ln1655">       PREFIX_LIST_STR</a>
<a name="ln1656">       &quot;Name of a prefix list\n&quot;</a>
<a name="ln1657">       &quot;sequence number of an entry\n&quot;</a>
<a name="ln1658">       &quot;Sequence number\n&quot;)</a>
<a name="ln1659">{</a>
<a name="ln1660">  return vty_show_prefix_list (vty, AFI_IP, argv[0], argv[1], sequential_display);</a>
<a name="ln1661">}</a>
<a name="ln1662"> </a>
<a name="ln1663">DEFUN (show_ip_prefix_list_prefix,</a>
<a name="ln1664">       show_ip_prefix_list_prefix_cmd,</a>
<a name="ln1665">       &quot;show ip prefix-list WORD A.B.C.D/M&quot;,</a>
<a name="ln1666">       SHOW_STR</a>
<a name="ln1667">       IP_STR</a>
<a name="ln1668">       PREFIX_LIST_STR</a>
<a name="ln1669">       &quot;Name of a prefix list\n&quot;</a>
<a name="ln1670">       &quot;IP prefix &lt;network&gt;/&lt;length&gt;, e.g., 35.0.0.0/8\n&quot;)</a>
<a name="ln1671">{</a>
<a name="ln1672">  return vty_show_prefix_list_prefix (vty, AFI_IP, argv[0], argv[1], normal_display);</a>
<a name="ln1673">}</a>
<a name="ln1674"> </a>
<a name="ln1675">DEFUN (show_ip_prefix_list_prefix_longer,</a>
<a name="ln1676">       show_ip_prefix_list_prefix_longer_cmd,</a>
<a name="ln1677">       &quot;show ip prefix-list WORD A.B.C.D/M longer&quot;,</a>
<a name="ln1678">       SHOW_STR</a>
<a name="ln1679">       IP_STR</a>
<a name="ln1680">       PREFIX_LIST_STR</a>
<a name="ln1681">       &quot;Name of a prefix list\n&quot;</a>
<a name="ln1682">       &quot;IP prefix &lt;network&gt;/&lt;length&gt;, e.g., 35.0.0.0/8\n&quot;</a>
<a name="ln1683">       &quot;Lookup longer prefix\n&quot;)</a>
<a name="ln1684">{</a>
<a name="ln1685">  return vty_show_prefix_list_prefix (vty, AFI_IP, argv[0], argv[1], longer_display);</a>
<a name="ln1686">}</a>
<a name="ln1687"> </a>
<a name="ln1688">DEFUN (show_ip_prefix_list_prefix_first_match,</a>
<a name="ln1689">       show_ip_prefix_list_prefix_first_match_cmd,</a>
<a name="ln1690">       &quot;show ip prefix-list WORD A.B.C.D/M first-match&quot;,</a>
<a name="ln1691">       SHOW_STR</a>
<a name="ln1692">       IP_STR</a>
<a name="ln1693">       PREFIX_LIST_STR</a>
<a name="ln1694">       &quot;Name of a prefix list\n&quot;</a>
<a name="ln1695">       &quot;IP prefix &lt;network&gt;/&lt;length&gt;, e.g., 35.0.0.0/8\n&quot;</a>
<a name="ln1696">       &quot;First matched prefix\n&quot;)</a>
<a name="ln1697">{</a>
<a name="ln1698">  return vty_show_prefix_list_prefix (vty, AFI_IP, argv[0], argv[1], first_match_display);</a>
<a name="ln1699">}</a>
<a name="ln1700"> </a>
<a name="ln1701">DEFUN (show_ip_prefix_list_summary,</a>
<a name="ln1702">       show_ip_prefix_list_summary_cmd,</a>
<a name="ln1703">       &quot;show ip prefix-list summary&quot;,</a>
<a name="ln1704">       SHOW_STR</a>
<a name="ln1705">       IP_STR</a>
<a name="ln1706">       PREFIX_LIST_STR</a>
<a name="ln1707">       &quot;Summary of prefix lists\n&quot;)</a>
<a name="ln1708">{</a>
<a name="ln1709">  return vty_show_prefix_list (vty, AFI_IP, NULL, NULL, summary_display);</a>
<a name="ln1710">}</a>
<a name="ln1711"> </a>
<a name="ln1712">DEFUN (show_ip_prefix_list_summary_name,</a>
<a name="ln1713">       show_ip_prefix_list_summary_name_cmd,</a>
<a name="ln1714">       &quot;show ip prefix-list summary WORD&quot;,</a>
<a name="ln1715">       SHOW_STR</a>
<a name="ln1716">       IP_STR</a>
<a name="ln1717">       PREFIX_LIST_STR</a>
<a name="ln1718">       &quot;Summary of prefix lists\n&quot;</a>
<a name="ln1719">       &quot;Name of a prefix list\n&quot;)</a>
<a name="ln1720">{</a>
<a name="ln1721">  return vty_show_prefix_list (vty, AFI_IP, argv[0], NULL, summary_display);</a>
<a name="ln1722">}</a>
<a name="ln1723"> </a>
<a name="ln1724"> </a>
<a name="ln1725">DEFUN (show_ip_prefix_list_detail,</a>
<a name="ln1726">       show_ip_prefix_list_detail_cmd,</a>
<a name="ln1727">       &quot;show ip prefix-list detail&quot;,</a>
<a name="ln1728">       SHOW_STR</a>
<a name="ln1729">       IP_STR</a>
<a name="ln1730">       PREFIX_LIST_STR</a>
<a name="ln1731">       &quot;Detail of prefix lists\n&quot;)</a>
<a name="ln1732">{</a>
<a name="ln1733">  return vty_show_prefix_list (vty, AFI_IP, NULL, NULL, detail_display);</a>
<a name="ln1734">}</a>
<a name="ln1735"> </a>
<a name="ln1736">DEFUN (show_ip_prefix_list_detail_name,</a>
<a name="ln1737">       show_ip_prefix_list_detail_name_cmd,</a>
<a name="ln1738">       &quot;show ip prefix-list detail WORD&quot;,</a>
<a name="ln1739">       SHOW_STR</a>
<a name="ln1740">       IP_STR</a>
<a name="ln1741">       PREFIX_LIST_STR</a>
<a name="ln1742">       &quot;Detail of prefix lists\n&quot;</a>
<a name="ln1743">       &quot;Name of a prefix list\n&quot;)</a>
<a name="ln1744">{</a>
<a name="ln1745">  return vty_show_prefix_list (vty, AFI_IP, argv[0], NULL, detail_display);</a>
<a name="ln1746">}</a>
<a name="ln1747"> </a>
<a name="ln1748">DEFUN (clear_ip_prefix_list,</a>
<a name="ln1749">       clear_ip_prefix_list_cmd,</a>
<a name="ln1750">       &quot;clear ip prefix-list&quot;,</a>
<a name="ln1751">       CLEAR_STR</a>
<a name="ln1752">       IP_STR</a>
<a name="ln1753">       PREFIX_LIST_STR)</a>
<a name="ln1754">{</a>
<a name="ln1755">  return vty_clear_prefix_list (vty, AFI_IP, NULL, NULL);</a>
<a name="ln1756">}</a>
<a name="ln1757"> </a>
<a name="ln1758">DEFUN (clear_ip_prefix_list_name,</a>
<a name="ln1759">       clear_ip_prefix_list_name_cmd,</a>
<a name="ln1760">       &quot;clear ip prefix-list WORD&quot;,</a>
<a name="ln1761">       CLEAR_STR</a>
<a name="ln1762">       IP_STR</a>
<a name="ln1763">       PREFIX_LIST_STR</a>
<a name="ln1764">       &quot;Name of a prefix list\n&quot;)</a>
<a name="ln1765">{</a>
<a name="ln1766">  return vty_clear_prefix_list (vty, AFI_IP, argv[0], NULL);</a>
<a name="ln1767">}</a>
<a name="ln1768"> </a>
<a name="ln1769">DEFUN (clear_ip_prefix_list_name_prefix,</a>
<a name="ln1770">       clear_ip_prefix_list_name_prefix_cmd,</a>
<a name="ln1771">       &quot;clear ip prefix-list WORD A.B.C.D/M&quot;,</a>
<a name="ln1772">       CLEAR_STR</a>
<a name="ln1773">       IP_STR</a>
<a name="ln1774">       PREFIX_LIST_STR</a>
<a name="ln1775">       &quot;Name of a prefix list\n&quot;</a>
<a name="ln1776">       &quot;IP prefix &lt;network&gt;/&lt;length&gt;, e.g., 35.0.0.0/8\n&quot;)</a>
<a name="ln1777">{</a>
<a name="ln1778">  return vty_clear_prefix_list (vty, AFI_IP, argv[0], argv[1]);</a>
<a name="ln1779">}</a>
<a name="ln1780"> </a>
<a name="ln1781">#ifdef HAVE_IPV6</a>
<a name="ln1782">DEFUN (ipv6_prefix_list,</a>
<a name="ln1783">       ipv6_prefix_list_cmd,</a>
<a name="ln1784">       &quot;ipv6 prefix-list WORD (deny|permit) (X:X::X:X/M|any)&quot;,</a>
<a name="ln1785">       IPV6_STR</a>
<a name="ln1786">       PREFIX_LIST_STR</a>
<a name="ln1787">       &quot;Name of a prefix list\n&quot;</a>
<a name="ln1788">       &quot;Specify packets to reject\n&quot;</a>
<a name="ln1789">       &quot;Specify packets to forward\n&quot;</a>
<a name="ln1790">       &quot;IPv6 prefix &lt;network&gt;/&lt;length&gt;, e.g., 3ffe::/16\n&quot;</a>
<a name="ln1791">       &quot;Any prefix match.  Same as \&quot;::0/0 le 128\&quot;\n&quot;)</a>
<a name="ln1792">{</a>
<a name="ln1793">  return vty_prefix_list_install (vty, AFI_IP6, argv[0], NULL, </a>
<a name="ln1794">				  argv[1], argv[2], NULL, NULL);</a>
<a name="ln1795">}</a>
<a name="ln1796"> </a>
<a name="ln1797">DEFUN (ipv6_prefix_list_ge,</a>
<a name="ln1798">       ipv6_prefix_list_ge_cmd,</a>
<a name="ln1799">       &quot;ipv6 prefix-list WORD (deny|permit) X:X::X:X/M ge &lt;0-128&gt;&quot;,</a>
<a name="ln1800">       IPV6_STR</a>
<a name="ln1801">       PREFIX_LIST_STR</a>
<a name="ln1802">       &quot;Name of a prefix list\n&quot;</a>
<a name="ln1803">       &quot;Specify packets to reject\n&quot;</a>
<a name="ln1804">       &quot;Specify packets to forward\n&quot;</a>
<a name="ln1805">       &quot;IPv6 prefix &lt;network&gt;/&lt;length&gt;, e.g., 3ffe::/16\n&quot;</a>
<a name="ln1806">       &quot;Minimum prefix length to be matched\n&quot;</a>
<a name="ln1807">       &quot;Minimum prefix length\n&quot;)</a>
<a name="ln1808">{</a>
<a name="ln1809">  return vty_prefix_list_install (vty, AFI_IP6, argv[0], NULL, argv[1], </a>
<a name="ln1810">				 argv[2], argv[3], NULL);</a>
<a name="ln1811">}</a>
<a name="ln1812"> </a>
<a name="ln1813">DEFUN (ipv6_prefix_list_ge_le,</a>
<a name="ln1814">       ipv6_prefix_list_ge_le_cmd,</a>
<a name="ln1815">       &quot;ipv6 prefix-list WORD (deny|permit) X:X::X:X/M ge &lt;0-128&gt; le &lt;0-128&gt;&quot;,</a>
<a name="ln1816">       IPV6_STR</a>
<a name="ln1817">       PREFIX_LIST_STR</a>
<a name="ln1818">       &quot;Name of a prefix list\n&quot;</a>
<a name="ln1819">       &quot;Specify packets to reject\n&quot;</a>
<a name="ln1820">       &quot;Specify packets to forward\n&quot;</a>
<a name="ln1821">       &quot;IPv6 prefix &lt;network&gt;/&lt;length&gt;, e.g., 3ffe::/16\n&quot;</a>
<a name="ln1822">       &quot;Minimum prefix length to be matched\n&quot;</a>
<a name="ln1823">       &quot;Minimum prefix length\n&quot;</a>
<a name="ln1824">       &quot;Maximum prefix length to be matched\n&quot;</a>
<a name="ln1825">       &quot;Maximum prefix length\n&quot;)</a>
<a name="ln1826"> </a>
<a name="ln1827">{</a>
<a name="ln1828">  return vty_prefix_list_install (vty, AFI_IP6, argv[0], NULL, argv[1], </a>
<a name="ln1829">				  argv[2], argv[3], argv[4]);</a>
<a name="ln1830">}</a>
<a name="ln1831"> </a>
<a name="ln1832">DEFUN (ipv6_prefix_list_le,</a>
<a name="ln1833">       ipv6_prefix_list_le_cmd,</a>
<a name="ln1834">       &quot;ipv6 prefix-list WORD (deny|permit) X:X::X:X/M le &lt;0-128&gt;&quot;,</a>
<a name="ln1835">       IPV6_STR</a>
<a name="ln1836">       PREFIX_LIST_STR</a>
<a name="ln1837">       &quot;Name of a prefix list\n&quot;</a>
<a name="ln1838">       &quot;Specify packets to reject\n&quot;</a>
<a name="ln1839">       &quot;Specify packets to forward\n&quot;</a>
<a name="ln1840">       &quot;IPv6 prefix &lt;network&gt;/&lt;length&gt;, e.g., 3ffe::/16\n&quot;</a>
<a name="ln1841">       &quot;Maximum prefix length to be matched\n&quot;</a>
<a name="ln1842">       &quot;Maximum prefix length\n&quot;)</a>
<a name="ln1843">{</a>
<a name="ln1844">  return vty_prefix_list_install (vty, AFI_IP6, argv[0], NULL, argv[1],</a>
<a name="ln1845">				  argv[2], NULL, argv[3]);</a>
<a name="ln1846">}</a>
<a name="ln1847"> </a>
<a name="ln1848">DEFUN (ipv6_prefix_list_le_ge,</a>
<a name="ln1849">       ipv6_prefix_list_le_ge_cmd,</a>
<a name="ln1850">       &quot;ipv6 prefix-list WORD (deny|permit) X:X::X:X/M le &lt;0-128&gt; ge &lt;0-128&gt;&quot;,</a>
<a name="ln1851">       IPV6_STR</a>
<a name="ln1852">       PREFIX_LIST_STR</a>
<a name="ln1853">       &quot;Name of a prefix list\n&quot;</a>
<a name="ln1854">       &quot;Specify packets to reject\n&quot;</a>
<a name="ln1855">       &quot;Specify packets to forward\n&quot;</a>
<a name="ln1856">       &quot;IPv6 prefix &lt;network&gt;/&lt;length&gt;, e.g., 3ffe::/16\n&quot;</a>
<a name="ln1857">       &quot;Maximum prefix length to be matched\n&quot;</a>
<a name="ln1858">       &quot;Maximum prefix length\n&quot;</a>
<a name="ln1859">       &quot;Minimum prefix length to be matched\n&quot;</a>
<a name="ln1860">       &quot;Minimum prefix length\n&quot;)</a>
<a name="ln1861">{</a>
<a name="ln1862">  return vty_prefix_list_install (vty, AFI_IP6, argv[0], NULL, argv[1],</a>
<a name="ln1863">				  argv[2], argv[4], argv[3]);</a>
<a name="ln1864">}</a>
<a name="ln1865"> </a>
<a name="ln1866">DEFUN (ipv6_prefix_list_seq,</a>
<a name="ln1867">       ipv6_prefix_list_seq_cmd,</a>
<a name="ln1868">       &quot;ipv6 prefix-list WORD seq &lt;1-4294967295&gt; (deny|permit) (X:X::X:X/M|any)&quot;,</a>
<a name="ln1869">       IPV6_STR</a>
<a name="ln1870">       PREFIX_LIST_STR</a>
<a name="ln1871">       &quot;Name of a prefix list\n&quot;</a>
<a name="ln1872">       &quot;sequence number of an entry\n&quot;</a>
<a name="ln1873">       &quot;Sequence number\n&quot;</a>
<a name="ln1874">       &quot;Specify packets to reject\n&quot;</a>
<a name="ln1875">       &quot;Specify packets to forward\n&quot;</a>
<a name="ln1876">       &quot;IPv6 prefix &lt;network&gt;/&lt;length&gt;, e.g., 3ffe::/16\n&quot;</a>
<a name="ln1877">       &quot;Any prefix match.  Same as \&quot;::0/0 le 128\&quot;\n&quot;)</a>
<a name="ln1878">{</a>
<a name="ln1879">  return vty_prefix_list_install (vty, AFI_IP6, argv[0], argv[1], argv[2],</a>
<a name="ln1880">				  argv[3], NULL, NULL);</a>
<a name="ln1881">}</a>
<a name="ln1882"> </a>
<a name="ln1883">DEFUN (ipv6_prefix_list_seq_ge,</a>
<a name="ln1884">       ipv6_prefix_list_seq_ge_cmd,</a>
<a name="ln1885">       &quot;ipv6 prefix-list WORD seq &lt;1-4294967295&gt; (deny|permit) X:X::X:X/M ge &lt;0-128&gt;&quot;,</a>
<a name="ln1886">       IPV6_STR</a>
<a name="ln1887">       PREFIX_LIST_STR</a>
<a name="ln1888">       &quot;Name of a prefix list\n&quot;</a>
<a name="ln1889">       &quot;sequence number of an entry\n&quot;</a>
<a name="ln1890">       &quot;Sequence number\n&quot;</a>
<a name="ln1891">       &quot;Specify packets to reject\n&quot;</a>
<a name="ln1892">       &quot;Specify packets to forward\n&quot;</a>
<a name="ln1893">       &quot;IPv6 prefix &lt;network&gt;/&lt;length&gt;, e.g., 3ffe::/16\n&quot;</a>
<a name="ln1894">       &quot;Minimum prefix length to be matched\n&quot;</a>
<a name="ln1895">       &quot;Minimum prefix length\n&quot;)</a>
<a name="ln1896">{</a>
<a name="ln1897">  return vty_prefix_list_install (vty, AFI_IP6, argv[0], argv[1], argv[2],</a>
<a name="ln1898">				  argv[3], argv[4], NULL);</a>
<a name="ln1899">}</a>
<a name="ln1900"> </a>
<a name="ln1901">DEFUN (ipv6_prefix_list_seq_ge_le,</a>
<a name="ln1902">       ipv6_prefix_list_seq_ge_le_cmd,</a>
<a name="ln1903">       &quot;ipv6 prefix-list WORD seq &lt;1-4294967295&gt; (deny|permit) X:X::X:X/M ge &lt;0-128&gt; le &lt;0-128&gt;&quot;,</a>
<a name="ln1904">       IPV6_STR</a>
<a name="ln1905">       PREFIX_LIST_STR</a>
<a name="ln1906">       &quot;Name of a prefix list\n&quot;</a>
<a name="ln1907">       &quot;sequence number of an entry\n&quot;</a>
<a name="ln1908">       &quot;Sequence number\n&quot;</a>
<a name="ln1909">       &quot;Specify packets to reject\n&quot;</a>
<a name="ln1910">       &quot;Specify packets to forward\n&quot;</a>
<a name="ln1911">       &quot;IPv6 prefix &lt;network&gt;/&lt;length&gt;, e.g., 3ffe::/16\n&quot;</a>
<a name="ln1912">       &quot;Minimum prefix length to be matched\n&quot;</a>
<a name="ln1913">       &quot;Minimum prefix length\n&quot;</a>
<a name="ln1914">       &quot;Maximum prefix length to be matched\n&quot;</a>
<a name="ln1915">       &quot;Maximum prefix length\n&quot;)</a>
<a name="ln1916">{</a>
<a name="ln1917">  return vty_prefix_list_install (vty, AFI_IP6, argv[0], argv[1], argv[2],</a>
<a name="ln1918">				  argv[3], argv[4], argv[5]);</a>
<a name="ln1919">}</a>
<a name="ln1920"> </a>
<a name="ln1921">DEFUN (ipv6_prefix_list_seq_le,</a>
<a name="ln1922">       ipv6_prefix_list_seq_le_cmd,</a>
<a name="ln1923">       &quot;ipv6 prefix-list WORD seq &lt;1-4294967295&gt; (deny|permit) X:X::X:X/M le &lt;0-128&gt;&quot;,</a>
<a name="ln1924">       IPV6_STR</a>
<a name="ln1925">       PREFIX_LIST_STR</a>
<a name="ln1926">       &quot;Name of a prefix list\n&quot;</a>
<a name="ln1927">       &quot;sequence number of an entry\n&quot;</a>
<a name="ln1928">       &quot;Sequence number\n&quot;</a>
<a name="ln1929">       &quot;Specify packets to reject\n&quot;</a>
<a name="ln1930">       &quot;Specify packets to forward\n&quot;</a>
<a name="ln1931">       &quot;IPv6 prefix &lt;network&gt;/&lt;length&gt;, e.g., 3ffe::/16\n&quot;</a>
<a name="ln1932">       &quot;Maximum prefix length to be matched\n&quot;</a>
<a name="ln1933">       &quot;Maximum prefix length\n&quot;)</a>
<a name="ln1934">{</a>
<a name="ln1935">  return vty_prefix_list_install (vty, AFI_IP6, argv[0], argv[1], argv[2],</a>
<a name="ln1936">				  argv[3], NULL, argv[4]);</a>
<a name="ln1937">}</a>
<a name="ln1938"> </a>
<a name="ln1939">DEFUN (ipv6_prefix_list_seq_le_ge,</a>
<a name="ln1940">       ipv6_prefix_list_seq_le_ge_cmd,</a>
<a name="ln1941">       &quot;ipv6 prefix-list WORD seq &lt;1-4294967295&gt; (deny|permit) X:X::X:X/M le &lt;0-128&gt; ge &lt;0-128&gt;&quot;,</a>
<a name="ln1942">       IPV6_STR</a>
<a name="ln1943">       PREFIX_LIST_STR</a>
<a name="ln1944">       &quot;Name of a prefix list\n&quot;</a>
<a name="ln1945">       &quot;sequence number of an entry\n&quot;</a>
<a name="ln1946">       &quot;Sequence number\n&quot;</a>
<a name="ln1947">       &quot;Specify packets to reject\n&quot;</a>
<a name="ln1948">       &quot;Specify packets to forward\n&quot;</a>
<a name="ln1949">       &quot;IPv6 prefix &lt;network&gt;/&lt;length&gt;, e.g., 3ffe::/16\n&quot;</a>
<a name="ln1950">       &quot;Maximum prefix length to be matched\n&quot;</a>
<a name="ln1951">       &quot;Maximum prefix length\n&quot;</a>
<a name="ln1952">       &quot;Minimum prefix length to be matched\n&quot;</a>
<a name="ln1953">       &quot;Minimum prefix length\n&quot;)</a>
<a name="ln1954">{</a>
<a name="ln1955">  return vty_prefix_list_install (vty, AFI_IP6, argv[0], argv[1], argv[2],</a>
<a name="ln1956">				  argv[3], argv[5], argv[4]);</a>
<a name="ln1957">}</a>
<a name="ln1958"> </a>
<a name="ln1959">DEFUN (no_ipv6_prefix_list,</a>
<a name="ln1960">       no_ipv6_prefix_list_cmd,</a>
<a name="ln1961">       &quot;no ipv6 prefix-list WORD&quot;,</a>
<a name="ln1962">       NO_STR</a>
<a name="ln1963">       IPV6_STR</a>
<a name="ln1964">       PREFIX_LIST_STR</a>
<a name="ln1965">       &quot;Name of a prefix list\n&quot;)</a>
<a name="ln1966">{</a>
<a name="ln1967">  return vty_prefix_list_uninstall (vty, AFI_IP6, argv[0], NULL, NULL,</a>
<a name="ln1968">				    NULL, NULL, NULL);</a>
<a name="ln1969">}</a>
<a name="ln1970"> </a>
<a name="ln1971">DEFUN (no_ipv6_prefix_list_prefix,</a>
<a name="ln1972">       no_ipv6_prefix_list_prefix_cmd,</a>
<a name="ln1973">       &quot;no ipv6 prefix-list WORD (deny|permit) (X:X::X:X/M|any)&quot;,</a>
<a name="ln1974">       NO_STR</a>
<a name="ln1975">       IPV6_STR</a>
<a name="ln1976">       PREFIX_LIST_STR</a>
<a name="ln1977">       &quot;Name of a prefix list\n&quot;</a>
<a name="ln1978">       &quot;Specify packets to reject\n&quot;</a>
<a name="ln1979">       &quot;Specify packets to forward\n&quot;</a>
<a name="ln1980">       &quot;IPv6 prefix &lt;network&gt;/&lt;length&gt;, e.g., 3ffe::/16\n&quot;</a>
<a name="ln1981">       &quot;Any prefix match.  Same as \&quot;::0/0 le 128\&quot;\n&quot;)</a>
<a name="ln1982">{</a>
<a name="ln1983">  return vty_prefix_list_uninstall (vty, AFI_IP6, argv[0], NULL, argv[1],</a>
<a name="ln1984">				    argv[2], NULL, NULL);</a>
<a name="ln1985">}</a>
<a name="ln1986"> </a>
<a name="ln1987">DEFUN (no_ipv6_prefix_list_ge,</a>
<a name="ln1988">       no_ipv6_prefix_list_ge_cmd,</a>
<a name="ln1989">       &quot;no ipv6 prefix-list WORD (deny|permit) X:X::X:X/M ge &lt;0-128&gt;&quot;,</a>
<a name="ln1990">       NO_STR</a>
<a name="ln1991">       IPV6_STR</a>
<a name="ln1992">       PREFIX_LIST_STR</a>
<a name="ln1993">       &quot;Name of a prefix list\n&quot;</a>
<a name="ln1994">       &quot;Specify packets to reject\n&quot;</a>
<a name="ln1995">       &quot;Specify packets to forward\n&quot;</a>
<a name="ln1996">       &quot;IPv6 prefix &lt;network&gt;/&lt;length&gt;, e.g., 3ffe::/16\n&quot;</a>
<a name="ln1997">       &quot;Minimum prefix length to be matched\n&quot;</a>
<a name="ln1998">       &quot;Minimum prefix length\n&quot;)</a>
<a name="ln1999">{</a>
<a name="ln2000">  return vty_prefix_list_uninstall (vty, AFI_IP6, argv[0], NULL, argv[1],</a>
<a name="ln2001">				    argv[2], argv[3], NULL);</a>
<a name="ln2002">}</a>
<a name="ln2003"> </a>
<a name="ln2004">DEFUN (no_ipv6_prefix_list_ge_le,</a>
<a name="ln2005">       no_ipv6_prefix_list_ge_le_cmd,</a>
<a name="ln2006">       &quot;no ipv6 prefix-list WORD (deny|permit) X:X::X:X/M ge &lt;0-128&gt; le &lt;0-128&gt;&quot;,</a>
<a name="ln2007">       NO_STR</a>
<a name="ln2008">       IPV6_STR</a>
<a name="ln2009">       PREFIX_LIST_STR</a>
<a name="ln2010">       &quot;Name of a prefix list\n&quot;</a>
<a name="ln2011">       &quot;Specify packets to reject\n&quot;</a>
<a name="ln2012">       &quot;Specify packets to forward\n&quot;</a>
<a name="ln2013">       &quot;IPv6 prefix &lt;network&gt;/&lt;length&gt;, e.g., 3ffe::/16\n&quot;</a>
<a name="ln2014">       &quot;Minimum prefix length to be matched\n&quot;</a>
<a name="ln2015">       &quot;Minimum prefix length\n&quot;</a>
<a name="ln2016">       &quot;Maximum prefix length to be matched\n&quot;</a>
<a name="ln2017">       &quot;Maximum prefix length\n&quot;)</a>
<a name="ln2018">{</a>
<a name="ln2019">  return vty_prefix_list_uninstall (vty, AFI_IP6, argv[0], NULL, argv[1],</a>
<a name="ln2020">				    argv[2], argv[3], argv[4]);</a>
<a name="ln2021">}</a>
<a name="ln2022"> </a>
<a name="ln2023">DEFUN (no_ipv6_prefix_list_le,</a>
<a name="ln2024">       no_ipv6_prefix_list_le_cmd,</a>
<a name="ln2025">       &quot;no ipv6 prefix-list WORD (deny|permit) X:X::X:X/M le &lt;0-128&gt;&quot;,</a>
<a name="ln2026">       NO_STR</a>
<a name="ln2027">       IPV6_STR</a>
<a name="ln2028">       PREFIX_LIST_STR</a>
<a name="ln2029">       &quot;Name of a prefix list\n&quot;</a>
<a name="ln2030">       &quot;Specify packets to reject\n&quot;</a>
<a name="ln2031">       &quot;Specify packets to forward\n&quot;</a>
<a name="ln2032">       &quot;IPv6 prefix &lt;network&gt;/&lt;length&gt;, e.g., 3ffe::/16\n&quot;</a>
<a name="ln2033">       &quot;Maximum prefix length to be matched\n&quot;</a>
<a name="ln2034">       &quot;Maximum prefix length\n&quot;)</a>
<a name="ln2035">{</a>
<a name="ln2036">  return vty_prefix_list_uninstall (vty, AFI_IP6, argv[0], NULL, argv[1],</a>
<a name="ln2037">				    argv[2], NULL, argv[3]);</a>
<a name="ln2038">}</a>
<a name="ln2039"> </a>
<a name="ln2040">DEFUN (no_ipv6_prefix_list_le_ge,</a>
<a name="ln2041">       no_ipv6_prefix_list_le_ge_cmd,</a>
<a name="ln2042">       &quot;no ipv6 prefix-list WORD (deny|permit) X:X::X:X/M le &lt;0-128&gt; ge &lt;0-128&gt;&quot;,</a>
<a name="ln2043">       NO_STR</a>
<a name="ln2044">       IPV6_STR</a>
<a name="ln2045">       PREFIX_LIST_STR</a>
<a name="ln2046">       &quot;Name of a prefix list\n&quot;</a>
<a name="ln2047">       &quot;Specify packets to reject\n&quot;</a>
<a name="ln2048">       &quot;Specify packets to forward\n&quot;</a>
<a name="ln2049">       &quot;IPv6 prefix &lt;network&gt;/&lt;length&gt;, e.g., 3ffe::/16\n&quot;</a>
<a name="ln2050">       &quot;Maximum prefix length to be matched\n&quot;</a>
<a name="ln2051">       &quot;Maximum prefix length\n&quot;</a>
<a name="ln2052">       &quot;Minimum prefix length to be matched\n&quot;</a>
<a name="ln2053">       &quot;Minimum prefix length\n&quot;)</a>
<a name="ln2054">{</a>
<a name="ln2055">  return vty_prefix_list_uninstall (vty, AFI_IP6, argv[0], NULL, argv[1],</a>
<a name="ln2056">				    argv[2], argv[4], argv[3]);</a>
<a name="ln2057">}</a>
<a name="ln2058"> </a>
<a name="ln2059">DEFUN (no_ipv6_prefix_list_seq,</a>
<a name="ln2060">       no_ipv6_prefix_list_seq_cmd,</a>
<a name="ln2061">       &quot;no ipv6 prefix-list WORD seq &lt;1-4294967295&gt; (deny|permit) (X:X::X:X/M|any)&quot;,</a>
<a name="ln2062">       NO_STR</a>
<a name="ln2063">       IPV6_STR</a>
<a name="ln2064">       PREFIX_LIST_STR</a>
<a name="ln2065">       &quot;Name of a prefix list\n&quot;</a>
<a name="ln2066">       &quot;sequence number of an entry\n&quot;</a>
<a name="ln2067">       &quot;Sequence number\n&quot;</a>
<a name="ln2068">       &quot;Specify packets to reject\n&quot;</a>
<a name="ln2069">       &quot;Specify packets to forward\n&quot;</a>
<a name="ln2070">       &quot;IPv6 prefix &lt;network&gt;/&lt;length&gt;, e.g., 3ffe::/16\n&quot;</a>
<a name="ln2071">       &quot;Any prefix match.  Same as \&quot;::0/0 le 128\&quot;\n&quot;)</a>
<a name="ln2072">{</a>
<a name="ln2073">  return vty_prefix_list_uninstall (vty, AFI_IP6, argv[0], argv[1], argv[2],</a>
<a name="ln2074">				    argv[3], NULL, NULL);</a>
<a name="ln2075">}</a>
<a name="ln2076"> </a>
<a name="ln2077">DEFUN (no_ipv6_prefix_list_seq_ge,</a>
<a name="ln2078">       no_ipv6_prefix_list_seq_ge_cmd,</a>
<a name="ln2079">       &quot;no ipv6 prefix-list WORD seq &lt;1-4294967295&gt; (deny|permit) X:X::X:X/M ge &lt;0-128&gt;&quot;,</a>
<a name="ln2080">       NO_STR</a>
<a name="ln2081">       IPV6_STR</a>
<a name="ln2082">       PREFIX_LIST_STR</a>
<a name="ln2083">       &quot;Name of a prefix list\n&quot;</a>
<a name="ln2084">       &quot;sequence number of an entry\n&quot;</a>
<a name="ln2085">       &quot;Sequence number\n&quot;</a>
<a name="ln2086">       &quot;Specify packets to reject\n&quot;</a>
<a name="ln2087">       &quot;Specify packets to forward\n&quot;</a>
<a name="ln2088">       &quot;IPv6 prefix &lt;network&gt;/&lt;length&gt;, e.g., 3ffe::/16\n&quot;</a>
<a name="ln2089">       &quot;Minimum prefix length to be matched\n&quot;</a>
<a name="ln2090">       &quot;Minimum prefix length\n&quot;)</a>
<a name="ln2091">{</a>
<a name="ln2092">  return vty_prefix_list_uninstall (vty, AFI_IP6, argv[0], argv[1], argv[2],</a>
<a name="ln2093">				    argv[3], argv[4], NULL);</a>
<a name="ln2094">}</a>
<a name="ln2095"> </a>
<a name="ln2096">DEFUN (no_ipv6_prefix_list_seq_ge_le,</a>
<a name="ln2097">       no_ipv6_prefix_list_seq_ge_le_cmd,</a>
<a name="ln2098">       &quot;no ipv6 prefix-list WORD seq &lt;1-4294967295&gt; (deny|permit) X:X::X:X/M ge &lt;0-128&gt; le &lt;0-128&gt;&quot;,</a>
<a name="ln2099">       NO_STR</a>
<a name="ln2100">       IPV6_STR</a>
<a name="ln2101">       PREFIX_LIST_STR</a>
<a name="ln2102">       &quot;Name of a prefix list\n&quot;</a>
<a name="ln2103">       &quot;sequence number of an entry\n&quot;</a>
<a name="ln2104">       &quot;Sequence number\n&quot;</a>
<a name="ln2105">       &quot;Specify packets to reject\n&quot;</a>
<a name="ln2106">       &quot;Specify packets to forward\n&quot;</a>
<a name="ln2107">       &quot;IPv6 prefix &lt;network&gt;/&lt;length&gt;, e.g., 3ffe::/16\n&quot;</a>
<a name="ln2108">       &quot;Minimum prefix length to be matched\n&quot;</a>
<a name="ln2109">       &quot;Minimum prefix length\n&quot;</a>
<a name="ln2110">       &quot;Maximum prefix length to be matched\n&quot;</a>
<a name="ln2111">       &quot;Maximum prefix length\n&quot;)</a>
<a name="ln2112">{</a>
<a name="ln2113">  return vty_prefix_list_uninstall (vty, AFI_IP6, argv[0], argv[1], argv[2],</a>
<a name="ln2114">				    argv[3], argv[4], argv[5]);</a>
<a name="ln2115">}</a>
<a name="ln2116"> </a>
<a name="ln2117">DEFUN (no_ipv6_prefix_list_seq_le,</a>
<a name="ln2118">       no_ipv6_prefix_list_seq_le_cmd,</a>
<a name="ln2119">       &quot;no ipv6 prefix-list WORD seq &lt;1-4294967295&gt; (deny|permit) X:X::X:X/M le &lt;0-128&gt;&quot;,</a>
<a name="ln2120">       NO_STR</a>
<a name="ln2121">       IPV6_STR</a>
<a name="ln2122">       PREFIX_LIST_STR</a>
<a name="ln2123">       &quot;Name of a prefix list\n&quot;</a>
<a name="ln2124">       &quot;sequence number of an entry\n&quot;</a>
<a name="ln2125">       &quot;Sequence number\n&quot;</a>
<a name="ln2126">       &quot;Specify packets to reject\n&quot;</a>
<a name="ln2127">       &quot;Specify packets to forward\n&quot;</a>
<a name="ln2128">       &quot;IPv6 prefix &lt;network&gt;/&lt;length&gt;, e.g., 3ffe::/16\n&quot;</a>
<a name="ln2129">       &quot;Maximum prefix length to be matched\n&quot;</a>
<a name="ln2130">       &quot;Maximum prefix length\n&quot;)</a>
<a name="ln2131">{</a>
<a name="ln2132">  return vty_prefix_list_uninstall (vty, AFI_IP6, argv[0], argv[1], argv[2],</a>
<a name="ln2133">				    argv[3], NULL, argv[4]);</a>
<a name="ln2134">}</a>
<a name="ln2135"> </a>
<a name="ln2136">DEFUN (no_ipv6_prefix_list_seq_le_ge,</a>
<a name="ln2137">       no_ipv6_prefix_list_seq_le_ge_cmd,</a>
<a name="ln2138">       &quot;no ipv6 prefix-list WORD seq &lt;1-4294967295&gt; (deny|permit) X:X::X:X/M le &lt;0-128&gt; ge &lt;0-128&gt;&quot;,</a>
<a name="ln2139">       NO_STR</a>
<a name="ln2140">       IPV6_STR</a>
<a name="ln2141">       PREFIX_LIST_STR</a>
<a name="ln2142">       &quot;Name of a prefix list\n&quot;</a>
<a name="ln2143">       &quot;sequence number of an entry\n&quot;</a>
<a name="ln2144">       &quot;Sequence number\n&quot;</a>
<a name="ln2145">       &quot;Specify packets to reject\n&quot;</a>
<a name="ln2146">       &quot;Specify packets to forward\n&quot;</a>
<a name="ln2147">       &quot;IPv6 prefix &lt;network&gt;/&lt;length&gt;, e.g., 3ffe::/16\n&quot;</a>
<a name="ln2148">       &quot;Maximum prefix length to be matched\n&quot;</a>
<a name="ln2149">       &quot;Maximum prefix length\n&quot;</a>
<a name="ln2150">       &quot;Minimum prefix length to be matched\n&quot;</a>
<a name="ln2151">       &quot;Minimum prefix length\n&quot;)</a>
<a name="ln2152">{</a>
<a name="ln2153">  return vty_prefix_list_uninstall (vty, AFI_IP6, argv[0], argv[1], argv[2],</a>
<a name="ln2154">				    argv[3], argv[5], argv[4]);</a>
<a name="ln2155">}</a>
<a name="ln2156"> </a>
<a name="ln2157">DEFUN (ipv6_prefix_list_sequence_number,</a>
<a name="ln2158">       ipv6_prefix_list_sequence_number_cmd,</a>
<a name="ln2159">       &quot;ipv6 prefix-list sequence-number&quot;,</a>
<a name="ln2160">       IPV6_STR</a>
<a name="ln2161">       PREFIX_LIST_STR</a>
<a name="ln2162">       &quot;Include/exclude sequence numbers in NVGEN\n&quot;)</a>
<a name="ln2163">{</a>
<a name="ln2164">  prefix_master_ipv6.seqnum = 1;</a>
<a name="ln2165">  return CMD_SUCCESS;</a>
<a name="ln2166">}</a>
<a name="ln2167"> </a>
<a name="ln2168">DEFUN (no_ipv6_prefix_list_sequence_number,</a>
<a name="ln2169">       no_ipv6_prefix_list_sequence_number_cmd,</a>
<a name="ln2170">       &quot;no ipv6 prefix-list sequence-number&quot;,</a>
<a name="ln2171">       NO_STR</a>
<a name="ln2172">       IPV6_STR</a>
<a name="ln2173">       PREFIX_LIST_STR</a>
<a name="ln2174">       &quot;Include/exclude sequence numbers in NVGEN\n&quot;)</a>
<a name="ln2175">{</a>
<a name="ln2176">  prefix_master_ipv6.seqnum = 0;</a>
<a name="ln2177">  return CMD_SUCCESS;</a>
<a name="ln2178">}</a>
<a name="ln2179"> </a>
<a name="ln2180">DEFUN (ipv6_prefix_list_description,</a>
<a name="ln2181">       ipv6_prefix_list_description_cmd,</a>
<a name="ln2182">       &quot;ipv6 prefix-list WORD description .LINE&quot;,</a>
<a name="ln2183">       IPV6_STR</a>
<a name="ln2184">       PREFIX_LIST_STR</a>
<a name="ln2185">       &quot;Name of a prefix list\n&quot;</a>
<a name="ln2186">       &quot;Prefix-list specific description\n&quot;</a>
<a name="ln2187">       &quot;Up to 80 characters describing this prefix-list\n&quot;)</a>
<a name="ln2188">{</a>
<a name="ln2189">  struct prefix_list *plist;</a>
<a name="ln2190"> </a>
<a name="ln2191">  plist = prefix_list_get (AFI_IP6, 0, argv[0]);</a>
<a name="ln2192">  </a>
<a name="ln2193">  if (plist-&gt;desc)</a>
<a name="ln2194">    {</a>
<a name="ln2195">      XFREE (MTYPE_TMP, plist-&gt;desc);</a>
<a name="ln2196">      plist-&gt;desc = NULL;</a>
<a name="ln2197">    }</a>
<a name="ln2198">  plist-&gt;desc = argv_concat(argv, argc, 1);</a>
<a name="ln2199"> </a>
<a name="ln2200">  return CMD_SUCCESS;</a>
<a name="ln2201">}       </a>
<a name="ln2202"> </a>
<a name="ln2203">DEFUN (no_ipv6_prefix_list_description,</a>
<a name="ln2204">       no_ipv6_prefix_list_description_cmd,</a>
<a name="ln2205">       &quot;no ipv6 prefix-list WORD description&quot;,</a>
<a name="ln2206">       NO_STR</a>
<a name="ln2207">       IPV6_STR</a>
<a name="ln2208">       PREFIX_LIST_STR</a>
<a name="ln2209">       &quot;Name of a prefix list\n&quot;</a>
<a name="ln2210">       &quot;Prefix-list specific description\n&quot;)</a>
<a name="ln2211">{</a>
<a name="ln2212">  return vty_prefix_list_desc_unset (vty, AFI_IP6, argv[0]);</a>
<a name="ln2213">}</a>
<a name="ln2214"> </a>
<a name="ln2215">ALIAS (no_ipv6_prefix_list_description,</a>
<a name="ln2216">       no_ipv6_prefix_list_description_arg_cmd,</a>
<a name="ln2217">       &quot;no ipv6 prefix-list WORD description .LINE&quot;,</a>
<a name="ln2218">       NO_STR</a>
<a name="ln2219">       IPV6_STR</a>
<a name="ln2220">       PREFIX_LIST_STR</a>
<a name="ln2221">       &quot;Name of a prefix list\n&quot;</a>
<a name="ln2222">       &quot;Prefix-list specific description\n&quot;</a>
<a name="ln2223">       &quot;Up to 80 characters describing this prefix-list\n&quot;)</a>
<a name="ln2224"> </a>
<a name="ln2225">DEFUN (show_ipv6_prefix_list,</a>
<a name="ln2226">       show_ipv6_prefix_list_cmd,</a>
<a name="ln2227">       &quot;show ipv6 prefix-list&quot;,</a>
<a name="ln2228">       SHOW_STR</a>
<a name="ln2229">       IPV6_STR</a>
<a name="ln2230">       PREFIX_LIST_STR)</a>
<a name="ln2231">{</a>
<a name="ln2232">  return vty_show_prefix_list (vty, AFI_IP6, NULL, NULL, normal_display);</a>
<a name="ln2233">}</a>
<a name="ln2234"> </a>
<a name="ln2235">DEFUN (show_ipv6_prefix_list_name,</a>
<a name="ln2236">       show_ipv6_prefix_list_name_cmd,</a>
<a name="ln2237">       &quot;show ipv6 prefix-list WORD&quot;,</a>
<a name="ln2238">       SHOW_STR</a>
<a name="ln2239">       IPV6_STR</a>
<a name="ln2240">       PREFIX_LIST_STR</a>
<a name="ln2241">       &quot;Name of a prefix list\n&quot;)</a>
<a name="ln2242">{</a>
<a name="ln2243">  return vty_show_prefix_list (vty, AFI_IP6, argv[0], NULL, normal_display);</a>
<a name="ln2244">}</a>
<a name="ln2245"> </a>
<a name="ln2246">DEFUN (show_ipv6_prefix_list_name_seq,</a>
<a name="ln2247">       show_ipv6_prefix_list_name_seq_cmd,</a>
<a name="ln2248">       &quot;show ipv6 prefix-list WORD seq &lt;1-4294967295&gt;&quot;,</a>
<a name="ln2249">       SHOW_STR</a>
<a name="ln2250">       IPV6_STR</a>
<a name="ln2251">       PREFIX_LIST_STR</a>
<a name="ln2252">       &quot;Name of a prefix list\n&quot;</a>
<a name="ln2253">       &quot;sequence number of an entry\n&quot;</a>
<a name="ln2254">       &quot;Sequence number\n&quot;)</a>
<a name="ln2255">{</a>
<a name="ln2256">  return vty_show_prefix_list (vty, AFI_IP6, argv[0], argv[1], sequential_display);</a>
<a name="ln2257">}</a>
<a name="ln2258"> </a>
<a name="ln2259">DEFUN (show_ipv6_prefix_list_prefix,</a>
<a name="ln2260">       show_ipv6_prefix_list_prefix_cmd,</a>
<a name="ln2261">       &quot;show ipv6 prefix-list WORD X:X::X:X/M&quot;,</a>
<a name="ln2262">       SHOW_STR</a>
<a name="ln2263">       IPV6_STR</a>
<a name="ln2264">       PREFIX_LIST_STR</a>
<a name="ln2265">       &quot;Name of a prefix list\n&quot;</a>
<a name="ln2266">       &quot;IPv6 prefix &lt;network&gt;/&lt;length&gt;, e.g., 3ffe::/16\n&quot;)</a>
<a name="ln2267">{</a>
<a name="ln2268">  return vty_show_prefix_list_prefix (vty, AFI_IP6, argv[0], argv[1], normal_display);</a>
<a name="ln2269">}</a>
<a name="ln2270"> </a>
<a name="ln2271">DEFUN (show_ipv6_prefix_list_prefix_longer,</a>
<a name="ln2272">       show_ipv6_prefix_list_prefix_longer_cmd,</a>
<a name="ln2273">       &quot;show ipv6 prefix-list WORD X:X::X:X/M longer&quot;,</a>
<a name="ln2274">       SHOW_STR</a>
<a name="ln2275">       IPV6_STR</a>
<a name="ln2276">       PREFIX_LIST_STR</a>
<a name="ln2277">       &quot;Name of a prefix list\n&quot;</a>
<a name="ln2278">       &quot;IPv6 prefix &lt;network&gt;/&lt;length&gt;, e.g., 3ffe::/16\n&quot;</a>
<a name="ln2279">       &quot;Lookup longer prefix\n&quot;)</a>
<a name="ln2280">{</a>
<a name="ln2281">  return vty_show_prefix_list_prefix (vty, AFI_IP6, argv[0], argv[1], longer_display);</a>
<a name="ln2282">}</a>
<a name="ln2283"> </a>
<a name="ln2284">DEFUN (show_ipv6_prefix_list_prefix_first_match,</a>
<a name="ln2285">       show_ipv6_prefix_list_prefix_first_match_cmd,</a>
<a name="ln2286">       &quot;show ipv6 prefix-list WORD X:X::X:X/M first-match&quot;,</a>
<a name="ln2287">       SHOW_STR</a>
<a name="ln2288">       IPV6_STR</a>
<a name="ln2289">       PREFIX_LIST_STR</a>
<a name="ln2290">       &quot;Name of a prefix list\n&quot;</a>
<a name="ln2291">       &quot;IPv6 prefix &lt;network&gt;/&lt;length&gt;, e.g., 3ffe::/16\n&quot;</a>
<a name="ln2292">       &quot;First matched prefix\n&quot;)</a>
<a name="ln2293">{</a>
<a name="ln2294">  return vty_show_prefix_list_prefix (vty, AFI_IP6, argv[0], argv[1], first_match_display);</a>
<a name="ln2295">}</a>
<a name="ln2296"> </a>
<a name="ln2297">DEFUN (show_ipv6_prefix_list_summary,</a>
<a name="ln2298">       show_ipv6_prefix_list_summary_cmd,</a>
<a name="ln2299">       &quot;show ipv6 prefix-list summary&quot;,</a>
<a name="ln2300">       SHOW_STR</a>
<a name="ln2301">       IPV6_STR</a>
<a name="ln2302">       PREFIX_LIST_STR</a>
<a name="ln2303">       &quot;Summary of prefix lists\n&quot;)</a>
<a name="ln2304">{</a>
<a name="ln2305">  return vty_show_prefix_list (vty, AFI_IP6, NULL, NULL, summary_display);</a>
<a name="ln2306">}</a>
<a name="ln2307"> </a>
<a name="ln2308">DEFUN (show_ipv6_prefix_list_summary_name,</a>
<a name="ln2309">       show_ipv6_prefix_list_summary_name_cmd,</a>
<a name="ln2310">       &quot;show ipv6 prefix-list summary WORD&quot;,</a>
<a name="ln2311">       SHOW_STR</a>
<a name="ln2312">       IPV6_STR</a>
<a name="ln2313">       PREFIX_LIST_STR</a>
<a name="ln2314">       &quot;Summary of prefix lists\n&quot;</a>
<a name="ln2315">       &quot;Name of a prefix list\n&quot;)</a>
<a name="ln2316">{</a>
<a name="ln2317">  return vty_show_prefix_list (vty, AFI_IP6, argv[0], NULL, summary_display);</a>
<a name="ln2318">}</a>
<a name="ln2319"> </a>
<a name="ln2320">DEFUN (show_ipv6_prefix_list_detail,</a>
<a name="ln2321">       show_ipv6_prefix_list_detail_cmd,</a>
<a name="ln2322">       &quot;show ipv6 prefix-list detail&quot;,</a>
<a name="ln2323">       SHOW_STR</a>
<a name="ln2324">       IPV6_STR</a>
<a name="ln2325">       PREFIX_LIST_STR</a>
<a name="ln2326">       &quot;Detail of prefix lists\n&quot;)</a>
<a name="ln2327">{</a>
<a name="ln2328">  return vty_show_prefix_list (vty, AFI_IP6, NULL, NULL, detail_display);</a>
<a name="ln2329">}</a>
<a name="ln2330"> </a>
<a name="ln2331">DEFUN (show_ipv6_prefix_list_detail_name,</a>
<a name="ln2332">       show_ipv6_prefix_list_detail_name_cmd,</a>
<a name="ln2333">       &quot;show ipv6 prefix-list detail WORD&quot;,</a>
<a name="ln2334">       SHOW_STR</a>
<a name="ln2335">       IPV6_STR</a>
<a name="ln2336">       PREFIX_LIST_STR</a>
<a name="ln2337">       &quot;Detail of prefix lists\n&quot;</a>
<a name="ln2338">       &quot;Name of a prefix list\n&quot;)</a>
<a name="ln2339">{</a>
<a name="ln2340">  return vty_show_prefix_list (vty, AFI_IP6, argv[0], NULL, detail_display);</a>
<a name="ln2341">}</a>
<a name="ln2342"> </a>
<a name="ln2343">DEFUN (clear_ipv6_prefix_list,</a>
<a name="ln2344">       clear_ipv6_prefix_list_cmd,</a>
<a name="ln2345">       &quot;clear ipv6 prefix-list&quot;,</a>
<a name="ln2346">       CLEAR_STR</a>
<a name="ln2347">       IPV6_STR</a>
<a name="ln2348">       PREFIX_LIST_STR)</a>
<a name="ln2349">{</a>
<a name="ln2350">  return vty_clear_prefix_list (vty, AFI_IP6, NULL, NULL);</a>
<a name="ln2351">}</a>
<a name="ln2352"> </a>
<a name="ln2353">DEFUN (clear_ipv6_prefix_list_name,</a>
<a name="ln2354">       clear_ipv6_prefix_list_name_cmd,</a>
<a name="ln2355">       &quot;clear ipv6 prefix-list WORD&quot;,</a>
<a name="ln2356">       CLEAR_STR</a>
<a name="ln2357">       IPV6_STR</a>
<a name="ln2358">       PREFIX_LIST_STR</a>
<a name="ln2359">       &quot;Name of a prefix list\n&quot;)</a>
<a name="ln2360">{</a>
<a name="ln2361">  return vty_clear_prefix_list (vty, AFI_IP6, argv[0], NULL);</a>
<a name="ln2362">}</a>
<a name="ln2363"> </a>
<a name="ln2364">DEFUN (clear_ipv6_prefix_list_name_prefix,</a>
<a name="ln2365">       clear_ipv6_prefix_list_name_prefix_cmd,</a>
<a name="ln2366">       &quot;clear ipv6 prefix-list WORD X:X::X:X/M&quot;,</a>
<a name="ln2367">       CLEAR_STR</a>
<a name="ln2368">       IPV6_STR</a>
<a name="ln2369">       PREFIX_LIST_STR</a>
<a name="ln2370">       &quot;Name of a prefix list\n&quot;</a>
<a name="ln2371">       &quot;IPv6 prefix &lt;network&gt;/&lt;length&gt;, e.g., 3ffe::/16\n&quot;)</a>
<a name="ln2372">{</a>
<a name="ln2373">  return vty_clear_prefix_list (vty, AFI_IP6, argv[0], argv[1]);</a>
<a name="ln2374">}</a>
<a name="ln2375">#endif /* HAVE_IPV6 */</a>
<a name="ln2376"> </a>
<a name="ln2377">/* Configuration write function. */</a>
<a name="ln2378">static int</a>
<a name="ln2379">config_write_prefix_afi (afi_t afi, struct vty *vty)</a>
<a name="ln2380">{</a>
<a name="ln2381">  struct prefix_list *plist;</a>
<a name="ln2382">  struct prefix_list_entry *pentry;</a>
<a name="ln2383">  struct prefix_master *master;</a>
<a name="ln2384">  int write = 0;</a>
<a name="ln2385"> </a>
<a name="ln2386">  master = prefix_master_get (afi, 0);</a>
<a name="ln2387">  if (master == NULL)</a>
<a name="ln2388">    return 0;</a>
<a name="ln2389"> </a>
<a name="ln2390">  if (! master-&gt;seqnum)</a>
<a name="ln2391">    {</a>
<a name="ln2392">      vty_out (vty, &quot;no ip%s prefix-list sequence-number%s&quot;, </a>
<a name="ln2393">	       afi == AFI_IP ? &quot;&quot; : &quot;v6&quot;, VTY_NEWLINE);</a>
<a name="ln2394">      vty_out (vty, &quot;!%s&quot;, VTY_NEWLINE);</a>
<a name="ln2395">    }</a>
<a name="ln2396"> </a>
<a name="ln2397">  for (plist = master-&gt;num.head; plist; plist = plist-&gt;next)</a>
<a name="ln2398">    {</a>
<a name="ln2399">      if (plist-&gt;desc)</a>
<a name="ln2400">	{</a>
<a name="ln2401">	  vty_out (vty, &quot;ip%s prefix-list %s description %s%s&quot;,</a>
<a name="ln2402">		   afi == AFI_IP ? &quot;&quot; : &quot;v6&quot;,</a>
<a name="ln2403">		   plist-&gt;name, plist-&gt;desc, VTY_NEWLINE);</a>
<a name="ln2404">	  write++;</a>
<a name="ln2405">	}</a>
<a name="ln2406"> </a>
<a name="ln2407">      for (pentry = plist-&gt;head; pentry; pentry = pentry-&gt;next)</a>
<a name="ln2408">	{</a>
<a name="ln2409">	  vty_out (vty, &quot;ip%s prefix-list %s &quot;,</a>
<a name="ln2410">		   afi == AFI_IP ? &quot;&quot; : &quot;v6&quot;,</a>
<a name="ln2411">		   plist-&gt;name);</a>
<a name="ln2412"> </a>
<a name="ln2413">	  if (master-&gt;seqnum)</a>
<a name="ln2414">	    vty_out (vty, &quot;seq %d &quot;, pentry-&gt;seq);</a>
<a name="ln2415">	</a>
<a name="ln2416">	  vty_out (vty, &quot;%s &quot;, prefix_list_type_str (pentry));</a>
<a name="ln2417"> </a>
<a name="ln2418">	  if (pentry-&gt;any)</a>
<a name="ln2419">	    vty_out (vty, &quot;any&quot;);</a>
<a name="ln2420">	  else</a>
<a name="ln2421">	    {</a>
<a name="ln2422">	      struct prefix *p = &amp;pentry-&gt;prefix;</a>
<a name="ln2423">	      char buf[BUFSIZ];</a>
<a name="ln2424"> </a>
<a name="ln2425">	      vty_out (vty, &quot;%s/%d&quot;,</a>
<a name="ln2426">		       inet_ntop (p-&gt;family, &amp;p-&gt;u.prefix, buf, BUFSIZ),</a>
<a name="ln2427">		       p-&gt;prefixlen);</a>
<a name="ln2428"> </a>
<a name="ln2429">	      if (pentry-&gt;ge)</a>
<a name="ln2430">		vty_out (vty, &quot; ge %d&quot;, pentry-&gt;ge);</a>
<a name="ln2431">	      if (pentry-&gt;le)</a>
<a name="ln2432">		vty_out (vty, &quot; le %d&quot;, pentry-&gt;le);</a>
<a name="ln2433">	    }</a>
<a name="ln2434">	  vty_out (vty, &quot;%s&quot;, VTY_NEWLINE);</a>
<a name="ln2435">	  write++;</a>
<a name="ln2436">	}</a>
<a name="ln2437">      /* vty_out (vty, &quot;!%s&quot;, VTY_NEWLINE); */</a>
<a name="ln2438">    }</a>
<a name="ln2439"> </a>
<a name="ln2440">  for (plist = master-&gt;str.head; plist; plist = plist-&gt;next)</a>
<a name="ln2441">    {</a>
<a name="ln2442">      if (plist-&gt;desc)</a>
<a name="ln2443">	{</a>
<a name="ln2444">	  vty_out (vty, &quot;ip%s prefix-list %s description %s%s&quot;,</a>
<a name="ln2445">		   afi == AFI_IP ? &quot;&quot; : &quot;v6&quot;,</a>
<a name="ln2446">		   plist-&gt;name, plist-&gt;desc, VTY_NEWLINE);</a>
<a name="ln2447">	  write++;</a>
<a name="ln2448">	}</a>
<a name="ln2449"> </a>
<a name="ln2450">      for (pentry = plist-&gt;head; pentry; pentry = pentry-&gt;next)</a>
<a name="ln2451">	{</a>
<a name="ln2452">	  vty_out (vty, &quot;ip%s prefix-list %s &quot;,</a>
<a name="ln2453">		   afi == AFI_IP ? &quot;&quot; : &quot;v6&quot;,</a>
<a name="ln2454">		   plist-&gt;name);</a>
<a name="ln2455"> </a>
<a name="ln2456">	  if (master-&gt;seqnum)</a>
<a name="ln2457">	    vty_out (vty, &quot;seq %d &quot;, pentry-&gt;seq);</a>
<a name="ln2458"> </a>
<a name="ln2459">	  vty_out (vty, &quot;%s&quot;, prefix_list_type_str (pentry));</a>
<a name="ln2460"> </a>
<a name="ln2461">	  if (pentry-&gt;any)</a>
<a name="ln2462">	    vty_out (vty, &quot; any&quot;);</a>
<a name="ln2463">	  else</a>
<a name="ln2464">	    {</a>
<a name="ln2465">	      struct prefix *p = &amp;pentry-&gt;prefix;</a>
<a name="ln2466">	      char buf[BUFSIZ];</a>
<a name="ln2467"> </a>
<a name="ln2468">	      vty_out (vty, &quot; %s/%d&quot;,</a>
<a name="ln2469">		       inet_ntop (p-&gt;family, &amp;p-&gt;u.prefix, buf, BUFSIZ),</a>
<a name="ln2470">		       p-&gt;prefixlen);</a>
<a name="ln2471"> </a>
<a name="ln2472">	      if (pentry-&gt;ge)</a>
<a name="ln2473">		vty_out (vty, &quot; ge %d&quot;, pentry-&gt;ge);</a>
<a name="ln2474">	      if (pentry-&gt;le)</a>
<a name="ln2475">		vty_out (vty, &quot; le %d&quot;, pentry-&gt;le);</a>
<a name="ln2476">	    }</a>
<a name="ln2477">	  vty_out (vty, &quot;%s&quot;, VTY_NEWLINE);</a>
<a name="ln2478">	  write++;</a>
<a name="ln2479">	}</a>
<a name="ln2480">    }</a>
<a name="ln2481">  </a>
<a name="ln2482">  return write;</a>
<a name="ln2483">}</a>
<a name="ln2484"> </a>
<a name="ln2485">struct stream *</a>
<a name="ln2486">prefix_bgp_orf_entry (struct stream *s, struct prefix_list *plist,</a>
<a name="ln2487">		      u_char init_flag, u_char permit_flag, u_char deny_flag)</a>
<a name="ln2488">{</a>
<a name="ln2489">  struct prefix_list_entry *pentry;</a>
<a name="ln2490"> </a>
<a name="ln2491">  if (! plist)</a>
<a name="ln2492">    return s;</a>
<a name="ln2493"> </a>
<a name="ln2494">  for (pentry = plist-&gt;head; pentry; pentry = pentry-&gt;next)</a>
<a name="ln2495">    {</a>
<a name="ln2496">      u_char flag = init_flag;</a>
<a name="ln2497">      struct prefix *p = &amp;pentry-&gt;prefix;</a>
<a name="ln2498"> </a>
<a name="ln2499">      flag |= (pentry-&gt;type == PREFIX_PERMIT ?</a>
<a name="ln2500">               permit_flag : deny_flag);</a>
<a name="ln2501">      stream_putc (s, flag);</a>
<a name="ln2502">      stream_putl (s, (u_int32_t)pentry-&gt;seq);</a>
<a name="ln2503">      stream_putc (s, (u_char)pentry-&gt;ge);</a>
<a name="ln2504">      stream_putc (s, (u_char)pentry-&gt;le);</a>
<a name="ln2505">      stream_put_prefix (s, p);</a>
<a name="ln2506">    }</a>
<a name="ln2507"> </a>
<a name="ln2508">  return s;</a>
<a name="ln2509">}</a>
<a name="ln2510"> </a>
<a name="ln2511">int</a>
<a name="ln2512">prefix_bgp_orf_set (char *name, afi_t afi, struct orf_prefix *orfp,</a>
<a name="ln2513">		    int permit, int set)</a>
<a name="ln2514">{</a>
<a name="ln2515">  struct prefix_list *plist;</a>
<a name="ln2516">  struct prefix_list_entry *pentry;</a>
<a name="ln2517"> </a>
<a name="ln2518">  /* ge and le value check */ </a>
<a name="ln2519">  if (orfp-&gt;ge &amp;&amp; orfp-&gt;ge &lt;= orfp-&gt;p.prefixlen)</a>
<a name="ln2520">    return CMD_WARNING;</a>
<a name="ln2521">  if (orfp-&gt;le &amp;&amp; orfp-&gt;le &lt;= orfp-&gt;p.prefixlen)</a>
<a name="ln2522">    return CMD_WARNING;</a>
<a name="ln2523">  if (orfp-&gt;le &amp;&amp; orfp-&gt;ge &gt; orfp-&gt;le)</a>
<a name="ln2524">    return CMD_WARNING;</a>
<a name="ln2525"> </a>
<a name="ln2526">  if (orfp-&gt;ge &amp;&amp; orfp-&gt;le == (afi == AFI_IP ? 32 : 128))</a>
<a name="ln2527">    orfp-&gt;le = 0;</a>
<a name="ln2528"> </a>
<a name="ln2529">  plist = prefix_list_get (afi, 1, name);</a>
<a name="ln2530">  if (! plist)</a>
<a name="ln2531">    return CMD_WARNING;</a>
<a name="ln2532"> </a>
<a name="ln2533">  if (set)</a>
<a name="ln2534">    {</a>
<a name="ln2535">      pentry = prefix_list_entry_make (&amp;orfp-&gt;p,</a>
<a name="ln2536">				       (permit ? PREFIX_PERMIT : PREFIX_DENY),</a>
<a name="ln2537">				       orfp-&gt;seq, orfp-&gt;le, orfp-&gt;ge, 0);</a>
<a name="ln2538"> </a>
<a name="ln2539">      if (prefix_entry_dup_check (plist, pentry))</a>
<a name="ln2540">	{</a>
<a name="ln2541">	  prefix_list_entry_free (pentry);</a>
<a name="ln2542">	  return CMD_WARNING;</a>
<a name="ln2543">	}</a>
<a name="ln2544"> </a>
<a name="ln2545">      prefix_list_entry_add (plist, pentry);</a>
<a name="ln2546">    }</a>
<a name="ln2547">  else</a>
<a name="ln2548">    {</a>
<a name="ln2549">      pentry = prefix_list_entry_lookup (plist, &amp;orfp-&gt;p,</a>
<a name="ln2550">					 (permit ? PREFIX_PERMIT : PREFIX_DENY),</a>
<a name="ln2551">					 orfp-&gt;seq, orfp-&gt;le, orfp-&gt;ge);</a>
<a name="ln2552"> </a>
<a name="ln2553">      if (! pentry)</a>
<a name="ln2554">	return CMD_WARNING;</a>
<a name="ln2555"> </a>
<a name="ln2556">      prefix_list_entry_delete (plist, pentry, 1);</a>
<a name="ln2557">    }</a>
<a name="ln2558"> </a>
<a name="ln2559">  return CMD_SUCCESS;</a>
<a name="ln2560">}</a>
<a name="ln2561"> </a>
<a name="ln2562">void</a>
<a name="ln2563">prefix_bgp_orf_remove_all (afi_t afi, char *name)</a>
<a name="ln2564">{</a>
<a name="ln2565">  struct prefix_list *plist;</a>
<a name="ln2566"> </a>
<a name="ln2567">  plist = prefix_bgp_orf_lookup (afi, name);</a>
<a name="ln2568">  if (plist)</a>
<a name="ln2569">    prefix_list_delete (plist);</a>
<a name="ln2570">}</a>
<a name="ln2571"> </a>
<a name="ln2572">/* return prefix count */</a>
<a name="ln2573">int</a>
<a name="ln2574">prefix_bgp_show_prefix_list (struct vty *vty, afi_t afi, char *name)</a>
<a name="ln2575">{</a>
<a name="ln2576">  struct prefix_list *plist;</a>
<a name="ln2577">  struct prefix_list_entry *pentry;</a>
<a name="ln2578"> </a>
<a name="ln2579">  plist = prefix_bgp_orf_lookup (afi, name);</a>
<a name="ln2580">  if (! plist)</a>
<a name="ln2581">    return 0;</a>
<a name="ln2582"> </a>
<a name="ln2583">  if (! vty)</a>
<a name="ln2584">    return plist-&gt;count;</a>
<a name="ln2585"> </a>
<a name="ln2586">  vty_out (vty, &quot;ip%s prefix-list %s: %d entries%s&quot;,</a>
<a name="ln2587">	   afi == AFI_IP ? &quot;&quot; : &quot;v6&quot;,</a>
<a name="ln2588">	   plist-&gt;name, plist-&gt;count, VTY_NEWLINE);</a>
<a name="ln2589"> </a>
<a name="ln2590">  for (pentry = plist-&gt;head; pentry; pentry = pentry-&gt;next)</a>
<a name="ln2591">    {</a>
<a name="ln2592">      struct prefix *p = &amp;pentry-&gt;prefix;</a>
<a name="ln2593">      char buf[BUFSIZ];</a>
<a name="ln2594"> </a>
<a name="ln2595">      vty_out (vty, &quot;   seq %d %s %s/%d&quot;, pentry-&gt;seq,</a>
<a name="ln2596">	       prefix_list_type_str (pentry),</a>
<a name="ln2597">	       inet_ntop (p-&gt;family, &amp;p-&gt;u.prefix, buf, BUFSIZ),</a>
<a name="ln2598">	       p-&gt;prefixlen);</a>
<a name="ln2599"> </a>
<a name="ln2600">      if (pentry-&gt;ge)</a>
<a name="ln2601">	vty_out (vty, &quot; ge %d&quot;, pentry-&gt;ge);</a>
<a name="ln2602">      if (pentry-&gt;le)</a>
<a name="ln2603">	vty_out (vty, &quot; le %d&quot;, pentry-&gt;le);</a>
<a name="ln2604"> </a>
<a name="ln2605">      vty_out (vty, &quot;%s&quot;, VTY_NEWLINE);</a>
<a name="ln2606">    }</a>
<a name="ln2607">  return plist-&gt;count;</a>
<a name="ln2608">}</a>
<a name="ln2609"> </a>
<a name="ln2610">static void</a>
<a name="ln2611">prefix_list_reset_afi (afi_t afi, int orf)</a>
<a name="ln2612">{</a>
<a name="ln2613">  struct prefix_list *plist;</a>
<a name="ln2614">  struct prefix_list *next;</a>
<a name="ln2615">  struct prefix_master *master;</a>
<a name="ln2616"> </a>
<a name="ln2617">  master = prefix_master_get (afi, orf);</a>
<a name="ln2618">  if (master == NULL)</a>
<a name="ln2619">    return;</a>
<a name="ln2620"> </a>
<a name="ln2621">  for (plist = master-&gt;num.head; plist; plist = next)</a>
<a name="ln2622">    {</a>
<a name="ln2623">      next = plist-&gt;next;</a>
<a name="ln2624">      prefix_list_delete (plist);</a>
<a name="ln2625">    }</a>
<a name="ln2626">  for (plist = master-&gt;str.head; plist; plist = next)</a>
<a name="ln2627">    {</a>
<a name="ln2628">      next = plist-&gt;next;</a>
<a name="ln2629">      prefix_list_delete (plist);</a>
<a name="ln2630">    }</a>
<a name="ln2631"> </a>
<a name="ln2632">  assert (master-&gt;num.head == NULL);</a>
<a name="ln2633">  assert (master-&gt;num.tail == NULL);</a>
<a name="ln2634"> </a>
<a name="ln2635">  assert (master-&gt;str.head == NULL);</a>
<a name="ln2636">  assert (master-&gt;str.tail == NULL);</a>
<a name="ln2637"> </a>
<a name="ln2638">  master-&gt;seqnum = 1;</a>
<a name="ln2639">  master-&gt;recent = NULL;</a>
<a name="ln2640">}</a>
<a name="ln2641"> </a>
<a name="ln2642"> </a>
<a name="ln2643">/* Prefix-list node. */</a>
<a name="ln2644">static struct cmd_node prefix_node =</a>
<a name="ln2645">{</a>
<a name="ln2646">  PREFIX_NODE,</a>
<a name="ln2647">  &quot;&quot;,				/* Prefix list has no interface. */</a>
<a name="ln2648">  1</a>
<a name="ln2649">};</a>
<a name="ln2650"> </a>
<a name="ln2651">static int</a>
<a name="ln2652">config_write_prefix_ipv4 (struct vty *vty)</a>
<a name="ln2653">{</a>
<a name="ln2654">  return config_write_prefix_afi (AFI_IP, vty);</a>
<a name="ln2655">}</a>
<a name="ln2656"> </a>
<a name="ln2657">static void</a>
<a name="ln2658">prefix_list_init_ipv4 (void)</a>
<a name="ln2659">{</a>
<a name="ln2660">  install_node (&amp;prefix_node, config_write_prefix_ipv4);</a>
<a name="ln2661"> </a>
<a name="ln2662">  install_element (CONFIG_NODE, &amp;ip_prefix_list_cmd);</a>
<a name="ln2663">  install_element (CONFIG_NODE, &amp;ip_prefix_list_ge_cmd);</a>
<a name="ln2664">  install_element (CONFIG_NODE, &amp;ip_prefix_list_ge_le_cmd);</a>
<a name="ln2665">  install_element (CONFIG_NODE, &amp;ip_prefix_list_le_cmd);</a>
<a name="ln2666">  install_element (CONFIG_NODE, &amp;ip_prefix_list_le_ge_cmd);</a>
<a name="ln2667">  install_element (CONFIG_NODE, &amp;ip_prefix_list_seq_cmd);</a>
<a name="ln2668">  install_element (CONFIG_NODE, &amp;ip_prefix_list_seq_ge_cmd);</a>
<a name="ln2669">  install_element (CONFIG_NODE, &amp;ip_prefix_list_seq_ge_le_cmd);</a>
<a name="ln2670">  install_element (CONFIG_NODE, &amp;ip_prefix_list_seq_le_cmd);</a>
<a name="ln2671">  install_element (CONFIG_NODE, &amp;ip_prefix_list_seq_le_ge_cmd);</a>
<a name="ln2672"> </a>
<a name="ln2673">  install_element (CONFIG_NODE, &amp;no_ip_prefix_list_cmd);</a>
<a name="ln2674">  install_element (CONFIG_NODE, &amp;no_ip_prefix_list_prefix_cmd);</a>
<a name="ln2675">  install_element (CONFIG_NODE, &amp;no_ip_prefix_list_ge_cmd);</a>
<a name="ln2676">  install_element (CONFIG_NODE, &amp;no_ip_prefix_list_ge_le_cmd);</a>
<a name="ln2677">  install_element (CONFIG_NODE, &amp;no_ip_prefix_list_le_cmd);</a>
<a name="ln2678">  install_element (CONFIG_NODE, &amp;no_ip_prefix_list_le_ge_cmd);</a>
<a name="ln2679">  install_element (CONFIG_NODE, &amp;no_ip_prefix_list_seq_cmd);</a>
<a name="ln2680">  install_element (CONFIG_NODE, &amp;no_ip_prefix_list_seq_ge_cmd);</a>
<a name="ln2681">  install_element (CONFIG_NODE, &amp;no_ip_prefix_list_seq_ge_le_cmd);</a>
<a name="ln2682">  install_element (CONFIG_NODE, &amp;no_ip_prefix_list_seq_le_cmd);</a>
<a name="ln2683">  install_element (CONFIG_NODE, &amp;no_ip_prefix_list_seq_le_ge_cmd);</a>
<a name="ln2684"> </a>
<a name="ln2685">  install_element (CONFIG_NODE, &amp;ip_prefix_list_description_cmd);</a>
<a name="ln2686">  install_element (CONFIG_NODE, &amp;no_ip_prefix_list_description_cmd);</a>
<a name="ln2687">  install_element (CONFIG_NODE, &amp;no_ip_prefix_list_description_arg_cmd);</a>
<a name="ln2688"> </a>
<a name="ln2689">  install_element (CONFIG_NODE, &amp;ip_prefix_list_sequence_number_cmd);</a>
<a name="ln2690">  install_element (CONFIG_NODE, &amp;no_ip_prefix_list_sequence_number_cmd);</a>
<a name="ln2691"> </a>
<a name="ln2692">  install_element (VIEW_NODE, &amp;show_ip_prefix_list_cmd);</a>
<a name="ln2693">  install_element (VIEW_NODE, &amp;show_ip_prefix_list_name_cmd);</a>
<a name="ln2694">  install_element (VIEW_NODE, &amp;show_ip_prefix_list_name_seq_cmd);</a>
<a name="ln2695">  install_element (VIEW_NODE, &amp;show_ip_prefix_list_prefix_cmd);</a>
<a name="ln2696">  install_element (VIEW_NODE, &amp;show_ip_prefix_list_prefix_longer_cmd);</a>
<a name="ln2697">  install_element (VIEW_NODE, &amp;show_ip_prefix_list_prefix_first_match_cmd);</a>
<a name="ln2698">  install_element (VIEW_NODE, &amp;show_ip_prefix_list_summary_cmd);</a>
<a name="ln2699">  install_element (VIEW_NODE, &amp;show_ip_prefix_list_summary_name_cmd);</a>
<a name="ln2700">  install_element (VIEW_NODE, &amp;show_ip_prefix_list_detail_cmd);</a>
<a name="ln2701">  install_element (VIEW_NODE, &amp;show_ip_prefix_list_detail_name_cmd);</a>
<a name="ln2702"> </a>
<a name="ln2703">  install_element (ENABLE_NODE, &amp;clear_ip_prefix_list_cmd);</a>
<a name="ln2704">  install_element (ENABLE_NODE, &amp;clear_ip_prefix_list_name_cmd);</a>
<a name="ln2705">  install_element (ENABLE_NODE, &amp;clear_ip_prefix_list_name_prefix_cmd);</a>
<a name="ln2706">}</a>
<a name="ln2707"> </a>
<a name="ln2708">/* Prefix-list node. */</a>
<a name="ln2709">static struct cmd_node prefix_ipv6_node =</a>
<a name="ln2710">{</a>
<a name="ln2711">  PREFIX_IPV6_NODE,</a>
<a name="ln2712">  &quot;&quot;,				/* Prefix list has no interface. */</a>
<a name="ln2713">  1</a>
<a name="ln2714">};</a>
<a name="ln2715"> </a>
<a name="ln2716">static int</a>
<a name="ln2717">config_write_prefix_ipv6 (struct vty *vty)</a>
<a name="ln2718">{</a>
<a name="ln2719">  return config_write_prefix_afi (AFI_IP6, vty);</a>
<a name="ln2720">}</a>
<a name="ln2721"> </a>
<a name="ln2722">static void</a>
<a name="ln2723">prefix_list_init_ipv6 (void)</a>
<a name="ln2724">{</a>
<a name="ln2725">  install_node (&amp;prefix_ipv6_node, config_write_prefix_ipv6);</a>
<a name="ln2726"> </a>
<a name="ln2727">  install_element (CONFIG_NODE, &amp;ipv6_prefix_list_cmd);</a>
<a name="ln2728">  install_element (CONFIG_NODE, &amp;ipv6_prefix_list_ge_cmd);</a>
<a name="ln2729">  install_element (CONFIG_NODE, &amp;ipv6_prefix_list_ge_le_cmd);</a>
<a name="ln2730">  install_element (CONFIG_NODE, &amp;ipv6_prefix_list_le_cmd);</a>
<a name="ln2731">  install_element (CONFIG_NODE, &amp;ipv6_prefix_list_le_ge_cmd);</a>
<a name="ln2732">  install_element (CONFIG_NODE, &amp;ipv6_prefix_list_seq_cmd);</a>
<a name="ln2733">  install_element (CONFIG_NODE, &amp;ipv6_prefix_list_seq_ge_cmd);</a>
<a name="ln2734">  install_element (CONFIG_NODE, &amp;ipv6_prefix_list_seq_ge_le_cmd);</a>
<a name="ln2735">  install_element (CONFIG_NODE, &amp;ipv6_prefix_list_seq_le_cmd);</a>
<a name="ln2736">  install_element (CONFIG_NODE, &amp;ipv6_prefix_list_seq_le_ge_cmd);</a>
<a name="ln2737"> </a>
<a name="ln2738">  install_element (CONFIG_NODE, &amp;no_ipv6_prefix_list_cmd);</a>
<a name="ln2739">  install_element (CONFIG_NODE, &amp;no_ipv6_prefix_list_prefix_cmd);</a>
<a name="ln2740">  install_element (CONFIG_NODE, &amp;no_ipv6_prefix_list_ge_cmd);</a>
<a name="ln2741">  install_element (CONFIG_NODE, &amp;no_ipv6_prefix_list_ge_le_cmd);</a>
<a name="ln2742">  install_element (CONFIG_NODE, &amp;no_ipv6_prefix_list_le_cmd);</a>
<a name="ln2743">  install_element (CONFIG_NODE, &amp;no_ipv6_prefix_list_le_ge_cmd);</a>
<a name="ln2744">  install_element (CONFIG_NODE, &amp;no_ipv6_prefix_list_seq_cmd);</a>
<a name="ln2745">  install_element (CONFIG_NODE, &amp;no_ipv6_prefix_list_seq_ge_cmd);</a>
<a name="ln2746">  install_element (CONFIG_NODE, &amp;no_ipv6_prefix_list_seq_ge_le_cmd);</a>
<a name="ln2747">  install_element (CONFIG_NODE, &amp;no_ipv6_prefix_list_seq_le_cmd);</a>
<a name="ln2748">  install_element (CONFIG_NODE, &amp;no_ipv6_prefix_list_seq_le_ge_cmd);</a>
<a name="ln2749"> </a>
<a name="ln2750">  install_element (CONFIG_NODE, &amp;ipv6_prefix_list_description_cmd);</a>
<a name="ln2751">  install_element (CONFIG_NODE, &amp;no_ipv6_prefix_list_description_cmd);</a>
<a name="ln2752">  install_element (CONFIG_NODE, &amp;no_ipv6_prefix_list_description_arg_cmd);</a>
<a name="ln2753"> </a>
<a name="ln2754">  install_element (CONFIG_NODE, &amp;ipv6_prefix_list_sequence_number_cmd);</a>
<a name="ln2755">  install_element (CONFIG_NODE, &amp;no_ipv6_prefix_list_sequence_number_cmd);</a>
<a name="ln2756"> </a>
<a name="ln2757">  install_element (VIEW_NODE, &amp;show_ipv6_prefix_list_cmd);</a>
<a name="ln2758">  install_element (VIEW_NODE, &amp;show_ipv6_prefix_list_name_cmd);</a>
<a name="ln2759">  install_element (VIEW_NODE, &amp;show_ipv6_prefix_list_name_seq_cmd);</a>
<a name="ln2760">  install_element (VIEW_NODE, &amp;show_ipv6_prefix_list_prefix_cmd);</a>
<a name="ln2761">  install_element (VIEW_NODE, &amp;show_ipv6_prefix_list_prefix_longer_cmd);</a>
<a name="ln2762">  install_element (VIEW_NODE, &amp;show_ipv6_prefix_list_prefix_first_match_cmd);</a>
<a name="ln2763">  install_element (VIEW_NODE, &amp;show_ipv6_prefix_list_summary_cmd);</a>
<a name="ln2764">  install_element (VIEW_NODE, &amp;show_ipv6_prefix_list_summary_name_cmd);</a>
<a name="ln2765">  install_element (VIEW_NODE, &amp;show_ipv6_prefix_list_detail_cmd);</a>
<a name="ln2766">  install_element (VIEW_NODE, &amp;show_ipv6_prefix_list_detail_name_cmd);</a>
<a name="ln2767"> </a>
<a name="ln2768">  install_element (ENABLE_NODE, &amp;clear_ipv6_prefix_list_cmd);</a>
<a name="ln2769">  install_element (ENABLE_NODE, &amp;clear_ipv6_prefix_list_name_cmd);</a>
<a name="ln2770">  install_element (ENABLE_NODE, &amp;clear_ipv6_prefix_list_name_prefix_cmd);</a>
<a name="ln2771">}</a>
<a name="ln2772"> </a>
<a name="ln2773">void</a>
<a name="ln2774">prefix_list_init ()</a>
<a name="ln2775">{</a>
<a name="ln2776">  prefix_list_init_ipv4 ();</a>
<a name="ln2777">#ifdef HAVE_IPV6</a>
<a name="ln2778">  prefix_list_init_ipv6 ();</a>
<a name="ln2779">#endif /* HAVE_IPV6 */</a>
<a name="ln2780">}</a>
<a name="ln2781"> </a>
<a name="ln2782">void</a>
<a name="ln2783">prefix_list_reset ()</a>
<a name="ln2784">{</a>
<a name="ln2785">  prefix_list_reset_afi (AFI_IP,  0);</a>
<a name="ln2786">  prefix_list_reset_afi (AFI_IP6, 0);</a>
<a name="ln2787">  prefix_list_reset_afi (AFI_IP,  1);</a>
<a name="ln2788">  prefix_list_reset_afi (AFI_IP6, 1);</a>
<a name="ln2789">}</a>

</code></pre>
<div class="balloon" rel="7"><p><span style="font-size:18px">&uarr;</span> <a href="https://pvs-studio.com/en/docs/warnings/v1042/" target="_blank">V1042</a> This file is marked with copyleft license, which requires you to open the derived source code.</p></div>
<div class="balloon" rel="398"><p><span style="font-size:18px">&uarr;</span> <a href="https://pvs-studio.com/en/docs/warnings/v519/" target="_blank">V519</a> The 'newseq' variable is assigned values twice successively. Perhaps this is a mistake. Check lines: 390, 398.</p></div>
<div class="balloon" rel="924"><p><span style="font-size:18px">&uarr;</span> <a href="https://pvs-studio.com/en/docs/warnings/v560/" target="_blank">V560</a> A part of conditional expression is always true: plist->desc == NULL.</p></div>
<div class="balloon" rel="2654"><p><span style="font-size:18px">&uarr;</span> <a href="https://pvs-studio.com/en/docs/warnings/v1031/" target="_blank">V1031</a> The 'config_write_prefix_afi' function is not declared. Passing data to or from this function can be affected.</p></div>
<div class="balloon" rel="2719"><p><span style="font-size:18px">&uarr;</span> <a href="https://pvs-studio.com/en/docs/warnings/v1031/" target="_blank">V1031</a> The 'config_write_prefix_afi' function is not declared. Passing data to or from this function can be affected.</p></div>
<div class="balloon" rel="2785"><p><span style="font-size:18px">&uarr;</span> <a href="https://pvs-studio.com/en/docs/warnings/v1031/" target="_blank">V1031</a> The 'prefix_list_reset_afi' function is not declared. Passing data to or from this function can be affected.</p></div>
<div class="balloon" rel="2786"><p><span style="font-size:18px">&uarr;</span> <a href="https://pvs-studio.com/en/docs/warnings/v1031/" target="_blank">V1031</a> The 'prefix_list_reset_afi' function is not declared. Passing data to or from this function can be affected.</p></div>
<div class="balloon" rel="2787"><p><span style="font-size:18px">&uarr;</span> <a href="https://pvs-studio.com/en/docs/warnings/v1031/" target="_blank">V1031</a> The 'prefix_list_reset_afi' function is not declared. Passing data to or from this function can be affected.</p></div>
<div class="balloon" rel="2788"><p><span style="font-size:18px">&uarr;</span> <a href="https://pvs-studio.com/en/docs/warnings/v1031/" target="_blank">V1031</a> The 'prefix_list_reset_afi' function is not declared. Passing data to or from this function can be affected.</p></div>

<link rel="stylesheet" href="highlight.css">
<script src="highlight.pack.js"></script>
<script src="highlightjs-line-numbers.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
<script>hljs.initLineNumbersOnLoad();</script>
<script>
  $(document).ready(function() {
      $('.balloon').each(function () {
          var bl = $(this);
          var line = bl.attr('rel');
          var text = $('a[name="ln'+line+'"]').text();

          var space_count = 0;
          for(var i = 0; i<text.length; i++){
              var char = text[i];
              if((char !== ' ')&&(char !== '\t'))break;
              if(char === '\t')space_count++;
              space_count++;
          }

          bl.css('margin-left', space_count*8);
          $('a[name="ln'+line+'"]').after(bl);
      });

      window.location = window.location;
  });
</script>
</body>
</html>
