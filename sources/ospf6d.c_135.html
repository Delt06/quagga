
<html>
<head>

  <meta http-equiv="Content-Type" content="text/html; charset=US-ASCII" />
  <title>ospf6d.c</title>

  <link rel="stylesheet" href="../style.css"/>
  <script src="../jquery-3.5.1.min.js"></script>
</head>
<body>

<pre><code class = "cpp">
<a name="ln1">/*</a>
<a name="ln2"> * Copyright (C) 2003 Yasuhiro Ohara</a>
<a name="ln3"> *</a>
<a name="ln4"> * This file is part of GNU Zebra.</a>
<a name="ln5"> *</a>
<a name="ln6"> * GNU Zebra is free software; you can redistribute it and/or modify it</a>
<a name="ln7"> * under the terms of the GNU General Public License as published by the</a>
<a name="ln8"> * Free Software Foundation; either version 2, or (at your option) any</a>
<a name="ln9"> * later version.</a>
<a name="ln10"> *</a>
<a name="ln11"> * GNU Zebra is distributed in the hope that it will be useful, but</a>
<a name="ln12"> * WITHOUT ANY WARRANTY; without even the implied warranty of</a>
<a name="ln13"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</a>
<a name="ln14"> * General Public License for more details.</a>
<a name="ln15"> *</a>
<a name="ln16"> * You should have received a copy of the GNU General Public License</a>
<a name="ln17"> * along with GNU Zebra; see the file COPYING.  If not, write to the </a>
<a name="ln18"> * Free Software Foundation, Inc., 59 Temple Place - Suite 330, </a>
<a name="ln19"> * Boston, MA 02111-1307, USA.  </a>
<a name="ln20"> */</a>
<a name="ln21"> </a>
<a name="ln22">#include &lt;zebra.h&gt;</a>
<a name="ln23"> </a>
<a name="ln24">#include &quot;thread.h&quot;</a>
<a name="ln25">#include &quot;linklist.h&quot;</a>
<a name="ln26">#include &quot;vty.h&quot;</a>
<a name="ln27">#include &quot;command.h&quot;</a>
<a name="ln28"> </a>
<a name="ln29">#include &quot;ospf6_proto.h&quot;</a>
<a name="ln30">#include &quot;ospf6_network.h&quot;</a>
<a name="ln31">#include &quot;ospf6_lsa.h&quot;</a>
<a name="ln32">#include &quot;ospf6_lsdb.h&quot;</a>
<a name="ln33">#include &quot;ospf6_message.h&quot;</a>
<a name="ln34">#include &quot;ospf6_route.h&quot;</a>
<a name="ln35">#include &quot;ospf6_zebra.h&quot;</a>
<a name="ln36">#include &quot;ospf6_spf.h&quot;</a>
<a name="ln37">#include &quot;ospf6_top.h&quot;</a>
<a name="ln38">#include &quot;ospf6_area.h&quot;</a>
<a name="ln39">#include &quot;ospf6_interface.h&quot;</a>
<a name="ln40">#include &quot;ospf6_neighbor.h&quot;</a>
<a name="ln41">#include &quot;ospf6_intra.h&quot;</a>
<a name="ln42">#include &quot;ospf6_asbr.h&quot;</a>
<a name="ln43">#include &quot;ospf6_abr.h&quot;</a>
<a name="ln44">#include &quot;ospf6_flood.h&quot;</a>
<a name="ln45">#include &quot;ospf6d.h&quot;</a>
<a name="ln46"> </a>
<a name="ln47">#ifdef HAVE_SNMP</a>
<a name="ln48">#include &quot;ospf6_snmp.h&quot;</a>
<a name="ln49">#endif /*HAVE_SNMP*/</a>
<a name="ln50"> </a>
<a name="ln51">char ospf6_daemon_version[] = OSPF6_DAEMON_VERSION;</a>
<a name="ln52"> </a>
<a name="ln53">struct route_node *</a>
<a name="ln54">route_prev (struct route_node *node)</a>
<a name="ln55">{</a>
<a name="ln56">  struct route_node *end;</a>
<a name="ln57">  struct route_node *prev = NULL;</a>
<a name="ln58"> </a>
<a name="ln59">  end = node;</a>
<a name="ln60">  node = node-&gt;parent;</a>
<a name="ln61">  if (node)</a>
<a name="ln62">    route_lock_node (node);</a>
<a name="ln63">  while (node)</a>
<a name="ln64">    {</a>
<a name="ln65">      prev = node;</a>
<a name="ln66">      node = route_next (node);</a>
<a name="ln67">      if (node == end)</a>
<a name="ln68">        {</a>
<a name="ln69">          route_unlock_node (node);</a>
<a name="ln70">          node = NULL;</a>
<a name="ln71">        }</a>
<a name="ln72">    }</a>
<a name="ln73">  route_unlock_node (end);</a>
<a name="ln74">  if (prev)</a>
<a name="ln75">    route_lock_node (prev);</a>
<a name="ln76"> </a>
<a name="ln77">  return prev;</a>
<a name="ln78">}</a>
<a name="ln79"> </a>
<a name="ln80"> </a>
<a name="ln81">/* show database functions */</a>
<a name="ln82">DEFUN (show_version_ospf6,</a>
<a name="ln83">       show_version_ospf6_cmd,</a>
<a name="ln84">       &quot;show version ospf6&quot;,</a>
<a name="ln85">       SHOW_STR</a>
<a name="ln86">       &quot;Displays ospf6d version\n&quot;</a>
<a name="ln87">      )</a>
<a name="ln88">{</a>
<a name="ln89">  vty_out (vty, &quot;Zebra OSPF6d Version: %s%s&quot;,</a>
<a name="ln90">           ospf6_daemon_version, VNL);</a>
<a name="ln91"> </a>
<a name="ln92">  return CMD_SUCCESS;</a>
<a name="ln93">}</a>
<a name="ln94"> </a>
<a name="ln95">static struct cmd_node debug_node =</a>
<a name="ln96">{</a>
<a name="ln97">  DEBUG_NODE,</a>
<a name="ln98">  &quot;&quot;,</a>
<a name="ln99">  1 /* VTYSH */</a>
<a name="ln100">};</a>
<a name="ln101"> </a>
<a name="ln102">static int</a>
<a name="ln103">config_write_ospf6_debug (struct vty *vty)</a>
<a name="ln104">{</a>
<a name="ln105">  config_write_ospf6_debug_message (vty);</a>
<a name="ln106">  config_write_ospf6_debug_lsa (vty);</a>
<a name="ln107">  config_write_ospf6_debug_zebra (vty);</a>
<a name="ln108">  config_write_ospf6_debug_interface (vty);</a>
<a name="ln109">  config_write_ospf6_debug_neighbor (vty);</a>
<a name="ln110">  config_write_ospf6_debug_spf (vty);</a>
<a name="ln111">  config_write_ospf6_debug_route (vty);</a>
<a name="ln112">  config_write_ospf6_debug_brouter (vty);</a>
<a name="ln113">  config_write_ospf6_debug_asbr (vty);</a>
<a name="ln114">  config_write_ospf6_debug_abr (vty);</a>
<a name="ln115">  config_write_ospf6_debug_flood (vty);</a>
<a name="ln116">  vty_out (vty, &quot;!%s&quot;, VNL);</a>
<a name="ln117">  return 0;</a>
<a name="ln118">}</a>
<a name="ln119"> </a>
<a name="ln120">#define AREA_LSDB_TITLE_FORMAT \</a>
<a name="ln121">  &quot;%s        Area Scoped Link State Database (Area %s)%s%s&quot;</a>
<a name="ln122">#define IF_LSDB_TITLE_FORMAT \</a>
<a name="ln123">  &quot;%s        I/F Scoped Link State Database (I/F %s in Area %s)%s%s&quot;</a>
<a name="ln124">#define AS_LSDB_TITLE_FORMAT \</a>
<a name="ln125">  &quot;%s        AS Scoped Link State Database%s%s&quot;</a>
<a name="ln126"> </a>
<a name="ln127">static int</a>
<a name="ln128">parse_show_level (int argc, const char *argv[])</a>
<a name="ln129">{</a>
<a name="ln130">  int level = 0;</a>
<a name="ln131">  if (argc)</a>
<a name="ln132">    {</a>
<a name="ln133">      if (! strncmp (argv[0], &quot;de&quot;, 2))</a>
<a name="ln134">        level = OSPF6_LSDB_SHOW_LEVEL_DETAIL;</a>
<a name="ln135">      else if (! strncmp (argv[0], &quot;du&quot;, 2))</a>
<a name="ln136">        level = OSPF6_LSDB_SHOW_LEVEL_DUMP;</a>
<a name="ln137">      else if (! strncmp (argv[0], &quot;in&quot;, 2))</a>
<a name="ln138">        level = OSPF6_LSDB_SHOW_LEVEL_INTERNAL;</a>
<a name="ln139">    }</a>
<a name="ln140">  else</a>
<a name="ln141">    level = OSPF6_LSDB_SHOW_LEVEL_NORMAL;</a>
<a name="ln142">  return level;</a>
<a name="ln143">}</a>
<a name="ln144"> </a>
<a name="ln145">static u_int16_t</a>
<a name="ln146">parse_type_spec (int argc, const char *argv[])</a>
<a name="ln147">{</a>
<a name="ln148">  u_int16_t type = 0;</a>
<a name="ln149">  assert (argc);</a>
<a name="ln150">  if (! strcmp (argv[0], &quot;router&quot;))</a>
<a name="ln151">    type = htons (OSPF6_LSTYPE_ROUTER);</a>
<a name="ln152">  else if (! strcmp (argv[0], &quot;network&quot;))</a>
<a name="ln153">    type = htons (OSPF6_LSTYPE_NETWORK);</a>
<a name="ln154">  else if (! strcmp (argv[0], &quot;as-external&quot;))</a>
<a name="ln155">    type = htons (OSPF6_LSTYPE_AS_EXTERNAL);</a>
<a name="ln156">  else if (! strcmp (argv[0], &quot;intra-prefix&quot;))</a>
<a name="ln157">    type = htons (OSPF6_LSTYPE_INTRA_PREFIX);</a>
<a name="ln158">  else if (! strcmp (argv[0], &quot;inter-router&quot;))</a>
<a name="ln159">    type = htons (OSPF6_LSTYPE_INTER_ROUTER);</a>
<a name="ln160">  else if (! strcmp (argv[0], &quot;inter-prefix&quot;))</a>
<a name="ln161">    type = htons (OSPF6_LSTYPE_INTER_PREFIX);</a>
<a name="ln162">  else if (! strcmp (argv[0], &quot;link&quot;))</a>
<a name="ln163">    type = htons (OSPF6_LSTYPE_LINK);</a>
<a name="ln164">  return type;</a>
<a name="ln165">}</a>
<a name="ln166"> </a>
<a name="ln167">DEFUN (show_ipv6_ospf6_database,</a>
<a name="ln168">       show_ipv6_ospf6_database_cmd,</a>
<a name="ln169">       &quot;show ipv6 ospf6 database&quot;,</a>
<a name="ln170">       SHOW_STR</a>
<a name="ln171">       IPV6_STR</a>
<a name="ln172">       OSPF6_STR</a>
<a name="ln173">       &quot;Display Link state database\n&quot;</a>
<a name="ln174">      )</a>
<a name="ln175">{</a>
<a name="ln176">  int level;</a>
<a name="ln177">  struct listnode *i, *j;</a>
<a name="ln178">  struct ospf6 *o = ospf6;</a>
<a name="ln179">  struct ospf6_area *oa;</a>
<a name="ln180">  struct ospf6_interface *oi;</a>
<a name="ln181"> </a>
<a name="ln182">  OSPF6_CMD_CHECK_RUNNING ();</a>
<a name="ln183"> </a>
<a name="ln184">  level = parse_show_level (argc, argv);</a>
<a name="ln185"> </a>
<a name="ln186">  for (ALL_LIST_ELEMENTS_RO (o-&gt;area_list, i, oa))</a>
<a name="ln187">    {</a>
<a name="ln188">      vty_out (vty, AREA_LSDB_TITLE_FORMAT, VNL, oa-&gt;name, VNL, VNL);</a>
<a name="ln189">      ospf6_lsdb_show (vty, level, NULL, NULL, NULL, oa-&gt;lsdb);</a>
<a name="ln190">    }</a>
<a name="ln191"> </a>
<a name="ln192">  for (ALL_LIST_ELEMENTS_RO (o-&gt;area_list, i, oa))</a>
<a name="ln193">    {</a>
<a name="ln194">      for (ALL_LIST_ELEMENTS_RO (oa-&gt;if_list, j, oi))</a>
<a name="ln195">        {</a>
<a name="ln196">          vty_out (vty, IF_LSDB_TITLE_FORMAT, VNL,</a>
<a name="ln197">                   oi-&gt;interface-&gt;name, oa-&gt;name, VNL, VNL);</a>
<a name="ln198">          ospf6_lsdb_show (vty, level, NULL, NULL, NULL, oi-&gt;lsdb);</a>
<a name="ln199">        }</a>
<a name="ln200">    }</a>
<a name="ln201"> </a>
<a name="ln202">  vty_out (vty, AS_LSDB_TITLE_FORMAT, VNL, VNL, VNL);</a>
<a name="ln203">  ospf6_lsdb_show (vty, level, NULL, NULL, NULL, o-&gt;lsdb);</a>
<a name="ln204"> </a>
<a name="ln205">  vty_out (vty, &quot;%s&quot;, VNL);</a>
<a name="ln206">  return CMD_SUCCESS;</a>
<a name="ln207">}</a>
<a name="ln208"> </a>
<a name="ln209">ALIAS (show_ipv6_ospf6_database,</a>
<a name="ln210">       show_ipv6_ospf6_database_detail_cmd,</a>
<a name="ln211">       &quot;show ipv6 ospf6 database (detail|dump|internal)&quot;,</a>
<a name="ln212">       SHOW_STR</a>
<a name="ln213">       IPV6_STR</a>
<a name="ln214">       OSPF6_STR</a>
<a name="ln215">       &quot;Display Link state database\n&quot;</a>
<a name="ln216">       &quot;Display details of LSAs\n&quot;</a>
<a name="ln217">       &quot;Dump LSAs\n&quot;</a>
<a name="ln218">       &quot;Display LSA's internal information\n&quot;</a>
<a name="ln219">      )</a>
<a name="ln220"> </a>
<a name="ln221">DEFUN (show_ipv6_ospf6_database_type,</a>
<a name="ln222">       show_ipv6_ospf6_database_type_cmd,</a>
<a name="ln223">       &quot;show ipv6 ospf6 database &quot;</a>
<a name="ln224">       &quot;(router|network|inter-prefix|inter-router|as-external|&quot;</a>
<a name="ln225">       &quot;group-membership|type-7|link|intra-prefix)&quot;,</a>
<a name="ln226">       SHOW_STR</a>
<a name="ln227">       IPV6_STR</a>
<a name="ln228">       OSPF6_STR</a>
<a name="ln229">       &quot;Display Link state database\n&quot;</a>
<a name="ln230">       &quot;Display Router LSAs\n&quot;</a>
<a name="ln231">       &quot;Display Network LSAs\n&quot;</a>
<a name="ln232">       &quot;Display Inter-Area-Prefix LSAs\n&quot;</a>
<a name="ln233">       &quot;Display Inter-Area-Router LSAs\n&quot;</a>
<a name="ln234">       &quot;Display As-External LSAs\n&quot;</a>
<a name="ln235">       &quot;Display Group-Membership LSAs\n&quot;</a>
<a name="ln236">       &quot;Display Type-7 LSAs\n&quot;</a>
<a name="ln237">       &quot;Display Link LSAs\n&quot;</a>
<a name="ln238">       &quot;Display Intra-Area-Prefix LSAs\n&quot;</a>
<a name="ln239">      )</a>
<a name="ln240">{</a>
<a name="ln241">  int level;</a>
<a name="ln242">  struct listnode *i, *j;</a>
<a name="ln243">  struct ospf6 *o = ospf6;</a>
<a name="ln244">  struct ospf6_area *oa;</a>
<a name="ln245">  struct ospf6_interface *oi;</a>
<a name="ln246">  u_int16_t type = 0;</a>
<a name="ln247"> </a>
<a name="ln248">  OSPF6_CMD_CHECK_RUNNING ();</a>
<a name="ln249"> </a>
<a name="ln250">  type = parse_type_spec (argc, argv);</a>
<a name="ln251">  argc--;</a>
<a name="ln252">  argv++;</a>
<a name="ln253">  level = parse_show_level (argc, argv);</a>
<a name="ln254"> </a>
<a name="ln255">  switch (OSPF6_LSA_SCOPE (type))</a>
<a name="ln256">    {</a>
<a name="ln257">      case OSPF6_SCOPE_AREA:</a>
<a name="ln258">        for (ALL_LIST_ELEMENTS_RO (o-&gt;area_list, i, oa))</a>
<a name="ln259">          {</a>
<a name="ln260">            vty_out (vty, AREA_LSDB_TITLE_FORMAT, VNL, oa-&gt;name, VNL, VNL);</a>
<a name="ln261">            ospf6_lsdb_show (vty, level, &amp;type, NULL, NULL, oa-&gt;lsdb);</a>
<a name="ln262">          }</a>
<a name="ln263">        break;</a>
<a name="ln264"> </a>
<a name="ln265">      case OSPF6_SCOPE_LINKLOCAL:</a>
<a name="ln266">        for (ALL_LIST_ELEMENTS_RO (o-&gt;area_list, i, oa))</a>
<a name="ln267">          {</a>
<a name="ln268">            for (ALL_LIST_ELEMENTS_RO (oa-&gt;if_list, j, oi))</a>
<a name="ln269">              {</a>
<a name="ln270">                vty_out (vty, IF_LSDB_TITLE_FORMAT, VNL,</a>
<a name="ln271">                         oi-&gt;interface-&gt;name, oa-&gt;name, VNL, VNL);</a>
<a name="ln272">                ospf6_lsdb_show (vty, level, &amp;type, NULL, NULL, oi-&gt;lsdb);</a>
<a name="ln273">              }</a>
<a name="ln274">          }</a>
<a name="ln275">        break;</a>
<a name="ln276"> </a>
<a name="ln277">      case OSPF6_SCOPE_AS:</a>
<a name="ln278">        vty_out (vty, AS_LSDB_TITLE_FORMAT, VNL, VNL, VNL);</a>
<a name="ln279">        ospf6_lsdb_show (vty, level, &amp;type, NULL, NULL, o-&gt;lsdb);</a>
<a name="ln280">        break;</a>
<a name="ln281"> </a>
<a name="ln282">      default:</a>
<a name="ln283">        assert (0);</a>
<a name="ln284">        break;</a>
<a name="ln285">    }</a>
<a name="ln286"> </a>
<a name="ln287">  vty_out (vty, &quot;%s&quot;, VNL);</a>
<a name="ln288">  return CMD_SUCCESS;</a>
<a name="ln289">}</a>
<a name="ln290"> </a>
<a name="ln291">ALIAS (show_ipv6_ospf6_database_type,</a>
<a name="ln292">       show_ipv6_ospf6_database_type_detail_cmd,</a>
<a name="ln293">       &quot;show ipv6 ospf6 database &quot;</a>
<a name="ln294">       &quot;(router|network|inter-prefix|inter-router|as-external|&quot;</a>
<a name="ln295">       &quot;group-membership|type-7|link|intra-prefix) &quot;</a>
<a name="ln296">       &quot;(detail|dump|internal)&quot;,</a>
<a name="ln297">       SHOW_STR</a>
<a name="ln298">       IPV6_STR</a>
<a name="ln299">       OSPF6_STR</a>
<a name="ln300">       &quot;Display Link state database\n&quot;</a>
<a name="ln301">       &quot;Display Router LSAs\n&quot;</a>
<a name="ln302">       &quot;Display Network LSAs\n&quot;</a>
<a name="ln303">       &quot;Display Inter-Area-Prefix LSAs\n&quot;</a>
<a name="ln304">       &quot;Display Inter-Area-Router LSAs\n&quot;</a>
<a name="ln305">       &quot;Display As-External LSAs\n&quot;</a>
<a name="ln306">       &quot;Display Group-Membership LSAs\n&quot;</a>
<a name="ln307">       &quot;Display Type-7 LSAs\n&quot;</a>
<a name="ln308">       &quot;Display Link LSAs\n&quot;</a>
<a name="ln309">       &quot;Display Intra-Area-Prefix LSAs\n&quot;</a>
<a name="ln310">       &quot;Display details of LSAs\n&quot;</a>
<a name="ln311">       &quot;Dump LSAs\n&quot;</a>
<a name="ln312">       &quot;Display LSA's internal information\n&quot;</a>
<a name="ln313">      )</a>
<a name="ln314"> </a>
<a name="ln315">DEFUN (show_ipv6_ospf6_database_id,</a>
<a name="ln316">       show_ipv6_ospf6_database_id_cmd,</a>
<a name="ln317">       &quot;show ipv6 ospf6 database * A.B.C.D&quot;,</a>
<a name="ln318">       SHOW_STR</a>
<a name="ln319">       IPV6_STR</a>
<a name="ln320">       OSPF6_STR</a>
<a name="ln321">       &quot;Display Link state database\n&quot;</a>
<a name="ln322">       &quot;Any Link state Type\n&quot;</a>
<a name="ln323">       &quot;Specify Link state ID as IPv4 address notation\n&quot;</a>
<a name="ln324">      )</a>
<a name="ln325">{</a>
<a name="ln326">  int level;</a>
<a name="ln327">  struct listnode *i, *j;</a>
<a name="ln328">  struct ospf6 *o = ospf6;</a>
<a name="ln329">  struct ospf6_area *oa;</a>
<a name="ln330">  struct ospf6_interface *oi;</a>
<a name="ln331">  u_int32_t id = 0;</a>
<a name="ln332"> </a>
<a name="ln333">  OSPF6_CMD_CHECK_RUNNING ();</a>
<a name="ln334"> </a>
<a name="ln335">  if ((inet_pton (AF_INET, argv[0], &amp;id)) != 1)</a>
<a name="ln336">    {</a>
<a name="ln337">      vty_out (vty, &quot;Link State ID is not parsable: %s%s&quot;,</a>
<a name="ln338">               argv[0], VNL);</a>
<a name="ln339">      return CMD_SUCCESS;</a>
<a name="ln340">    }</a>
<a name="ln341"> </a>
<a name="ln342">  argc--;</a>
<a name="ln343">  argv++;</a>
<a name="ln344">  level = parse_show_level (argc, argv);</a>
<a name="ln345"> </a>
<a name="ln346">  for (ALL_LIST_ELEMENTS_RO (o-&gt;area_list, i, oa))</a>
<a name="ln347">    {</a>
<a name="ln348">      vty_out (vty, AREA_LSDB_TITLE_FORMAT, VNL, oa-&gt;name, VNL, VNL);</a>
<a name="ln349">      ospf6_lsdb_show (vty, level, NULL, &amp;id, NULL, oa-&gt;lsdb);</a>
<a name="ln350">    }</a>
<a name="ln351"> </a>
<a name="ln352">  for (ALL_LIST_ELEMENTS_RO (o-&gt;area_list, i, oa))</a>
<a name="ln353">    {</a>
<a name="ln354">      for (ALL_LIST_ELEMENTS_RO (oa-&gt;if_list, j, oi))</a>
<a name="ln355">        {</a>
<a name="ln356">          vty_out (vty, IF_LSDB_TITLE_FORMAT, VNL,</a>
<a name="ln357">                   oi-&gt;interface-&gt;name, oa-&gt;name, VNL, VNL);</a>
<a name="ln358">          ospf6_lsdb_show (vty, level, NULL, &amp;id, NULL, oi-&gt;lsdb);</a>
<a name="ln359">        }</a>
<a name="ln360">    }</a>
<a name="ln361"> </a>
<a name="ln362">  vty_out (vty, AS_LSDB_TITLE_FORMAT, VNL, VNL, VNL);</a>
<a name="ln363">  ospf6_lsdb_show (vty, level, NULL, &amp;id, NULL, o-&gt;lsdb);</a>
<a name="ln364"> </a>
<a name="ln365">  vty_out (vty, &quot;%s&quot;, VNL);</a>
<a name="ln366">  return CMD_SUCCESS;</a>
<a name="ln367">}</a>
<a name="ln368"> </a>
<a name="ln369">ALIAS (show_ipv6_ospf6_database_id,</a>
<a name="ln370">       show_ipv6_ospf6_database_id_detail_cmd,</a>
<a name="ln371">       &quot;show ipv6 ospf6 database * A.B.C.D &quot;</a>
<a name="ln372">       &quot;(detail|dump|internal)&quot;,</a>
<a name="ln373">       SHOW_STR</a>
<a name="ln374">       IPV6_STR</a>
<a name="ln375">       OSPF6_STR</a>
<a name="ln376">       &quot;Display Link state database\n&quot;</a>
<a name="ln377">       &quot;Any Link state Type\n&quot;</a>
<a name="ln378">       &quot;Specify Link state ID as IPv4 address notation\n&quot;</a>
<a name="ln379">       &quot;Display details of LSAs\n&quot;</a>
<a name="ln380">       &quot;Dump LSAs\n&quot;</a>
<a name="ln381">       &quot;Display LSA's internal information\n&quot;</a>
<a name="ln382">      )</a>
<a name="ln383"> </a>
<a name="ln384">ALIAS (show_ipv6_ospf6_database_id,</a>
<a name="ln385">       show_ipv6_ospf6_database_linkstate_id_cmd,</a>
<a name="ln386">       &quot;show ipv6 ospf6 database linkstate-id A.B.C.D&quot;,</a>
<a name="ln387">       SHOW_STR</a>
<a name="ln388">       IPV6_STR</a>
<a name="ln389">       OSPF6_STR</a>
<a name="ln390">       &quot;Display Link state database\n&quot;</a>
<a name="ln391">       &quot;Search by Link state ID\n&quot;</a>
<a name="ln392">       &quot;Specify Link state ID as IPv4 address notation\n&quot;</a>
<a name="ln393">      )</a>
<a name="ln394"> </a>
<a name="ln395">ALIAS (show_ipv6_ospf6_database_id,</a>
<a name="ln396">       show_ipv6_ospf6_database_linkstate_id_detail_cmd,</a>
<a name="ln397">       &quot;show ipv6 ospf6 database linkstate-id A.B.C.D &quot;</a>
<a name="ln398">       &quot;(detail|dump|internal)&quot;,</a>
<a name="ln399">       SHOW_STR</a>
<a name="ln400">       IPV6_STR</a>
<a name="ln401">       OSPF6_STR</a>
<a name="ln402">       &quot;Display Link state database\n&quot;</a>
<a name="ln403">       &quot;Search by Link state ID\n&quot;</a>
<a name="ln404">       &quot;Specify Link state ID as IPv4 address notation\n&quot;</a>
<a name="ln405">       &quot;Display details of LSAs\n&quot;</a>
<a name="ln406">       &quot;Dump LSAs\n&quot;</a>
<a name="ln407">       &quot;Display LSA's internal information\n&quot;</a>
<a name="ln408">      )</a>
<a name="ln409"> </a>
<a name="ln410">DEFUN (show_ipv6_ospf6_database_router,</a>
<a name="ln411">       show_ipv6_ospf6_database_router_cmd,</a>
<a name="ln412">       &quot;show ipv6 ospf6 database * * A.B.C.D&quot;,</a>
<a name="ln413">       SHOW_STR</a>
<a name="ln414">       IPV6_STR</a>
<a name="ln415">       OSPF6_STR</a>
<a name="ln416">       &quot;Display Link state database\n&quot;</a>
<a name="ln417">       &quot;Any Link state Type\n&quot;</a>
<a name="ln418">       &quot;Any Link state ID\n&quot;</a>
<a name="ln419">       &quot;Specify Advertising Router as IPv4 address notation\n&quot;</a>
<a name="ln420">      )</a>
<a name="ln421">{</a>
<a name="ln422">  int level;</a>
<a name="ln423">  struct listnode *i, *j;</a>
<a name="ln424">  struct ospf6 *o = ospf6;</a>
<a name="ln425">  struct ospf6_area *oa;</a>
<a name="ln426">  struct ospf6_interface *oi;</a>
<a name="ln427">  u_int32_t adv_router = 0;</a>
<a name="ln428"> </a>
<a name="ln429">  OSPF6_CMD_CHECK_RUNNING ();</a>
<a name="ln430"> </a>
<a name="ln431">  if ((inet_pton (AF_INET, argv[0], &amp;adv_router)) != 1)</a>
<a name="ln432">    {</a>
<a name="ln433">      vty_out (vty, &quot;Advertising Router is not parsable: %s%s&quot;,</a>
<a name="ln434">               argv[0], VNL);</a>
<a name="ln435">      return CMD_SUCCESS;</a>
<a name="ln436">    }</a>
<a name="ln437"> </a>
<a name="ln438">  argc--;</a>
<a name="ln439">  argv++;</a>
<a name="ln440">  level = parse_show_level (argc, argv);</a>
<a name="ln441"> </a>
<a name="ln442">  for (ALL_LIST_ELEMENTS_RO (o-&gt;area_list, i, oa))</a>
<a name="ln443">    {</a>
<a name="ln444">      vty_out (vty, AREA_LSDB_TITLE_FORMAT, VNL, oa-&gt;name, VNL, VNL);</a>
<a name="ln445">      ospf6_lsdb_show (vty, level, NULL, NULL, &amp;adv_router, oa-&gt;lsdb);</a>
<a name="ln446">    }</a>
<a name="ln447"> </a>
<a name="ln448">  for (ALL_LIST_ELEMENTS_RO (o-&gt;area_list, i, oa))</a>
<a name="ln449">    {</a>
<a name="ln450">      for (ALL_LIST_ELEMENTS_RO (oa-&gt;if_list, j, oi))</a>
<a name="ln451">        {</a>
<a name="ln452">          vty_out (vty, IF_LSDB_TITLE_FORMAT, VNL,</a>
<a name="ln453">                   oi-&gt;interface-&gt;name, oa-&gt;name, VNL, VNL);</a>
<a name="ln454">          ospf6_lsdb_show (vty, level, NULL, NULL, &amp;adv_router, oi-&gt;lsdb);</a>
<a name="ln455">        }</a>
<a name="ln456">    }</a>
<a name="ln457"> </a>
<a name="ln458">  vty_out (vty, AS_LSDB_TITLE_FORMAT, VNL, VNL, VNL);</a>
<a name="ln459">  ospf6_lsdb_show (vty, level, NULL, NULL, &amp;adv_router, o-&gt;lsdb);</a>
<a name="ln460"> </a>
<a name="ln461">  vty_out (vty, &quot;%s&quot;, VNL);</a>
<a name="ln462">  return CMD_SUCCESS;</a>
<a name="ln463">}</a>
<a name="ln464"> </a>
<a name="ln465">ALIAS (show_ipv6_ospf6_database_router,</a>
<a name="ln466">       show_ipv6_ospf6_database_router_detail_cmd,</a>
<a name="ln467">       &quot;show ipv6 ospf6 database * * A.B.C.D &quot;</a>
<a name="ln468">       &quot;(detail|dump|internal)&quot;,</a>
<a name="ln469">       SHOW_STR</a>
<a name="ln470">       IPV6_STR</a>
<a name="ln471">       OSPF6_STR</a>
<a name="ln472">       &quot;Display Link state database\n&quot;</a>
<a name="ln473">       &quot;Any Link state Type\n&quot;</a>
<a name="ln474">       &quot;Any Link state ID\n&quot;</a>
<a name="ln475">       &quot;Specify Advertising Router as IPv4 address notation\n&quot;</a>
<a name="ln476">       &quot;Display details of LSAs\n&quot;</a>
<a name="ln477">       &quot;Dump LSAs\n&quot;</a>
<a name="ln478">       &quot;Display LSA's internal information\n&quot;</a>
<a name="ln479">      )</a>
<a name="ln480"> </a>
<a name="ln481">ALIAS (show_ipv6_ospf6_database_router,</a>
<a name="ln482">       show_ipv6_ospf6_database_adv_router_cmd,</a>
<a name="ln483">       &quot;show ipv6 ospf6 database adv-router A.B.C.D&quot;,</a>
<a name="ln484">       SHOW_STR</a>
<a name="ln485">       IPV6_STR</a>
<a name="ln486">       OSPF6_STR</a>
<a name="ln487">       &quot;Display Link state database\n&quot;</a>
<a name="ln488">       &quot;Search by Advertising Router\n&quot;</a>
<a name="ln489">       &quot;Specify Advertising Router as IPv4 address notation\n&quot;</a>
<a name="ln490">      )</a>
<a name="ln491"> </a>
<a name="ln492">ALIAS (show_ipv6_ospf6_database_router,</a>
<a name="ln493">       show_ipv6_ospf6_database_adv_router_detail_cmd,</a>
<a name="ln494">       &quot;show ipv6 ospf6 database adv-router A.B.C.D &quot;</a>
<a name="ln495">       &quot;(detail|dump|internal)&quot;,</a>
<a name="ln496">       SHOW_STR</a>
<a name="ln497">       IPV6_STR</a>
<a name="ln498">       OSPF6_STR</a>
<a name="ln499">       &quot;Display Link state database\n&quot;</a>
<a name="ln500">       &quot;Search by Advertising Router\n&quot;</a>
<a name="ln501">       &quot;Specify Advertising Router as IPv4 address notation\n&quot;</a>
<a name="ln502">       &quot;Display details of LSAs\n&quot;</a>
<a name="ln503">       &quot;Dump LSAs\n&quot;</a>
<a name="ln504">       &quot;Display LSA's internal information\n&quot;</a>
<a name="ln505">      )</a>
<a name="ln506"> </a>
<a name="ln507">DEFUN (show_ipv6_ospf6_database_type_id,</a>
<a name="ln508">       show_ipv6_ospf6_database_type_id_cmd,</a>
<a name="ln509">       &quot;show ipv6 ospf6 database &quot;</a>
<a name="ln510">       &quot;(router|network|inter-prefix|inter-router|as-external|&quot;</a>
<a name="ln511">       &quot;group-membership|type-7|link|intra-prefix) A.B.C.D&quot;,</a>
<a name="ln512">       SHOW_STR</a>
<a name="ln513">       IPV6_STR</a>
<a name="ln514">       OSPF6_STR</a>
<a name="ln515">       &quot;Display Link state database\n&quot;</a>
<a name="ln516">       &quot;Display Router LSAs\n&quot;</a>
<a name="ln517">       &quot;Display Network LSAs\n&quot;</a>
<a name="ln518">       &quot;Display Inter-Area-Prefix LSAs\n&quot;</a>
<a name="ln519">       &quot;Display Inter-Area-Router LSAs\n&quot;</a>
<a name="ln520">       &quot;Display As-External LSAs\n&quot;</a>
<a name="ln521">       &quot;Display Group-Membership LSAs\n&quot;</a>
<a name="ln522">       &quot;Display Type-7 LSAs\n&quot;</a>
<a name="ln523">       &quot;Display Link LSAs\n&quot;</a>
<a name="ln524">       &quot;Display Intra-Area-Prefix LSAs\n&quot;</a>
<a name="ln525">       &quot;Specify Link state ID as IPv4 address notation\n&quot;</a>
<a name="ln526">      )</a>
<a name="ln527">{</a>
<a name="ln528">  int level;</a>
<a name="ln529">  struct listnode *i, *j;</a>
<a name="ln530">  struct ospf6 *o = ospf6;</a>
<a name="ln531">  struct ospf6_area *oa;</a>
<a name="ln532">  struct ospf6_interface *oi;</a>
<a name="ln533">  u_int16_t type = 0;</a>
<a name="ln534">  u_int32_t id = 0;</a>
<a name="ln535"> </a>
<a name="ln536">  OSPF6_CMD_CHECK_RUNNING ();</a>
<a name="ln537"> </a>
<a name="ln538">  type = parse_type_spec (argc, argv);</a>
<a name="ln539">  argc--;</a>
<a name="ln540">  argv++;</a>
<a name="ln541"> </a>
<a name="ln542">  if ((inet_pton (AF_INET, argv[0], &amp;id)) != 1)</a>
<a name="ln543">    {</a>
<a name="ln544">      vty_out (vty, &quot;Link state ID is not parsable: %s%s&quot;,</a>
<a name="ln545">               argv[0], VNL);</a>
<a name="ln546">      return CMD_SUCCESS;</a>
<a name="ln547">    }</a>
<a name="ln548"> </a>
<a name="ln549">  argc--;</a>
<a name="ln550">  argv++;</a>
<a name="ln551">  level = parse_show_level (argc, argv);</a>
<a name="ln552"> </a>
<a name="ln553">  switch (OSPF6_LSA_SCOPE (type))</a>
<a name="ln554">    {</a>
<a name="ln555">      case OSPF6_SCOPE_AREA:</a>
<a name="ln556">        for (ALL_LIST_ELEMENTS_RO (o-&gt;area_list, i, oa))</a>
<a name="ln557">          {</a>
<a name="ln558">            vty_out (vty, AREA_LSDB_TITLE_FORMAT, VNL, oa-&gt;name, VNL, VNL);</a>
<a name="ln559">            ospf6_lsdb_show (vty, level, &amp;type, &amp;id, NULL, oa-&gt;lsdb);</a>
<a name="ln560">          }</a>
<a name="ln561">        break;</a>
<a name="ln562"> </a>
<a name="ln563">      case OSPF6_SCOPE_LINKLOCAL:</a>
<a name="ln564">        for (ALL_LIST_ELEMENTS_RO (o-&gt;area_list, i, oa))</a>
<a name="ln565">          {</a>
<a name="ln566">            for (ALL_LIST_ELEMENTS_RO (oa-&gt;if_list, j, oi))</a>
<a name="ln567">              {</a>
<a name="ln568">                vty_out (vty, IF_LSDB_TITLE_FORMAT, VNL,</a>
<a name="ln569">                         oi-&gt;interface-&gt;name, oa-&gt;name, VNL, VNL);</a>
<a name="ln570">                ospf6_lsdb_show (vty, level, &amp;type, &amp;id, NULL, oi-&gt;lsdb);</a>
<a name="ln571">              }</a>
<a name="ln572">          }</a>
<a name="ln573">        break;</a>
<a name="ln574"> </a>
<a name="ln575">      case OSPF6_SCOPE_AS:</a>
<a name="ln576">        vty_out (vty, AS_LSDB_TITLE_FORMAT, VNL, VNL, VNL);</a>
<a name="ln577">        ospf6_lsdb_show (vty, level, &amp;type, &amp;id, NULL, o-&gt;lsdb);</a>
<a name="ln578">        break;</a>
<a name="ln579"> </a>
<a name="ln580">      default:</a>
<a name="ln581">        assert (0);</a>
<a name="ln582">        break;</a>
<a name="ln583">    }</a>
<a name="ln584"> </a>
<a name="ln585">  vty_out (vty, &quot;%s&quot;, VNL);</a>
<a name="ln586">  return CMD_SUCCESS;</a>
<a name="ln587">}</a>
<a name="ln588"> </a>
<a name="ln589">ALIAS (show_ipv6_ospf6_database_type_id,</a>
<a name="ln590">       show_ipv6_ospf6_database_type_id_detail_cmd,</a>
<a name="ln591">       &quot;show ipv6 ospf6 database &quot;</a>
<a name="ln592">       &quot;(router|network|inter-prefix|inter-router|as-external|&quot;</a>
<a name="ln593">       &quot;group-membership|type-7|link|intra-prefix) A.B.C.D &quot;</a>
<a name="ln594">       &quot;(detail|dump|internal)&quot;,</a>
<a name="ln595">       SHOW_STR</a>
<a name="ln596">       IPV6_STR</a>
<a name="ln597">       OSPF6_STR</a>
<a name="ln598">       &quot;Display Link state database\n&quot;</a>
<a name="ln599">       &quot;Display Router LSAs\n&quot;</a>
<a name="ln600">       &quot;Display Network LSAs\n&quot;</a>
<a name="ln601">       &quot;Display Inter-Area-Prefix LSAs\n&quot;</a>
<a name="ln602">       &quot;Display Inter-Area-Router LSAs\n&quot;</a>
<a name="ln603">       &quot;Display As-External LSAs\n&quot;</a>
<a name="ln604">       &quot;Display Group-Membership LSAs\n&quot;</a>
<a name="ln605">       &quot;Display Type-7 LSAs\n&quot;</a>
<a name="ln606">       &quot;Display Link LSAs\n&quot;</a>
<a name="ln607">       &quot;Display Intra-Area-Prefix LSAs\n&quot;</a>
<a name="ln608">       &quot;Specify Link state ID as IPv4 address notation\n&quot;</a>
<a name="ln609">       &quot;Display details of LSAs\n&quot;</a>
<a name="ln610">       &quot;Dump LSAs\n&quot;</a>
<a name="ln611">       &quot;Display LSA's internal information\n&quot;</a>
<a name="ln612">      )</a>
<a name="ln613"> </a>
<a name="ln614">ALIAS (show_ipv6_ospf6_database_type_id,</a>
<a name="ln615">       show_ipv6_ospf6_database_type_linkstate_id_cmd,</a>
<a name="ln616">       &quot;show ipv6 ospf6 database &quot;</a>
<a name="ln617">       &quot;(router|network|inter-prefix|inter-router|as-external|&quot;</a>
<a name="ln618">       &quot;group-membership|type-7|link|intra-prefix) linkstate-id A.B.C.D&quot;,</a>
<a name="ln619">       SHOW_STR</a>
<a name="ln620">       IPV6_STR</a>
<a name="ln621">       OSPF6_STR</a>
<a name="ln622">       &quot;Display Link state database\n&quot;</a>
<a name="ln623">       &quot;Display Router LSAs\n&quot;</a>
<a name="ln624">       &quot;Display Network LSAs\n&quot;</a>
<a name="ln625">       &quot;Display Inter-Area-Prefix LSAs\n&quot;</a>
<a name="ln626">       &quot;Display Inter-Area-Router LSAs\n&quot;</a>
<a name="ln627">       &quot;Display As-External LSAs\n&quot;</a>
<a name="ln628">       &quot;Display Group-Membership LSAs\n&quot;</a>
<a name="ln629">       &quot;Display Type-7 LSAs\n&quot;</a>
<a name="ln630">       &quot;Display Link LSAs\n&quot;</a>
<a name="ln631">       &quot;Display Intra-Area-Prefix LSAs\n&quot;</a>
<a name="ln632">       &quot;Search by Link state ID\n&quot;</a>
<a name="ln633">       &quot;Specify Link state ID as IPv4 address notation\n&quot;</a>
<a name="ln634">      )</a>
<a name="ln635"> </a>
<a name="ln636">ALIAS (show_ipv6_ospf6_database_type_id,</a>
<a name="ln637">       show_ipv6_ospf6_database_type_linkstate_id_detail_cmd,</a>
<a name="ln638">       &quot;show ipv6 ospf6 database &quot;</a>
<a name="ln639">       &quot;(router|network|inter-prefix|inter-router|as-external|&quot;</a>
<a name="ln640">       &quot;group-membership|type-7|link|intra-prefix) linkstate-id A.B.C.D &quot;</a>
<a name="ln641">       &quot;(detail|dump|internal)&quot;,</a>
<a name="ln642">       SHOW_STR</a>
<a name="ln643">       IPV6_STR</a>
<a name="ln644">       OSPF6_STR</a>
<a name="ln645">       &quot;Display Link state database\n&quot;</a>
<a name="ln646">       &quot;Display Router LSAs\n&quot;</a>
<a name="ln647">       &quot;Display Network LSAs\n&quot;</a>
<a name="ln648">       &quot;Display Inter-Area-Prefix LSAs\n&quot;</a>
<a name="ln649">       &quot;Display Inter-Area-Router LSAs\n&quot;</a>
<a name="ln650">       &quot;Display As-External LSAs\n&quot;</a>
<a name="ln651">       &quot;Display Group-Membership LSAs\n&quot;</a>
<a name="ln652">       &quot;Display Type-7 LSAs\n&quot;</a>
<a name="ln653">       &quot;Display Link LSAs\n&quot;</a>
<a name="ln654">       &quot;Display Intra-Area-Prefix LSAs\n&quot;</a>
<a name="ln655">       &quot;Search by Link state ID\n&quot;</a>
<a name="ln656">       &quot;Specify Link state ID as IPv4 address notation\n&quot;</a>
<a name="ln657">       &quot;Display details of LSAs\n&quot;</a>
<a name="ln658">       &quot;Dump LSAs\n&quot;</a>
<a name="ln659">       &quot;Display LSA's internal information\n&quot;</a>
<a name="ln660">      )</a>
<a name="ln661"> </a>
<a name="ln662">DEFUN (show_ipv6_ospf6_database_type_router,</a>
<a name="ln663">       show_ipv6_ospf6_database_type_router_cmd,</a>
<a name="ln664">       &quot;show ipv6 ospf6 database &quot;</a>
<a name="ln665">       &quot;(router|network|inter-prefix|inter-router|as-external|&quot;</a>
<a name="ln666">       &quot;group-membership|type-7|link|intra-prefix) * A.B.C.D&quot;,</a>
<a name="ln667">       SHOW_STR</a>
<a name="ln668">       IPV6_STR</a>
<a name="ln669">       OSPF6_STR</a>
<a name="ln670">       &quot;Display Link state database\n&quot;</a>
<a name="ln671">       &quot;Display Router LSAs\n&quot;</a>
<a name="ln672">       &quot;Display Network LSAs\n&quot;</a>
<a name="ln673">       &quot;Display Inter-Area-Prefix LSAs\n&quot;</a>
<a name="ln674">       &quot;Display Inter-Area-Router LSAs\n&quot;</a>
<a name="ln675">       &quot;Display As-External LSAs\n&quot;</a>
<a name="ln676">       &quot;Display Group-Membership LSAs\n&quot;</a>
<a name="ln677">       &quot;Display Type-7 LSAs\n&quot;</a>
<a name="ln678">       &quot;Display Link LSAs\n&quot;</a>
<a name="ln679">       &quot;Display Intra-Area-Prefix LSAs\n&quot;</a>
<a name="ln680">       &quot;Any Link state ID\n&quot;</a>
<a name="ln681">       &quot;Specify Advertising Router as IPv4 address notation\n&quot;</a>
<a name="ln682">      )</a>
<a name="ln683">{</a>
<a name="ln684">  int level;</a>
<a name="ln685">  struct listnode *i, *j;</a>
<a name="ln686">  struct ospf6 *o = ospf6;</a>
<a name="ln687">  struct ospf6_area *oa;</a>
<a name="ln688">  struct ospf6_interface *oi;</a>
<a name="ln689">  u_int16_t type = 0;</a>
<a name="ln690">  u_int32_t adv_router = 0;</a>
<a name="ln691"> </a>
<a name="ln692">  OSPF6_CMD_CHECK_RUNNING ();</a>
<a name="ln693"> </a>
<a name="ln694">  type = parse_type_spec (argc, argv);</a>
<a name="ln695">  argc--;</a>
<a name="ln696">  argv++;</a>
<a name="ln697"> </a>
<a name="ln698">  if ((inet_pton (AF_INET, argv[0], &amp;adv_router)) != 1)</a>
<a name="ln699">    {</a>
<a name="ln700">      vty_out (vty, &quot;Advertising Router is not parsable: %s%s&quot;,</a>
<a name="ln701">               argv[0], VNL);</a>
<a name="ln702">      return CMD_SUCCESS;</a>
<a name="ln703">    }</a>
<a name="ln704"> </a>
<a name="ln705">  argc--;</a>
<a name="ln706">  argv++;</a>
<a name="ln707">  level = parse_show_level (argc, argv);</a>
<a name="ln708"> </a>
<a name="ln709">  switch (OSPF6_LSA_SCOPE (type))</a>
<a name="ln710">    {</a>
<a name="ln711">      case OSPF6_SCOPE_AREA:</a>
<a name="ln712">        for (ALL_LIST_ELEMENTS_RO (o-&gt;area_list, i, oa))</a>
<a name="ln713">          {</a>
<a name="ln714">            vty_out (vty, AREA_LSDB_TITLE_FORMAT, VNL, oa-&gt;name, VNL, VNL);</a>
<a name="ln715">            ospf6_lsdb_show (vty, level, &amp;type, NULL, &amp;adv_router, oa-&gt;lsdb);</a>
<a name="ln716">          }</a>
<a name="ln717">        break;</a>
<a name="ln718"> </a>
<a name="ln719">      case OSPF6_SCOPE_LINKLOCAL:</a>
<a name="ln720">        for (ALL_LIST_ELEMENTS_RO (o-&gt;area_list, i, oa))</a>
<a name="ln721">          {</a>
<a name="ln722">            for (ALL_LIST_ELEMENTS_RO (oa-&gt;if_list, j, oi))</a>
<a name="ln723">              {</a>
<a name="ln724">                vty_out (vty, IF_LSDB_TITLE_FORMAT, VNL,</a>
<a name="ln725">                         oi-&gt;interface-&gt;name, oa-&gt;name, VNL, VNL);</a>
<a name="ln726">                ospf6_lsdb_show (vty, level, &amp;type, NULL, &amp;adv_router, oi-&gt;lsdb);</a>
<a name="ln727">              }</a>
<a name="ln728">          }</a>
<a name="ln729">        break;</a>
<a name="ln730"> </a>
<a name="ln731">      case OSPF6_SCOPE_AS:</a>
<a name="ln732">        vty_out (vty, AS_LSDB_TITLE_FORMAT, VNL, VNL, VNL);</a>
<a name="ln733">        ospf6_lsdb_show (vty, level, &amp;type, NULL, &amp;adv_router, o-&gt;lsdb);</a>
<a name="ln734">        break;</a>
<a name="ln735"> </a>
<a name="ln736">      default:</a>
<a name="ln737">        assert (0);</a>
<a name="ln738">        break;</a>
<a name="ln739">    }</a>
<a name="ln740"> </a>
<a name="ln741">  vty_out (vty, &quot;%s&quot;, VNL);</a>
<a name="ln742">  return CMD_SUCCESS;</a>
<a name="ln743">}</a>
<a name="ln744"> </a>
<a name="ln745">ALIAS (show_ipv6_ospf6_database_type_router,</a>
<a name="ln746">       show_ipv6_ospf6_database_type_router_detail_cmd,</a>
<a name="ln747">       &quot;show ipv6 ospf6 database &quot;</a>
<a name="ln748">       &quot;(router|network|inter-prefix|inter-router|as-external|&quot;</a>
<a name="ln749">       &quot;group-membership|type-7|link|intra-prefix) * A.B.C.D &quot;</a>
<a name="ln750">       &quot;(detail|dump|internal)&quot;,</a>
<a name="ln751">       SHOW_STR</a>
<a name="ln752">       IPV6_STR</a>
<a name="ln753">       OSPF6_STR</a>
<a name="ln754">       &quot;Display Link state database\n&quot;</a>
<a name="ln755">       &quot;Display Router LSAs\n&quot;</a>
<a name="ln756">       &quot;Display Network LSAs\n&quot;</a>
<a name="ln757">       &quot;Display Inter-Area-Prefix LSAs\n&quot;</a>
<a name="ln758">       &quot;Display Inter-Area-Router LSAs\n&quot;</a>
<a name="ln759">       &quot;Display As-External LSAs\n&quot;</a>
<a name="ln760">       &quot;Display Group-Membership LSAs\n&quot;</a>
<a name="ln761">       &quot;Display Type-7 LSAs\n&quot;</a>
<a name="ln762">       &quot;Display Link LSAs\n&quot;</a>
<a name="ln763">       &quot;Display Intra-Area-Prefix LSAs\n&quot;</a>
<a name="ln764">       &quot;Any Link state ID\n&quot;</a>
<a name="ln765">       &quot;Specify Advertising Router as IPv4 address notation\n&quot;</a>
<a name="ln766">       &quot;Display details of LSAs\n&quot;</a>
<a name="ln767">       &quot;Dump LSAs\n&quot;</a>
<a name="ln768">       &quot;Display LSA's internal information\n&quot;</a>
<a name="ln769">      )</a>
<a name="ln770"> </a>
<a name="ln771">ALIAS (show_ipv6_ospf6_database_type_router,</a>
<a name="ln772">       show_ipv6_ospf6_database_type_adv_router_cmd,</a>
<a name="ln773">       &quot;show ipv6 ospf6 database &quot;</a>
<a name="ln774">       &quot;(router|network|inter-prefix|inter-router|as-external|&quot;</a>
<a name="ln775">       &quot;group-membership|type-7|link|intra-prefix) adv-router A.B.C.D&quot;,</a>
<a name="ln776">       SHOW_STR</a>
<a name="ln777">       IPV6_STR</a>
<a name="ln778">       OSPF6_STR</a>
<a name="ln779">       &quot;Display Link state database\n&quot;</a>
<a name="ln780">       &quot;Display Router LSAs\n&quot;</a>
<a name="ln781">       &quot;Display Network LSAs\n&quot;</a>
<a name="ln782">       &quot;Display Inter-Area-Prefix LSAs\n&quot;</a>
<a name="ln783">       &quot;Display Inter-Area-Router LSAs\n&quot;</a>
<a name="ln784">       &quot;Display As-External LSAs\n&quot;</a>
<a name="ln785">       &quot;Display Group-Membership LSAs\n&quot;</a>
<a name="ln786">       &quot;Display Type-7 LSAs\n&quot;</a>
<a name="ln787">       &quot;Display Link LSAs\n&quot;</a>
<a name="ln788">       &quot;Display Intra-Area-Prefix LSAs\n&quot;</a>
<a name="ln789">       &quot;Search by Advertising Router\n&quot;</a>
<a name="ln790">       &quot;Specify Advertising Router as IPv4 address notation\n&quot;</a>
<a name="ln791">      )</a>
<a name="ln792"> </a>
<a name="ln793">ALIAS (show_ipv6_ospf6_database_type_router,</a>
<a name="ln794">       show_ipv6_ospf6_database_type_adv_router_detail_cmd,</a>
<a name="ln795">       &quot;show ipv6 ospf6 database &quot;</a>
<a name="ln796">       &quot;(router|network|inter-prefix|inter-router|as-external|&quot;</a>
<a name="ln797">       &quot;group-membership|type-7|link|intra-prefix) adv-router A.B.C.D &quot;</a>
<a name="ln798">       &quot;(detail|dump|internal)&quot;,</a>
<a name="ln799">       SHOW_STR</a>
<a name="ln800">       IPV6_STR</a>
<a name="ln801">       OSPF6_STR</a>
<a name="ln802">       &quot;Display Link state database\n&quot;</a>
<a name="ln803">       &quot;Display Router LSAs\n&quot;</a>
<a name="ln804">       &quot;Display Network LSAs\n&quot;</a>
<a name="ln805">       &quot;Display Inter-Area-Prefix LSAs\n&quot;</a>
<a name="ln806">       &quot;Display Inter-Area-Router LSAs\n&quot;</a>
<a name="ln807">       &quot;Display As-External LSAs\n&quot;</a>
<a name="ln808">       &quot;Display Group-Membership LSAs\n&quot;</a>
<a name="ln809">       &quot;Display Type-7 LSAs\n&quot;</a>
<a name="ln810">       &quot;Display Link LSAs\n&quot;</a>
<a name="ln811">       &quot;Display Intra-Area-Prefix LSAs\n&quot;</a>
<a name="ln812">       &quot;Search by Advertising Router\n&quot;</a>
<a name="ln813">       &quot;Specify Advertising Router as IPv4 address notation\n&quot;</a>
<a name="ln814">       &quot;Display details of LSAs\n&quot;</a>
<a name="ln815">       &quot;Dump LSAs\n&quot;</a>
<a name="ln816">       &quot;Display LSA's internal information\n&quot;</a>
<a name="ln817">      )</a>
<a name="ln818"> </a>
<a name="ln819">DEFUN (show_ipv6_ospf6_database_id_router,</a>
<a name="ln820">       show_ipv6_ospf6_database_id_router_cmd,</a>
<a name="ln821">       &quot;show ipv6 ospf6 database * A.B.C.D A.B.C.D&quot;,</a>
<a name="ln822">       SHOW_STR</a>
<a name="ln823">       IPV6_STR</a>
<a name="ln824">       OSPF6_STR</a>
<a name="ln825">       &quot;Display Link state database\n&quot;</a>
<a name="ln826">       &quot;Any Link state Type\n&quot;</a>
<a name="ln827">       &quot;Specify Link state ID as IPv4 address notation\n&quot;</a>
<a name="ln828">       &quot;Specify Advertising Router as IPv4 address notation\n&quot;</a>
<a name="ln829">      )</a>
<a name="ln830">{</a>
<a name="ln831">  int level;</a>
<a name="ln832">  struct listnode *i, *j;</a>
<a name="ln833">  struct ospf6 *o = ospf6;</a>
<a name="ln834">  struct ospf6_area *oa;</a>
<a name="ln835">  struct ospf6_interface *oi;</a>
<a name="ln836">  u_int32_t id = 0;</a>
<a name="ln837">  u_int32_t adv_router = 0;</a>
<a name="ln838"> </a>
<a name="ln839">  OSPF6_CMD_CHECK_RUNNING ();</a>
<a name="ln840"> </a>
<a name="ln841">  if ((inet_pton (AF_INET, argv[0], &amp;id)) != 1)</a>
<a name="ln842">    {</a>
<a name="ln843">      vty_out (vty, &quot;Link state ID is not parsable: %s%s&quot;,</a>
<a name="ln844">               argv[0], VNL);</a>
<a name="ln845">      return CMD_SUCCESS;</a>
<a name="ln846">    }</a>
<a name="ln847"> </a>
<a name="ln848">  argc--;</a>
<a name="ln849">  argv++;</a>
<a name="ln850"> </a>
<a name="ln851">  if ((inet_pton (AF_INET, argv[0], &amp;adv_router)) != 1)</a>
<a name="ln852">    {</a>
<a name="ln853">      vty_out (vty, &quot;Advertising Router is not parsable: %s%s&quot;,</a>
<a name="ln854">               argv[0], VNL);</a>
<a name="ln855">      return CMD_SUCCESS;</a>
<a name="ln856">    }</a>
<a name="ln857"> </a>
<a name="ln858">  argc--;</a>
<a name="ln859">  argv++;</a>
<a name="ln860">  level = parse_show_level (argc, argv);</a>
<a name="ln861"> </a>
<a name="ln862">  for (ALL_LIST_ELEMENTS_RO (o-&gt;area_list, i, oa))</a>
<a name="ln863">    {</a>
<a name="ln864">      vty_out (vty, AREA_LSDB_TITLE_FORMAT, VNL, oa-&gt;name, VNL, VNL);</a>
<a name="ln865">      ospf6_lsdb_show (vty, level, NULL, &amp;id, &amp;adv_router, oa-&gt;lsdb);</a>
<a name="ln866">    }</a>
<a name="ln867"> </a>
<a name="ln868">  for (ALL_LIST_ELEMENTS_RO (o-&gt;area_list, i, oa))</a>
<a name="ln869">    {</a>
<a name="ln870">      for (ALL_LIST_ELEMENTS_RO (oa-&gt;if_list, j, oi))</a>
<a name="ln871">        {</a>
<a name="ln872">          vty_out (vty, IF_LSDB_TITLE_FORMAT, VNL,</a>
<a name="ln873">                   oi-&gt;interface-&gt;name, oa-&gt;name, VNL, VNL);</a>
<a name="ln874">          ospf6_lsdb_show (vty, level, NULL, &amp;id, &amp;adv_router, oi-&gt;lsdb);</a>
<a name="ln875">        }</a>
<a name="ln876">    }</a>
<a name="ln877"> </a>
<a name="ln878">  vty_out (vty, AS_LSDB_TITLE_FORMAT, VNL, VNL, VNL);</a>
<a name="ln879">  ospf6_lsdb_show (vty, level, NULL, &amp;id, &amp;adv_router, o-&gt;lsdb);</a>
<a name="ln880"> </a>
<a name="ln881">  vty_out (vty, &quot;%s&quot;, VNL);</a>
<a name="ln882">  return CMD_SUCCESS;</a>
<a name="ln883">}</a>
<a name="ln884"> </a>
<a name="ln885">ALIAS (show_ipv6_ospf6_database_id_router,</a>
<a name="ln886">       show_ipv6_ospf6_database_id_router_detail_cmd,</a>
<a name="ln887">       &quot;show ipv6 ospf6 database * A.B.C.D A.B.C.D &quot;</a>
<a name="ln888">       &quot;(detail|dump|internal)&quot;,</a>
<a name="ln889">       SHOW_STR</a>
<a name="ln890">       IPV6_STR</a>
<a name="ln891">       OSPF6_STR</a>
<a name="ln892">       &quot;Display Link state database\n&quot;</a>
<a name="ln893">       &quot;Any Link state Type\n&quot;</a>
<a name="ln894">       &quot;Specify Link state ID as IPv4 address notation\n&quot;</a>
<a name="ln895">       &quot;Specify Advertising Router as IPv4 address notation\n&quot;</a>
<a name="ln896">       &quot;Display details of LSAs\n&quot;</a>
<a name="ln897">       &quot;Dump LSAs\n&quot;</a>
<a name="ln898">       &quot;Display LSA's internal information\n&quot;</a>
<a name="ln899">      )</a>
<a name="ln900"> </a>
<a name="ln901">DEFUN (show_ipv6_ospf6_database_adv_router_linkstate_id,</a>
<a name="ln902">       show_ipv6_ospf6_database_adv_router_linkstate_id_cmd,</a>
<a name="ln903">       &quot;show ipv6 ospf6 database adv-router A.B.C.D linkstate-id A.B.C.D&quot;,</a>
<a name="ln904">       SHOW_STR</a>
<a name="ln905">       IPV6_STR</a>
<a name="ln906">       OSPF6_STR</a>
<a name="ln907">       &quot;Display Link state database\n&quot;</a>
<a name="ln908">       &quot;Search by Advertising Router\n&quot;</a>
<a name="ln909">       &quot;Specify Advertising Router as IPv4 address notation\n&quot;</a>
<a name="ln910">       &quot;Search by Link state ID\n&quot;</a>
<a name="ln911">       &quot;Specify Link state ID as IPv4 address notation\n&quot;</a>
<a name="ln912">      )</a>
<a name="ln913">{</a>
<a name="ln914">  int level;</a>
<a name="ln915">  struct listnode *i, *j;</a>
<a name="ln916">  struct ospf6 *o = ospf6;</a>
<a name="ln917">  struct ospf6_area *oa;</a>
<a name="ln918">  struct ospf6_interface *oi;</a>
<a name="ln919">  u_int32_t id = 0;</a>
<a name="ln920">  u_int32_t adv_router = 0;</a>
<a name="ln921"> </a>
<a name="ln922">  OSPF6_CMD_CHECK_RUNNING ();</a>
<a name="ln923"> </a>
<a name="ln924">  if ((inet_pton (AF_INET, argv[0], &amp;adv_router)) != 1)</a>
<a name="ln925">    {</a>
<a name="ln926">      vty_out (vty, &quot;Advertising Router is not parsable: %s%s&quot;,</a>
<a name="ln927">               argv[0], VNL);</a>
<a name="ln928">      return CMD_SUCCESS;</a>
<a name="ln929">    }</a>
<a name="ln930"> </a>
<a name="ln931">  argc--;</a>
<a name="ln932">  argv++;</a>
<a name="ln933"> </a>
<a name="ln934">  if ((inet_pton (AF_INET, argv[0], &amp;id)) != 1)</a>
<a name="ln935">    {</a>
<a name="ln936">      vty_out (vty, &quot;Link state ID is not parsable: %s%s&quot;,</a>
<a name="ln937">               argv[0], VNL);</a>
<a name="ln938">      return CMD_SUCCESS;</a>
<a name="ln939">    }</a>
<a name="ln940"> </a>
<a name="ln941">  argc--;</a>
<a name="ln942">  argv++;</a>
<a name="ln943">  level = parse_show_level (argc, argv);</a>
<a name="ln944"> </a>
<a name="ln945">  for (ALL_LIST_ELEMENTS_RO (o-&gt;area_list, i, oa))</a>
<a name="ln946">    {</a>
<a name="ln947">      vty_out (vty, AREA_LSDB_TITLE_FORMAT, VNL, oa-&gt;name, VNL, VNL);</a>
<a name="ln948">      ospf6_lsdb_show (vty, level, NULL, &amp;id, &amp;adv_router, oa-&gt;lsdb);</a>
<a name="ln949">    }</a>
<a name="ln950"> </a>
<a name="ln951">  for (ALL_LIST_ELEMENTS_RO (o-&gt;area_list, i, oa))</a>
<a name="ln952">    {</a>
<a name="ln953">      for (ALL_LIST_ELEMENTS_RO (oa-&gt;if_list, j, oi))</a>
<a name="ln954">        {</a>
<a name="ln955">          vty_out (vty, IF_LSDB_TITLE_FORMAT, VNL,</a>
<a name="ln956">                   oi-&gt;interface-&gt;name, oa-&gt;name, VNL, VNL);</a>
<a name="ln957">          ospf6_lsdb_show (vty, level, NULL, &amp;id, &amp;adv_router, oi-&gt;lsdb);</a>
<a name="ln958">        }</a>
<a name="ln959">    }</a>
<a name="ln960"> </a>
<a name="ln961">  vty_out (vty, AS_LSDB_TITLE_FORMAT, VNL, VNL, VNL);</a>
<a name="ln962">  ospf6_lsdb_show (vty, level, NULL, &amp;id, &amp;adv_router, o-&gt;lsdb);</a>
<a name="ln963"> </a>
<a name="ln964">  vty_out (vty, &quot;%s&quot;, VNL);</a>
<a name="ln965">  return CMD_SUCCESS;</a>
<a name="ln966">}</a>
<a name="ln967"> </a>
<a name="ln968">ALIAS (show_ipv6_ospf6_database_adv_router_linkstate_id,</a>
<a name="ln969">       show_ipv6_ospf6_database_adv_router_linkstate_id_detail_cmd,</a>
<a name="ln970">       &quot;show ipv6 ospf6 database adv-router A.B.C.D linkstate-id A.B.C.D &quot;</a>
<a name="ln971">       &quot;(detail|dump|internal)&quot;,</a>
<a name="ln972">       SHOW_STR</a>
<a name="ln973">       IPV6_STR</a>
<a name="ln974">       OSPF6_STR</a>
<a name="ln975">       &quot;Display Link state database\n&quot;</a>
<a name="ln976">       &quot;Search by Advertising Router\n&quot;</a>
<a name="ln977">       &quot;Specify Advertising Router as IPv4 address notation\n&quot;</a>
<a name="ln978">       &quot;Search by Link state ID\n&quot;</a>
<a name="ln979">       &quot;Specify Link state ID as IPv4 address notation\n&quot;</a>
<a name="ln980">       &quot;Display details of LSAs\n&quot;</a>
<a name="ln981">       &quot;Dump LSAs\n&quot;</a>
<a name="ln982">       &quot;Display LSA's internal information\n&quot;</a>
<a name="ln983">      )</a>
<a name="ln984"> </a>
<a name="ln985">DEFUN (show_ipv6_ospf6_database_type_id_router,</a>
<a name="ln986">       show_ipv6_ospf6_database_type_id_router_cmd,</a>
<a name="ln987">       &quot;show ipv6 ospf6 database &quot;</a>
<a name="ln988">       &quot;(router|network|inter-prefix|inter-router|as-external|&quot;</a>
<a name="ln989">       &quot;group-membership|type-7|link|intra-prefix) A.B.C.D A.B.C.D&quot;,</a>
<a name="ln990">       SHOW_STR</a>
<a name="ln991">       IPV6_STR</a>
<a name="ln992">       OSPF6_STR</a>
<a name="ln993">       &quot;Display Link state database\n&quot;</a>
<a name="ln994">       &quot;Display Router LSAs\n&quot;</a>
<a name="ln995">       &quot;Display Network LSAs\n&quot;</a>
<a name="ln996">       &quot;Display Inter-Area-Prefix LSAs\n&quot;</a>
<a name="ln997">       &quot;Display Inter-Area-Router LSAs\n&quot;</a>
<a name="ln998">       &quot;Display As-External LSAs\n&quot;</a>
<a name="ln999">       &quot;Display Group-Membership LSAs\n&quot;</a>
<a name="ln1000">       &quot;Display Type-7 LSAs\n&quot;</a>
<a name="ln1001">       &quot;Display Link LSAs\n&quot;</a>
<a name="ln1002">       &quot;Display Intra-Area-Prefix LSAs\n&quot;</a>
<a name="ln1003">       &quot;Specify Link state ID as IPv4 address notation\n&quot;</a>
<a name="ln1004">       &quot;Specify Advertising Router as IPv4 address notation\n&quot;</a>
<a name="ln1005">      )</a>
<a name="ln1006">{</a>
<a name="ln1007">  int level;</a>
<a name="ln1008">  struct listnode *i, *j;</a>
<a name="ln1009">  struct ospf6 *o = ospf6;</a>
<a name="ln1010">  struct ospf6_area *oa;</a>
<a name="ln1011">  struct ospf6_interface *oi;</a>
<a name="ln1012">  u_int16_t type = 0;</a>
<a name="ln1013">  u_int32_t id = 0;</a>
<a name="ln1014">  u_int32_t adv_router = 0;</a>
<a name="ln1015"> </a>
<a name="ln1016">  OSPF6_CMD_CHECK_RUNNING ();</a>
<a name="ln1017"> </a>
<a name="ln1018">  type = parse_type_spec (argc, argv);</a>
<a name="ln1019">  argc--;</a>
<a name="ln1020">  argv++;</a>
<a name="ln1021"> </a>
<a name="ln1022">  if ((inet_pton (AF_INET, argv[0], &amp;id)) != 1)</a>
<a name="ln1023">    {</a>
<a name="ln1024">      vty_out (vty, &quot;Link state ID is not parsable: %s%s&quot;,</a>
<a name="ln1025">               argv[0], VNL);</a>
<a name="ln1026">      return CMD_SUCCESS;</a>
<a name="ln1027">    }</a>
<a name="ln1028"> </a>
<a name="ln1029">  argc--;</a>
<a name="ln1030">  argv++;</a>
<a name="ln1031"> </a>
<a name="ln1032">  if ((inet_pton (AF_INET, argv[0], &amp;adv_router)) != 1)</a>
<a name="ln1033">    {</a>
<a name="ln1034">      vty_out (vty, &quot;Advertising Router is not parsable: %s%s&quot;,</a>
<a name="ln1035">               argv[0], VNL);</a>
<a name="ln1036">      return CMD_SUCCESS;</a>
<a name="ln1037">    }</a>
<a name="ln1038"> </a>
<a name="ln1039">  argc--;</a>
<a name="ln1040">  argv++;</a>
<a name="ln1041">  level = parse_show_level (argc, argv);</a>
<a name="ln1042"> </a>
<a name="ln1043">  switch (OSPF6_LSA_SCOPE (type))</a>
<a name="ln1044">    {</a>
<a name="ln1045">      case OSPF6_SCOPE_AREA:</a>
<a name="ln1046">        for (ALL_LIST_ELEMENTS_RO (o-&gt;area_list, i, oa))</a>
<a name="ln1047">          {</a>
<a name="ln1048">            vty_out (vty, AREA_LSDB_TITLE_FORMAT, VNL, oa-&gt;name, VNL, VNL);</a>
<a name="ln1049">            ospf6_lsdb_show (vty, level, &amp;type, &amp;id, &amp;adv_router, oa-&gt;lsdb);</a>
<a name="ln1050">          }</a>
<a name="ln1051">        break;</a>
<a name="ln1052"> </a>
<a name="ln1053">      case OSPF6_SCOPE_LINKLOCAL:</a>
<a name="ln1054">        for (ALL_LIST_ELEMENTS_RO (o-&gt;area_list, i, oa))</a>
<a name="ln1055">          {</a>
<a name="ln1056">            for (ALL_LIST_ELEMENTS_RO (oa-&gt;if_list, j, oi))</a>
<a name="ln1057">              {</a>
<a name="ln1058">                vty_out (vty, IF_LSDB_TITLE_FORMAT, VNL,</a>
<a name="ln1059">                         oi-&gt;interface-&gt;name, oa-&gt;name, VNL, VNL);</a>
<a name="ln1060">                ospf6_lsdb_show (vty, level, &amp;type, &amp;id, &amp;adv_router, oi-&gt;lsdb);</a>
<a name="ln1061">              }</a>
<a name="ln1062">          }</a>
<a name="ln1063">        break;</a>
<a name="ln1064"> </a>
<a name="ln1065">      case OSPF6_SCOPE_AS:</a>
<a name="ln1066">        vty_out (vty, AS_LSDB_TITLE_FORMAT, VNL, VNL, VNL);</a>
<a name="ln1067">        ospf6_lsdb_show (vty, level, &amp;type, &amp;id, &amp;adv_router, o-&gt;lsdb);</a>
<a name="ln1068">        break;</a>
<a name="ln1069"> </a>
<a name="ln1070">      default:</a>
<a name="ln1071">        assert (0);</a>
<a name="ln1072">        break;</a>
<a name="ln1073">    }</a>
<a name="ln1074"> </a>
<a name="ln1075">  vty_out (vty, &quot;%s&quot;, VNL);</a>
<a name="ln1076">  return CMD_SUCCESS;</a>
<a name="ln1077">}</a>
<a name="ln1078"> </a>
<a name="ln1079">ALIAS (show_ipv6_ospf6_database_type_id_router,</a>
<a name="ln1080">       show_ipv6_ospf6_database_type_id_router_detail_cmd,</a>
<a name="ln1081">       &quot;show ipv6 ospf6 database &quot;</a>
<a name="ln1082">       &quot;(router|network|inter-prefix|inter-router|as-external|&quot;</a>
<a name="ln1083">       &quot;group-membership|type-7|link|intra-prefix) A.B.C.D A.B.C.D &quot;</a>
<a name="ln1084">       &quot;(dump|internal)&quot;,</a>
<a name="ln1085">       SHOW_STR</a>
<a name="ln1086">       IPV6_STR</a>
<a name="ln1087">       OSPF6_STR</a>
<a name="ln1088">       &quot;Display Link state database\n&quot;</a>
<a name="ln1089">       &quot;Display Router LSAs\n&quot;</a>
<a name="ln1090">       &quot;Display Network LSAs\n&quot;</a>
<a name="ln1091">       &quot;Display Inter-Area-Prefix LSAs\n&quot;</a>
<a name="ln1092">       &quot;Display Inter-Area-Router LSAs\n&quot;</a>
<a name="ln1093">       &quot;Display As-External LSAs\n&quot;</a>
<a name="ln1094">       &quot;Display Group-Membership LSAs\n&quot;</a>
<a name="ln1095">       &quot;Display Type-7 LSAs\n&quot;</a>
<a name="ln1096">       &quot;Display Link LSAs\n&quot;</a>
<a name="ln1097">       &quot;Display Intra-Area-Prefix LSAs\n&quot;</a>
<a name="ln1098">       &quot;Specify Link state ID as IPv4 address notation\n&quot;</a>
<a name="ln1099">       &quot;Specify Advertising Router as IPv4 address notation\n&quot;</a>
<a name="ln1100">       &quot;Dump LSAs\n&quot;</a>
<a name="ln1101">       &quot;Display LSA's internal information\n&quot;</a>
<a name="ln1102">      )</a>
<a name="ln1103"> </a>
<a name="ln1104">DEFUN (show_ipv6_ospf6_database_type_adv_router_linkstate_id,</a>
<a name="ln1105">       show_ipv6_ospf6_database_type_adv_router_linkstate_id_cmd,</a>
<a name="ln1106">       &quot;show ipv6 ospf6 database &quot;</a>
<a name="ln1107">       &quot;(router|network|inter-prefix|inter-router|as-external|&quot;</a>
<a name="ln1108">       &quot;group-membership|type-7|link|intra-prefix) &quot;</a>
<a name="ln1109">       &quot;adv-router A.B.C.D linkstate-id A.B.C.D&quot;,</a>
<a name="ln1110">       SHOW_STR</a>
<a name="ln1111">       IPV6_STR</a>
<a name="ln1112">       OSPF6_STR</a>
<a name="ln1113">       &quot;Display Link state database\n&quot;</a>
<a name="ln1114">       &quot;Display Router LSAs\n&quot;</a>
<a name="ln1115">       &quot;Display Network LSAs\n&quot;</a>
<a name="ln1116">       &quot;Display Inter-Area-Prefix LSAs\n&quot;</a>
<a name="ln1117">       &quot;Display Inter-Area-Router LSAs\n&quot;</a>
<a name="ln1118">       &quot;Display As-External LSAs\n&quot;</a>
<a name="ln1119">       &quot;Display Group-Membership LSAs\n&quot;</a>
<a name="ln1120">       &quot;Display Type-7 LSAs\n&quot;</a>
<a name="ln1121">       &quot;Display Link LSAs\n&quot;</a>
<a name="ln1122">       &quot;Display Intra-Area-Prefix LSAs\n&quot;</a>
<a name="ln1123">       &quot;Search by Advertising Router\n&quot;</a>
<a name="ln1124">       &quot;Specify Advertising Router as IPv4 address notation\n&quot;</a>
<a name="ln1125">       &quot;Search by Link state ID\n&quot;</a>
<a name="ln1126">       &quot;Specify Link state ID as IPv4 address notation\n&quot;</a>
<a name="ln1127">      )</a>
<a name="ln1128">{</a>
<a name="ln1129">  int level;</a>
<a name="ln1130">  struct listnode *i, *j;</a>
<a name="ln1131">  struct ospf6 *o = ospf6;</a>
<a name="ln1132">  struct ospf6_area *oa;</a>
<a name="ln1133">  struct ospf6_interface *oi;</a>
<a name="ln1134">  u_int16_t type = 0;</a>
<a name="ln1135">  u_int32_t id = 0;</a>
<a name="ln1136">  u_int32_t adv_router = 0;</a>
<a name="ln1137"> </a>
<a name="ln1138">  OSPF6_CMD_CHECK_RUNNING ();</a>
<a name="ln1139"> </a>
<a name="ln1140">  type = parse_type_spec (argc, argv);</a>
<a name="ln1141">  argc--;</a>
<a name="ln1142">  argv++;</a>
<a name="ln1143"> </a>
<a name="ln1144">  if ((inet_pton (AF_INET, argv[0], &amp;adv_router)) != 1)</a>
<a name="ln1145">    {</a>
<a name="ln1146">      vty_out (vty, &quot;Advertising Router is not parsable: %s%s&quot;,</a>
<a name="ln1147">               argv[0], VNL);</a>
<a name="ln1148">      return CMD_SUCCESS;</a>
<a name="ln1149">    }</a>
<a name="ln1150"> </a>
<a name="ln1151">  argc--;</a>
<a name="ln1152">  argv++;</a>
<a name="ln1153"> </a>
<a name="ln1154">  if ((inet_pton (AF_INET, argv[0], &amp;id)) != 1)</a>
<a name="ln1155">    {</a>
<a name="ln1156">      vty_out (vty, &quot;Link state ID is not parsable: %s%s&quot;,</a>
<a name="ln1157">               argv[0], VNL);</a>
<a name="ln1158">      return CMD_SUCCESS;</a>
<a name="ln1159">    }</a>
<a name="ln1160"> </a>
<a name="ln1161">  argc--;</a>
<a name="ln1162">  argv++;</a>
<a name="ln1163">  level = parse_show_level (argc, argv);</a>
<a name="ln1164"> </a>
<a name="ln1165">  switch (OSPF6_LSA_SCOPE (type))</a>
<a name="ln1166">    {</a>
<a name="ln1167">      case OSPF6_SCOPE_AREA:</a>
<a name="ln1168">        for (ALL_LIST_ELEMENTS_RO (o-&gt;area_list, i, oa))</a>
<a name="ln1169">          {</a>
<a name="ln1170">            vty_out (vty, AREA_LSDB_TITLE_FORMAT, VNL, oa-&gt;name, VNL, VNL);</a>
<a name="ln1171">            ospf6_lsdb_show (vty, level, &amp;type, &amp;id, &amp;adv_router, oa-&gt;lsdb);</a>
<a name="ln1172">          }</a>
<a name="ln1173">        break;</a>
<a name="ln1174"> </a>
<a name="ln1175">      case OSPF6_SCOPE_LINKLOCAL:</a>
<a name="ln1176">        for (ALL_LIST_ELEMENTS_RO (o-&gt;area_list, i, oa))</a>
<a name="ln1177">          {</a>
<a name="ln1178">            for (ALL_LIST_ELEMENTS_RO (oa-&gt;if_list, j, oi))</a>
<a name="ln1179">              {</a>
<a name="ln1180">                vty_out (vty, IF_LSDB_TITLE_FORMAT, VNL,</a>
<a name="ln1181">                         oi-&gt;interface-&gt;name, oa-&gt;name, VNL, VNL);</a>
<a name="ln1182">                ospf6_lsdb_show (vty, level, &amp;type, &amp;id, &amp;adv_router, oi-&gt;lsdb);</a>
<a name="ln1183">              }</a>
<a name="ln1184">          }</a>
<a name="ln1185">        break;</a>
<a name="ln1186"> </a>
<a name="ln1187">      case OSPF6_SCOPE_AS:</a>
<a name="ln1188">        vty_out (vty, AS_LSDB_TITLE_FORMAT, VNL, VNL, VNL);</a>
<a name="ln1189">        ospf6_lsdb_show (vty, level, &amp;type, &amp;id, &amp;adv_router, o-&gt;lsdb);</a>
<a name="ln1190">        break;</a>
<a name="ln1191"> </a>
<a name="ln1192">      default:</a>
<a name="ln1193">        assert (0);</a>
<a name="ln1194">        break;</a>
<a name="ln1195">    }</a>
<a name="ln1196"> </a>
<a name="ln1197">  vty_out (vty, &quot;%s&quot;, VNL);</a>
<a name="ln1198">  return CMD_SUCCESS;</a>
<a name="ln1199">}</a>
<a name="ln1200"> </a>
<a name="ln1201">ALIAS (show_ipv6_ospf6_database_type_adv_router_linkstate_id,</a>
<a name="ln1202">       show_ipv6_ospf6_database_type_adv_router_linkstate_id_detail_cmd,</a>
<a name="ln1203">       &quot;show ipv6 ospf6 database &quot;</a>
<a name="ln1204">       &quot;(router|network|inter-prefix|inter-router|as-external|&quot;</a>
<a name="ln1205">       &quot;group-membership|type-7|link|intra-prefix) &quot;</a>
<a name="ln1206">       &quot;adv-router A.B.C.D linkstate-id A.B.C.D &quot;</a>
<a name="ln1207">       &quot;(dump|internal)&quot;,</a>
<a name="ln1208">       SHOW_STR</a>
<a name="ln1209">       IPV6_STR</a>
<a name="ln1210">       OSPF6_STR</a>
<a name="ln1211">       &quot;Display Link state database\n&quot;</a>
<a name="ln1212">       &quot;Display Router LSAs\n&quot;</a>
<a name="ln1213">       &quot;Display Network LSAs\n&quot;</a>
<a name="ln1214">       &quot;Display Inter-Area-Prefix LSAs\n&quot;</a>
<a name="ln1215">       &quot;Display Inter-Area-Router LSAs\n&quot;</a>
<a name="ln1216">       &quot;Display As-External LSAs\n&quot;</a>
<a name="ln1217">       &quot;Display Group-Membership LSAs\n&quot;</a>
<a name="ln1218">       &quot;Display Type-7 LSAs\n&quot;</a>
<a name="ln1219">       &quot;Display Link LSAs\n&quot;</a>
<a name="ln1220">       &quot;Display Intra-Area-Prefix LSAs\n&quot;</a>
<a name="ln1221">       &quot;Search by Advertising Router\n&quot;</a>
<a name="ln1222">       &quot;Specify Advertising Router as IPv4 address notation\n&quot;</a>
<a name="ln1223">       &quot;Search by Link state ID\n&quot;</a>
<a name="ln1224">       &quot;Specify Link state ID as IPv4 address notation\n&quot;</a>
<a name="ln1225">       &quot;Dump LSAs\n&quot;</a>
<a name="ln1226">       &quot;Display LSA's internal information\n&quot;</a>
<a name="ln1227">      )</a>
<a name="ln1228"> </a>
<a name="ln1229">DEFUN (show_ipv6_ospf6_database_self_originated,</a>
<a name="ln1230">       show_ipv6_ospf6_database_self_originated_cmd,</a>
<a name="ln1231">       &quot;show ipv6 ospf6 database self-originated&quot;,</a>
<a name="ln1232">       SHOW_STR</a>
<a name="ln1233">       IPV6_STR</a>
<a name="ln1234">       OSPF6_STR</a>
<a name="ln1235">       &quot;Display Self-originated LSAs\n&quot;</a>
<a name="ln1236">      )</a>
<a name="ln1237">{</a>
<a name="ln1238">  int level;</a>
<a name="ln1239">  struct listnode *i, *j;</a>
<a name="ln1240">  struct ospf6 *o = ospf6;</a>
<a name="ln1241">  struct ospf6_area *oa;</a>
<a name="ln1242">  struct ospf6_interface *oi;</a>
<a name="ln1243">  u_int32_t adv_router = 0;</a>
<a name="ln1244"> </a>
<a name="ln1245">  OSPF6_CMD_CHECK_RUNNING ();</a>
<a name="ln1246"> </a>
<a name="ln1247">  level = parse_show_level (argc, argv);</a>
<a name="ln1248"> </a>
<a name="ln1249">  adv_router = o-&gt;router_id;</a>
<a name="ln1250"> </a>
<a name="ln1251">  for (ALL_LIST_ELEMENTS_RO (o-&gt;area_list, i, oa))</a>
<a name="ln1252">    {</a>
<a name="ln1253">      vty_out (vty, AREA_LSDB_TITLE_FORMAT, VNL, oa-&gt;name, VNL, VNL);</a>
<a name="ln1254">      ospf6_lsdb_show (vty, level, NULL, NULL, &amp;adv_router, oa-&gt;lsdb);</a>
<a name="ln1255">    }</a>
<a name="ln1256"> </a>
<a name="ln1257">  for (ALL_LIST_ELEMENTS_RO (o-&gt;area_list, i, oa))</a>
<a name="ln1258">    {</a>
<a name="ln1259">      for (ALL_LIST_ELEMENTS_RO (oa-&gt;if_list, j, oi))</a>
<a name="ln1260">        {</a>
<a name="ln1261">          vty_out (vty, IF_LSDB_TITLE_FORMAT, VNL,</a>
<a name="ln1262">                   oi-&gt;interface-&gt;name, oa-&gt;name, VNL, VNL);</a>
<a name="ln1263">          ospf6_lsdb_show (vty, level, NULL, NULL, &amp;adv_router, oi-&gt;lsdb);</a>
<a name="ln1264">        }</a>
<a name="ln1265">    }</a>
<a name="ln1266"> </a>
<a name="ln1267">  vty_out (vty, AS_LSDB_TITLE_FORMAT, VNL, VNL, VNL);</a>
<a name="ln1268">  ospf6_lsdb_show (vty, level, NULL, NULL, &amp;adv_router, o-&gt;lsdb);</a>
<a name="ln1269"> </a>
<a name="ln1270">  vty_out (vty, &quot;%s&quot;, VNL);</a>
<a name="ln1271">  return CMD_SUCCESS;</a>
<a name="ln1272">}</a>
<a name="ln1273"> </a>
<a name="ln1274">ALIAS (show_ipv6_ospf6_database_self_originated,</a>
<a name="ln1275">       show_ipv6_ospf6_database_self_originated_detail_cmd,</a>
<a name="ln1276">       &quot;show ipv6 ospf6 database self-originated &quot;</a>
<a name="ln1277">       &quot;(detail|dump|internal)&quot;,</a>
<a name="ln1278">       SHOW_STR</a>
<a name="ln1279">       IPV6_STR</a>
<a name="ln1280">       OSPF6_STR</a>
<a name="ln1281">       &quot;Display Self-originated LSAs\n&quot;</a>
<a name="ln1282">       &quot;Display details of LSAs\n&quot;</a>
<a name="ln1283">       &quot;Dump LSAs\n&quot;</a>
<a name="ln1284">       &quot;Display LSA's internal information\n&quot;</a>
<a name="ln1285">      )</a>
<a name="ln1286"> </a>
<a name="ln1287">DEFUN (show_ipv6_ospf6_database_type_self_originated,</a>
<a name="ln1288">       show_ipv6_ospf6_database_type_self_originated_cmd,</a>
<a name="ln1289">       &quot;show ipv6 ospf6 database &quot;</a>
<a name="ln1290">       &quot;(router|network|inter-prefix|inter-router|as-external|&quot;</a>
<a name="ln1291">       &quot;group-membership|type-7|link|intra-prefix) self-originated&quot;,</a>
<a name="ln1292">       SHOW_STR</a>
<a name="ln1293">       IPV6_STR</a>
<a name="ln1294">       OSPF6_STR</a>
<a name="ln1295">       &quot;Display Link state database\n&quot;</a>
<a name="ln1296">       &quot;Display Router LSAs\n&quot;</a>
<a name="ln1297">       &quot;Display Network LSAs\n&quot;</a>
<a name="ln1298">       &quot;Display Inter-Area-Prefix LSAs\n&quot;</a>
<a name="ln1299">       &quot;Display Inter-Area-Router LSAs\n&quot;</a>
<a name="ln1300">       &quot;Display As-External LSAs\n&quot;</a>
<a name="ln1301">       &quot;Display Group-Membership LSAs\n&quot;</a>
<a name="ln1302">       &quot;Display Type-7 LSAs\n&quot;</a>
<a name="ln1303">       &quot;Display Link LSAs\n&quot;</a>
<a name="ln1304">       &quot;Display Intra-Area-Prefix LSAs\n&quot;</a>
<a name="ln1305">       &quot;Display Self-originated LSAs\n&quot;</a>
<a name="ln1306">      )</a>
<a name="ln1307">{</a>
<a name="ln1308">  int level;</a>
<a name="ln1309">  struct listnode *i, *j;</a>
<a name="ln1310">  struct ospf6 *o = ospf6;</a>
<a name="ln1311">  struct ospf6_area *oa;</a>
<a name="ln1312">  struct ospf6_interface *oi;</a>
<a name="ln1313">  u_int16_t type = 0;</a>
<a name="ln1314">  u_int32_t adv_router = 0;</a>
<a name="ln1315"> </a>
<a name="ln1316">  OSPF6_CMD_CHECK_RUNNING ();</a>
<a name="ln1317"> </a>
<a name="ln1318">  type = parse_type_spec (argc, argv);</a>
<a name="ln1319">  argc--;</a>
<a name="ln1320">  argv++;</a>
<a name="ln1321">  level = parse_show_level (argc, argv);</a>
<a name="ln1322"> </a>
<a name="ln1323">  adv_router = o-&gt;router_id;</a>
<a name="ln1324"> </a>
<a name="ln1325">  switch (OSPF6_LSA_SCOPE (type))</a>
<a name="ln1326">    {</a>
<a name="ln1327">      case OSPF6_SCOPE_AREA:</a>
<a name="ln1328">        for (ALL_LIST_ELEMENTS_RO (o-&gt;area_list, i, oa))</a>
<a name="ln1329">          {</a>
<a name="ln1330">            vty_out (vty, AREA_LSDB_TITLE_FORMAT, VNL, oa-&gt;name, VNL, VNL);</a>
<a name="ln1331">            ospf6_lsdb_show (vty, level, &amp;type, NULL, &amp;adv_router, oa-&gt;lsdb);</a>
<a name="ln1332">          }</a>
<a name="ln1333">        break;</a>
<a name="ln1334"> </a>
<a name="ln1335">      case OSPF6_SCOPE_LINKLOCAL:</a>
<a name="ln1336">        for (ALL_LIST_ELEMENTS_RO (o-&gt;area_list, i, oa))</a>
<a name="ln1337">          {</a>
<a name="ln1338">            for (ALL_LIST_ELEMENTS_RO (oa-&gt;if_list, j, oi))</a>
<a name="ln1339">              {</a>
<a name="ln1340">                vty_out (vty, IF_LSDB_TITLE_FORMAT, VNL,</a>
<a name="ln1341">                         oi-&gt;interface-&gt;name, oa-&gt;name, VNL, VNL);</a>
<a name="ln1342">                ospf6_lsdb_show (vty, level, &amp;type, NULL, &amp;adv_router, oi-&gt;lsdb);</a>
<a name="ln1343">              }</a>
<a name="ln1344">          }</a>
<a name="ln1345">        break;</a>
<a name="ln1346"> </a>
<a name="ln1347">      case OSPF6_SCOPE_AS:</a>
<a name="ln1348">        vty_out (vty, AS_LSDB_TITLE_FORMAT, VNL, VNL, VNL);</a>
<a name="ln1349">        ospf6_lsdb_show (vty, level, &amp;type, NULL, &amp;adv_router, o-&gt;lsdb);</a>
<a name="ln1350">        break;</a>
<a name="ln1351"> </a>
<a name="ln1352">      default:</a>
<a name="ln1353">        assert (0);</a>
<a name="ln1354">        break;</a>
<a name="ln1355">    }</a>
<a name="ln1356"> </a>
<a name="ln1357">  vty_out (vty, &quot;%s&quot;, VNL);</a>
<a name="ln1358">  return CMD_SUCCESS;</a>
<a name="ln1359">}</a>
<a name="ln1360"> </a>
<a name="ln1361">ALIAS (show_ipv6_ospf6_database_type_self_originated,</a>
<a name="ln1362">       show_ipv6_ospf6_database_type_self_originated_detail_cmd,</a>
<a name="ln1363">       &quot;show ipv6 ospf6 database &quot;</a>
<a name="ln1364">       &quot;(router|network|inter-prefix|inter-router|as-external|&quot;</a>
<a name="ln1365">       &quot;group-membership|type-7|link|intra-prefix) self-originated &quot;</a>
<a name="ln1366">       &quot;(detail|dump|internal)&quot;,</a>
<a name="ln1367">       SHOW_STR</a>
<a name="ln1368">       IPV6_STR</a>
<a name="ln1369">       OSPF6_STR</a>
<a name="ln1370">       &quot;Display Link state database\n&quot;</a>
<a name="ln1371">       &quot;Display Router LSAs\n&quot;</a>
<a name="ln1372">       &quot;Display Network LSAs\n&quot;</a>
<a name="ln1373">       &quot;Display Inter-Area-Prefix LSAs\n&quot;</a>
<a name="ln1374">       &quot;Display Inter-Area-Router LSAs\n&quot;</a>
<a name="ln1375">       &quot;Display As-External LSAs\n&quot;</a>
<a name="ln1376">       &quot;Display Group-Membership LSAs\n&quot;</a>
<a name="ln1377">       &quot;Display Type-7 LSAs\n&quot;</a>
<a name="ln1378">       &quot;Display Link LSAs\n&quot;</a>
<a name="ln1379">       &quot;Display Intra-Area-Prefix LSAs\n&quot;</a>
<a name="ln1380">       &quot;Display Self-originated LSAs\n&quot;</a>
<a name="ln1381">       &quot;Display details of LSAs\n&quot;</a>
<a name="ln1382">       &quot;Dump LSAs\n&quot;</a>
<a name="ln1383">       &quot;Display LSA's internal information\n&quot;</a>
<a name="ln1384">      )</a>
<a name="ln1385"> </a>
<a name="ln1386">DEFUN (show_ipv6_ospf6_database_type_self_originated_linkstate_id,</a>
<a name="ln1387">       show_ipv6_ospf6_database_type_self_originated_linkstate_id_cmd,</a>
<a name="ln1388">       &quot;show ipv6 ospf6 database &quot;</a>
<a name="ln1389">       &quot;(router|network|inter-prefix|inter-router|as-external|&quot;</a>
<a name="ln1390">       &quot;group-membership|type-7|link|intra-prefix) self-originated &quot;</a>
<a name="ln1391">       &quot;linkstate-id A.B.C.D&quot;,</a>
<a name="ln1392">       SHOW_STR</a>
<a name="ln1393">       IPV6_STR</a>
<a name="ln1394">       OSPF6_STR</a>
<a name="ln1395">       &quot;Display Link state database\n&quot;</a>
<a name="ln1396">       &quot;Display Router LSAs\n&quot;</a>
<a name="ln1397">       &quot;Display Network LSAs\n&quot;</a>
<a name="ln1398">       &quot;Display Inter-Area-Prefix LSAs\n&quot;</a>
<a name="ln1399">       &quot;Display Inter-Area-Router LSAs\n&quot;</a>
<a name="ln1400">       &quot;Display As-External LSAs\n&quot;</a>
<a name="ln1401">       &quot;Display Group-Membership LSAs\n&quot;</a>
<a name="ln1402">       &quot;Display Type-7 LSAs\n&quot;</a>
<a name="ln1403">       &quot;Display Link LSAs\n&quot;</a>
<a name="ln1404">       &quot;Display Intra-Area-Prefix LSAs\n&quot;</a>
<a name="ln1405">       &quot;Display Self-originated LSAs\n&quot;</a>
<a name="ln1406">       &quot;Search by Link state ID\n&quot;</a>
<a name="ln1407">       &quot;Specify Link state ID as IPv4 address notation\n&quot;</a>
<a name="ln1408">      )</a>
<a name="ln1409">{</a>
<a name="ln1410">  int level;</a>
<a name="ln1411">  struct listnode *i, *j;</a>
<a name="ln1412">  struct ospf6 *o = ospf6;</a>
<a name="ln1413">  struct ospf6_area *oa;</a>
<a name="ln1414">  struct ospf6_interface *oi;</a>
<a name="ln1415">  u_int16_t type = 0;</a>
<a name="ln1416">  u_int32_t adv_router = 0;</a>
<a name="ln1417">  u_int32_t id = 0;</a>
<a name="ln1418"> </a>
<a name="ln1419">  OSPF6_CMD_CHECK_RUNNING ();</a>
<a name="ln1420"> </a>
<a name="ln1421">  type = parse_type_spec (argc, argv);</a>
<a name="ln1422">  argc--;</a>
<a name="ln1423">  argv++;</a>
<a name="ln1424"> </a>
<a name="ln1425">  if ((inet_pton (AF_INET, argv[0], &amp;id)) != 1)</a>
<a name="ln1426">    {</a>
<a name="ln1427">      vty_out (vty, &quot;Link State ID is not parsable: %s%s&quot;,</a>
<a name="ln1428">               argv[0], VNL);</a>
<a name="ln1429">      return CMD_SUCCESS;</a>
<a name="ln1430">    }</a>
<a name="ln1431"> </a>
<a name="ln1432">  argc--;</a>
<a name="ln1433">  argv++;</a>
<a name="ln1434">  level = parse_show_level (argc, argv);</a>
<a name="ln1435"> </a>
<a name="ln1436">  adv_router = o-&gt;router_id;</a>
<a name="ln1437"> </a>
<a name="ln1438">  switch (OSPF6_LSA_SCOPE (type))</a>
<a name="ln1439">    {</a>
<a name="ln1440">      case OSPF6_SCOPE_AREA:</a>
<a name="ln1441">        for (ALL_LIST_ELEMENTS_RO (o-&gt;area_list, i, oa))</a>
<a name="ln1442">          {</a>
<a name="ln1443">            vty_out (vty, AREA_LSDB_TITLE_FORMAT, VNL, oa-&gt;name, VNL, VNL);</a>
<a name="ln1444">            ospf6_lsdb_show (vty, level, &amp;type, &amp;id, &amp;adv_router, oa-&gt;lsdb);</a>
<a name="ln1445">          }</a>
<a name="ln1446">        break;</a>
<a name="ln1447"> </a>
<a name="ln1448">      case OSPF6_SCOPE_LINKLOCAL:</a>
<a name="ln1449">        for (ALL_LIST_ELEMENTS_RO (o-&gt;area_list, i, oa))</a>
<a name="ln1450">          {</a>
<a name="ln1451">            for (ALL_LIST_ELEMENTS_RO (oa-&gt;if_list, j, oi))</a>
<a name="ln1452">              {</a>
<a name="ln1453">                vty_out (vty, IF_LSDB_TITLE_FORMAT, VNL,</a>
<a name="ln1454">                         oi-&gt;interface-&gt;name, oa-&gt;name, VNL, VNL);</a>
<a name="ln1455">                ospf6_lsdb_show (vty, level, &amp;type, &amp;id, &amp;adv_router, oi-&gt;lsdb);</a>
<a name="ln1456">              }</a>
<a name="ln1457">          }</a>
<a name="ln1458">        break;</a>
<a name="ln1459"> </a>
<a name="ln1460">      case OSPF6_SCOPE_AS:</a>
<a name="ln1461">        vty_out (vty, AS_LSDB_TITLE_FORMAT, VNL, VNL, VNL);</a>
<a name="ln1462">        ospf6_lsdb_show (vty, level, &amp;type, &amp;id, &amp;adv_router, o-&gt;lsdb);</a>
<a name="ln1463">        break;</a>
<a name="ln1464"> </a>
<a name="ln1465">      default:</a>
<a name="ln1466">        assert (0);</a>
<a name="ln1467">        break;</a>
<a name="ln1468">    }</a>
<a name="ln1469"> </a>
<a name="ln1470">  vty_out (vty, &quot;%s&quot;, VNL);</a>
<a name="ln1471">  return CMD_SUCCESS;</a>
<a name="ln1472">}</a>
<a name="ln1473"> </a>
<a name="ln1474">ALIAS (show_ipv6_ospf6_database_type_self_originated_linkstate_id,</a>
<a name="ln1475">       show_ipv6_ospf6_database_type_self_originated_linkstate_id_detail_cmd,</a>
<a name="ln1476">       &quot;show ipv6 ospf6 database &quot;</a>
<a name="ln1477">       &quot;(router|network|inter-prefix|inter-router|as-external|&quot;</a>
<a name="ln1478">       &quot;group-membership|type-7|link|intra-prefix) self-originated &quot;</a>
<a name="ln1479">       &quot;linkstate-id A.B.C.D (detail|dump|internal)&quot;,</a>
<a name="ln1480">       SHOW_STR</a>
<a name="ln1481">       IPV6_STR</a>
<a name="ln1482">       OSPF6_STR</a>
<a name="ln1483">       &quot;Display Link state database\n&quot;</a>
<a name="ln1484">       &quot;Display Router LSAs\n&quot;</a>
<a name="ln1485">       &quot;Display Network LSAs\n&quot;</a>
<a name="ln1486">       &quot;Display Inter-Area-Prefix LSAs\n&quot;</a>
<a name="ln1487">       &quot;Display Inter-Area-Router LSAs\n&quot;</a>
<a name="ln1488">       &quot;Display As-External LSAs\n&quot;</a>
<a name="ln1489">       &quot;Display Group-Membership LSAs\n&quot;</a>
<a name="ln1490">       &quot;Display Type-7 LSAs\n&quot;</a>
<a name="ln1491">       &quot;Display Link LSAs\n&quot;</a>
<a name="ln1492">       &quot;Display Intra-Area-Prefix LSAs\n&quot;</a>
<a name="ln1493">       &quot;Display Self-originated LSAs\n&quot;</a>
<a name="ln1494">       &quot;Search by Link state ID\n&quot;</a>
<a name="ln1495">       &quot;Specify Link state ID as IPv4 address notation\n&quot;</a>
<a name="ln1496">       &quot;Display details of LSAs\n&quot;</a>
<a name="ln1497">       &quot;Dump LSAs\n&quot;</a>
<a name="ln1498">       &quot;Display LSA's internal information\n&quot;</a>
<a name="ln1499">      )</a>
<a name="ln1500"> </a>
<a name="ln1501">DEFUN (show_ipv6_ospf6_database_type_id_self_originated,</a>
<a name="ln1502">       show_ipv6_ospf6_database_type_id_self_originated_cmd,</a>
<a name="ln1503">       &quot;show ipv6 ospf6 database &quot;</a>
<a name="ln1504">       &quot;(router|network|inter-prefix|inter-router|as-external|&quot;</a>
<a name="ln1505">       &quot;group-membership|type-7|link|intra-prefix) A.B.C.D self-originated&quot;,</a>
<a name="ln1506">       SHOW_STR</a>
<a name="ln1507">       IPV6_STR</a>
<a name="ln1508">       OSPF6_STR</a>
<a name="ln1509">       &quot;Display Link state database\n&quot;</a>
<a name="ln1510">       &quot;Display Router LSAs\n&quot;</a>
<a name="ln1511">       &quot;Display Network LSAs\n&quot;</a>
<a name="ln1512">       &quot;Display Inter-Area-Prefix LSAs\n&quot;</a>
<a name="ln1513">       &quot;Display Inter-Area-Router LSAs\n&quot;</a>
<a name="ln1514">       &quot;Display As-External LSAs\n&quot;</a>
<a name="ln1515">       &quot;Display Group-Membership LSAs\n&quot;</a>
<a name="ln1516">       &quot;Display Type-7 LSAs\n&quot;</a>
<a name="ln1517">       &quot;Display Link LSAs\n&quot;</a>
<a name="ln1518">       &quot;Display Intra-Area-Prefix LSAs\n&quot;</a>
<a name="ln1519">       &quot;Specify Link state ID as IPv4 address notation\n&quot;</a>
<a name="ln1520">       &quot;Display Self-originated LSAs\n&quot;</a>
<a name="ln1521">      )</a>
<a name="ln1522">{</a>
<a name="ln1523">  int level;</a>
<a name="ln1524">  struct listnode *i, *j;</a>
<a name="ln1525">  struct ospf6 *o = ospf6;</a>
<a name="ln1526">  struct ospf6_area *oa;</a>
<a name="ln1527">  struct ospf6_interface *oi;</a>
<a name="ln1528">  u_int16_t type = 0;</a>
<a name="ln1529">  u_int32_t adv_router = 0;</a>
<a name="ln1530">  u_int32_t id = 0;</a>
<a name="ln1531"> </a>
<a name="ln1532">  OSPF6_CMD_CHECK_RUNNING ();</a>
<a name="ln1533"> </a>
<a name="ln1534">  type = parse_type_spec (argc, argv);</a>
<a name="ln1535">  argc--;</a>
<a name="ln1536">  argv++;</a>
<a name="ln1537"> </a>
<a name="ln1538">  if ((inet_pton (AF_INET, argv[0], &amp;id)) != 1)</a>
<a name="ln1539">    {</a>
<a name="ln1540">      vty_out (vty, &quot;Link State ID is not parsable: %s%s&quot;,</a>
<a name="ln1541">               argv[0], VNL);</a>
<a name="ln1542">      return CMD_SUCCESS;</a>
<a name="ln1543">    }</a>
<a name="ln1544"> </a>
<a name="ln1545">  argc--;</a>
<a name="ln1546">  argv++;</a>
<a name="ln1547">  level = parse_show_level (argc, argv);</a>
<a name="ln1548"> </a>
<a name="ln1549">  adv_router = o-&gt;router_id;</a>
<a name="ln1550"> </a>
<a name="ln1551">  switch (OSPF6_LSA_SCOPE (type))</a>
<a name="ln1552">    {</a>
<a name="ln1553">      case OSPF6_SCOPE_AREA:</a>
<a name="ln1554">        for (ALL_LIST_ELEMENTS_RO (o-&gt;area_list, i, oa))</a>
<a name="ln1555">          {</a>
<a name="ln1556">            vty_out (vty, AREA_LSDB_TITLE_FORMAT, VNL, oa-&gt;name, VNL, VNL);</a>
<a name="ln1557">            ospf6_lsdb_show (vty, level, &amp;type, &amp;id, &amp;adv_router, oa-&gt;lsdb);</a>
<a name="ln1558">          }</a>
<a name="ln1559">        break;</a>
<a name="ln1560"> </a>
<a name="ln1561">      case OSPF6_SCOPE_LINKLOCAL:</a>
<a name="ln1562">        for (ALL_LIST_ELEMENTS_RO (o-&gt;area_list, i, oa))</a>
<a name="ln1563">          {</a>
<a name="ln1564">            for (ALL_LIST_ELEMENTS_RO (oa-&gt;if_list, j, oi))</a>
<a name="ln1565">              {</a>
<a name="ln1566">                vty_out (vty, IF_LSDB_TITLE_FORMAT, VNL,</a>
<a name="ln1567">                         oi-&gt;interface-&gt;name, oa-&gt;name, VNL, VNL);</a>
<a name="ln1568">                ospf6_lsdb_show (vty, level, &amp;type, &amp;id, &amp;adv_router, oi-&gt;lsdb);</a>
<a name="ln1569">              }</a>
<a name="ln1570">          }</a>
<a name="ln1571">        break;</a>
<a name="ln1572"> </a>
<a name="ln1573">      case OSPF6_SCOPE_AS:</a>
<a name="ln1574">        vty_out (vty, AS_LSDB_TITLE_FORMAT, VNL, VNL, VNL);</a>
<a name="ln1575">        ospf6_lsdb_show (vty, level, &amp;type, &amp;id, &amp;adv_router, o-&gt;lsdb);</a>
<a name="ln1576">        break;</a>
<a name="ln1577"> </a>
<a name="ln1578">      default:</a>
<a name="ln1579">        assert (0);</a>
<a name="ln1580">        break;</a>
<a name="ln1581">    }</a>
<a name="ln1582"> </a>
<a name="ln1583">  vty_out (vty, &quot;%s&quot;, VNL);</a>
<a name="ln1584">  return CMD_SUCCESS;</a>
<a name="ln1585">}</a>
<a name="ln1586"> </a>
<a name="ln1587">ALIAS (show_ipv6_ospf6_database_type_id_self_originated,</a>
<a name="ln1588">       show_ipv6_ospf6_database_type_id_self_originated_detail_cmd,</a>
<a name="ln1589">       &quot;show ipv6 ospf6 database &quot;</a>
<a name="ln1590">       &quot;(router|network|inter-prefix|inter-router|as-external|&quot;</a>
<a name="ln1591">       &quot;group-membership|type-7|link|intra-prefix) A.B.C.D self-originated &quot;</a>
<a name="ln1592">       &quot;(detail|dump|internal)&quot;,</a>
<a name="ln1593">       SHOW_STR</a>
<a name="ln1594">       IPV6_STR</a>
<a name="ln1595">       OSPF6_STR</a>
<a name="ln1596">       &quot;Display Link state database\n&quot;</a>
<a name="ln1597">       &quot;Display Router LSAs\n&quot;</a>
<a name="ln1598">       &quot;Display Network LSAs\n&quot;</a>
<a name="ln1599">       &quot;Display Inter-Area-Prefix LSAs\n&quot;</a>
<a name="ln1600">       &quot;Display Inter-Area-Router LSAs\n&quot;</a>
<a name="ln1601">       &quot;Display As-External LSAs\n&quot;</a>
<a name="ln1602">       &quot;Display Group-Membership LSAs\n&quot;</a>
<a name="ln1603">       &quot;Display Type-7 LSAs\n&quot;</a>
<a name="ln1604">       &quot;Display Link LSAs\n&quot;</a>
<a name="ln1605">       &quot;Display Intra-Area-Prefix LSAs\n&quot;</a>
<a name="ln1606">       &quot;Display Self-originated LSAs\n&quot;</a>
<a name="ln1607">       &quot;Search by Link state ID\n&quot;</a>
<a name="ln1608">       &quot;Specify Link state ID as IPv4 address notation\n&quot;</a>
<a name="ln1609">       &quot;Display details of LSAs\n&quot;</a>
<a name="ln1610">       &quot;Dump LSAs\n&quot;</a>
<a name="ln1611">       &quot;Display LSA's internal information\n&quot;</a>
<a name="ln1612">      )</a>
<a name="ln1613"> </a>
<a name="ln1614"> </a>
<a name="ln1615">DEFUN (show_ipv6_ospf6_border_routers,</a>
<a name="ln1616">       show_ipv6_ospf6_border_routers_cmd,</a>
<a name="ln1617">       &quot;show ipv6 ospf6 border-routers&quot;,</a>
<a name="ln1618">       SHOW_STR</a>
<a name="ln1619">       IP6_STR</a>
<a name="ln1620">       OSPF6_STR</a>
<a name="ln1621">       &quot;Display routing table for ABR and ASBR\n&quot;</a>
<a name="ln1622">      )</a>
<a name="ln1623">{</a>
<a name="ln1624">  u_int32_t adv_router;</a>
<a name="ln1625">  void (*showfunc) (struct vty *, struct ospf6_route *);</a>
<a name="ln1626">  struct ospf6_route *ro;</a>
<a name="ln1627">  struct prefix prefix;</a>
<a name="ln1628"> </a>
<a name="ln1629">  OSPF6_CMD_CHECK_RUNNING ();</a>
<a name="ln1630"> </a>
<a name="ln1631">  if (argc &amp;&amp; ! strcmp (&quot;detail&quot;, argv[0]))</a>
<a name="ln1632">    {</a>
<a name="ln1633">      showfunc = ospf6_route_show_detail;</a>
<a name="ln1634">      argc--;</a>
<a name="ln1635">      argv++;</a>
<a name="ln1636">    }</a>
<a name="ln1637">  else</a>
<a name="ln1638">    showfunc = ospf6_brouter_show;</a>
<a name="ln1639"> </a>
<a name="ln1640">  if (argc)</a>
<a name="ln1641">    {</a>
<a name="ln1642">      if ((inet_pton (AF_INET, argv[0], &amp;adv_router)) != 1)</a>
<a name="ln1643">        {</a>
<a name="ln1644">          vty_out (vty, &quot;Router ID is not parsable: %s%s&quot;, argv[0], VNL);</a>
<a name="ln1645">          return CMD_SUCCESS;</a>
<a name="ln1646">        }</a>
<a name="ln1647"> </a>
<a name="ln1648">      ospf6_linkstate_prefix (adv_router, 0, &amp;prefix);</a>
<a name="ln1649">      ro = ospf6_route_lookup (&amp;prefix, ospf6-&gt;brouter_table);</a>
<a name="ln1650">      if (!ro)</a>
<a name="ln1651">        {</a>
<a name="ln1652">          vty_out (vty, &quot;No Route found for Router ID: %s%s&quot;, argv[0], VNL);</a>
<a name="ln1653">          return CMD_SUCCESS;</a>
<a name="ln1654">        }</a>
<a name="ln1655"> </a>
<a name="ln1656">      ospf6_route_show_detail (vty, ro);</a>
<a name="ln1657">      return CMD_SUCCESS;</a>
<a name="ln1658">    }</a>
<a name="ln1659"> </a>
<a name="ln1660">  if (showfunc == ospf6_brouter_show)</a>
<a name="ln1661">    ospf6_brouter_show_header (vty);</a>
<a name="ln1662"> </a>
<a name="ln1663">  for (ro = ospf6_route_head (ospf6-&gt;brouter_table); ro;</a>
<a name="ln1664">       ro = ospf6_route_next (ro))</a>
<a name="ln1665">    (*showfunc) (vty, ro);</a>
<a name="ln1666"> </a>
<a name="ln1667">  return CMD_SUCCESS;</a>
<a name="ln1668">}</a>
<a name="ln1669"> </a>
<a name="ln1670">ALIAS (show_ipv6_ospf6_border_routers,</a>
<a name="ln1671">       show_ipv6_ospf6_border_routers_detail_cmd,</a>
<a name="ln1672">       &quot;show ipv6 ospf6 border-routers (A.B.C.D|detail)&quot;,</a>
<a name="ln1673">       SHOW_STR</a>
<a name="ln1674">       IP6_STR</a>
<a name="ln1675">       OSPF6_STR</a>
<a name="ln1676">       &quot;Display routing table for ABR and ASBR\n&quot;</a>
<a name="ln1677">       &quot;Specify Router-ID\n&quot;</a>
<a name="ln1678">       &quot;Display Detail\n&quot;</a>
<a name="ln1679">      )</a>
<a name="ln1680"> </a>
<a name="ln1681">DEFUN (show_ipv6_ospf6_linkstate,</a>
<a name="ln1682">       show_ipv6_ospf6_linkstate_cmd,</a>
<a name="ln1683">       &quot;show ipv6 ospf6 linkstate&quot;,</a>
<a name="ln1684">       SHOW_STR</a>
<a name="ln1685">       IP6_STR</a>
<a name="ln1686">       OSPF6_STR</a>
<a name="ln1687">       &quot;Display linkstate routing table\n&quot;</a>
<a name="ln1688">      )</a>
<a name="ln1689">{</a>
<a name="ln1690">  struct listnode *node;</a>
<a name="ln1691">  struct ospf6_area *oa;</a>
<a name="ln1692"> </a>
<a name="ln1693">  OSPF6_CMD_CHECK_RUNNING ();</a>
<a name="ln1694"> </a>
<a name="ln1695">  for (ALL_LIST_ELEMENTS_RO (ospf6-&gt;area_list, node, oa))</a>
<a name="ln1696">    {</a>
<a name="ln1697">      vty_out (vty, &quot;%s        SPF Result in Area %s%s%s&quot;,</a>
<a name="ln1698">               VNL, oa-&gt;name, VNL, VNL);</a>
<a name="ln1699">      ospf6_linkstate_table_show (vty, argc, argv, oa-&gt;spf_table);</a>
<a name="ln1700">    }</a>
<a name="ln1701"> </a>
<a name="ln1702">  vty_out (vty, &quot;%s&quot;, VNL);</a>
<a name="ln1703">  return CMD_SUCCESS;</a>
<a name="ln1704">}</a>
<a name="ln1705"> </a>
<a name="ln1706">ALIAS (show_ipv6_ospf6_linkstate,</a>
<a name="ln1707">       show_ipv6_ospf6_linkstate_router_cmd,</a>
<a name="ln1708">       &quot;show ipv6 ospf6 linkstate router A.B.C.D&quot;,</a>
<a name="ln1709">       SHOW_STR</a>
<a name="ln1710">       IP6_STR</a>
<a name="ln1711">       OSPF6_STR</a>
<a name="ln1712">       &quot;Display linkstate routing table\n&quot;</a>
<a name="ln1713">       &quot;Display Router Entry\n&quot;</a>
<a name="ln1714">       &quot;Specify Router ID as IPv4 address notation\n&quot;</a>
<a name="ln1715">      )</a>
<a name="ln1716"> </a>
<a name="ln1717">ALIAS (show_ipv6_ospf6_linkstate,</a>
<a name="ln1718">       show_ipv6_ospf6_linkstate_network_cmd,</a>
<a name="ln1719">       &quot;show ipv6 ospf6 linkstate network A.B.C.D A.B.C.D&quot;,</a>
<a name="ln1720">       SHOW_STR</a>
<a name="ln1721">       IP6_STR</a>
<a name="ln1722">       OSPF6_STR</a>
<a name="ln1723">       &quot;Display linkstate routing table\n&quot;</a>
<a name="ln1724">       &quot;Display Network Entry\n&quot;</a>
<a name="ln1725">       &quot;Specify Router ID as IPv4 address notation\n&quot;</a>
<a name="ln1726">       &quot;Specify Link state ID as IPv4 address notation\n&quot;</a>
<a name="ln1727">      )</a>
<a name="ln1728"> </a>
<a name="ln1729">DEFUN (show_ipv6_ospf6_linkstate_detail,</a>
<a name="ln1730">       show_ipv6_ospf6_linkstate_detail_cmd,</a>
<a name="ln1731">       &quot;show ipv6 ospf6 linkstate detail&quot;,</a>
<a name="ln1732">       SHOW_STR</a>
<a name="ln1733">       IP6_STR</a>
<a name="ln1734">       OSPF6_STR</a>
<a name="ln1735">       &quot;Display linkstate routing table\n&quot;</a>
<a name="ln1736">      )</a>
<a name="ln1737">{</a>
<a name="ln1738">  const char *sargv[CMD_ARGC_MAX];</a>
<a name="ln1739">  int i, sargc;</a>
<a name="ln1740">  struct listnode *node;</a>
<a name="ln1741">  struct ospf6_area *oa;</a>
<a name="ln1742"> </a>
<a name="ln1743">  OSPF6_CMD_CHECK_RUNNING ();</a>
<a name="ln1744"> </a>
<a name="ln1745">  /* copy argv to sargv and then append &quot;detail&quot; */</a>
<a name="ln1746">  for (i = 0; i &lt; argc; i++)</a>
<a name="ln1747">    sargv[i] = argv[i];</a>
<a name="ln1748">  sargc = argc;</a>
<a name="ln1749">  sargv[sargc++] = &quot;detail&quot;;</a>
<a name="ln1750">  sargv[sargc] = NULL;</a>
<a name="ln1751"> </a>
<a name="ln1752">  for (ALL_LIST_ELEMENTS_RO (ospf6-&gt;area_list, node, oa))</a>
<a name="ln1753">    {</a>
<a name="ln1754">      vty_out (vty, &quot;%s        SPF Result in Area %s%s%s&quot;,</a>
<a name="ln1755">               VNL, oa-&gt;name, VNL, VNL);</a>
<a name="ln1756">      ospf6_linkstate_table_show (vty, sargc, sargv, oa-&gt;spf_table);</a>
<a name="ln1757">    }</a>
<a name="ln1758"> </a>
<a name="ln1759">  vty_out (vty, &quot;%s&quot;, VNL);</a>
<a name="ln1760">  return CMD_SUCCESS;</a>
<a name="ln1761">}</a>
<a name="ln1762"> </a>
<a name="ln1763">/* Install ospf related commands. */</a>
<a name="ln1764">void</a>
<a name="ln1765">ospf6_init (void)</a>
<a name="ln1766">{</a>
<a name="ln1767">  ospf6_top_init ();</a>
<a name="ln1768">  ospf6_area_init ();</a>
<a name="ln1769">  ospf6_interface_init ();</a>
<a name="ln1770">  ospf6_neighbor_init ();</a>
<a name="ln1771">  ospf6_zebra_init (master);</a>
<a name="ln1772"> </a>
<a name="ln1773">  ospf6_lsa_init ();</a>
<a name="ln1774">  ospf6_spf_init ();</a>
<a name="ln1775">  ospf6_intra_init ();</a>
<a name="ln1776">  ospf6_asbr_init ();</a>
<a name="ln1777">  ospf6_abr_init ();</a>
<a name="ln1778"> </a>
<a name="ln1779">#ifdef HAVE_SNMP</a>
<a name="ln1780">  ospf6_snmp_init (master);</a>
<a name="ln1781">#endif /*HAVE_SNMP*/</a>
<a name="ln1782"> </a>
<a name="ln1783">  install_node (&amp;debug_node, config_write_ospf6_debug);</a>
<a name="ln1784"> </a>
<a name="ln1785">  install_element_ospf6_debug_message ();</a>
<a name="ln1786">  install_element_ospf6_debug_lsa ();</a>
<a name="ln1787">  install_element_ospf6_debug_interface ();</a>
<a name="ln1788">  install_element_ospf6_debug_neighbor ();</a>
<a name="ln1789">  install_element_ospf6_debug_zebra ();</a>
<a name="ln1790">  install_element_ospf6_debug_spf ();</a>
<a name="ln1791">  install_element_ospf6_debug_route ();</a>
<a name="ln1792">  install_element_ospf6_debug_brouter ();</a>
<a name="ln1793">  install_element_ospf6_debug_asbr ();</a>
<a name="ln1794">  install_element_ospf6_debug_abr ();</a>
<a name="ln1795">  install_element_ospf6_debug_flood ();</a>
<a name="ln1796"> </a>
<a name="ln1797">  install_element_ospf6_clear_interface ();</a>
<a name="ln1798"> </a>
<a name="ln1799">  install_element (VIEW_NODE, &amp;show_version_ospf6_cmd);</a>
<a name="ln1800"> </a>
<a name="ln1801">  install_element (VIEW_NODE, &amp;show_ipv6_ospf6_border_routers_cmd);</a>
<a name="ln1802">  install_element (VIEW_NODE, &amp;show_ipv6_ospf6_border_routers_detail_cmd);</a>
<a name="ln1803"> </a>
<a name="ln1804">  install_element (VIEW_NODE, &amp;show_ipv6_ospf6_linkstate_cmd);</a>
<a name="ln1805">  install_element (VIEW_NODE, &amp;show_ipv6_ospf6_linkstate_router_cmd);</a>
<a name="ln1806">  install_element (VIEW_NODE, &amp;show_ipv6_ospf6_linkstate_network_cmd);</a>
<a name="ln1807">  install_element (VIEW_NODE, &amp;show_ipv6_ospf6_linkstate_detail_cmd);</a>
<a name="ln1808"> </a>
<a name="ln1809">#define INSTALL(n,c) \</a>
<a name="ln1810">  install_element (n ## _NODE, &amp;show_ipv6_ospf6_ ## c)</a>
<a name="ln1811"> </a>
<a name="ln1812">  INSTALL (VIEW, database_cmd);</a>
<a name="ln1813">  INSTALL (VIEW, database_detail_cmd);</a>
<a name="ln1814">  INSTALL (VIEW, database_type_cmd);</a>
<a name="ln1815">  INSTALL (VIEW, database_type_detail_cmd);</a>
<a name="ln1816">  INSTALL (VIEW, database_id_cmd);</a>
<a name="ln1817">  INSTALL (VIEW, database_id_detail_cmd);</a>
<a name="ln1818">  INSTALL (VIEW, database_linkstate_id_cmd);</a>
<a name="ln1819">  INSTALL (VIEW, database_linkstate_id_detail_cmd);</a>
<a name="ln1820">  INSTALL (VIEW, database_router_cmd);</a>
<a name="ln1821">  INSTALL (VIEW, database_router_detail_cmd);</a>
<a name="ln1822">  INSTALL (VIEW, database_adv_router_cmd);</a>
<a name="ln1823">  INSTALL (VIEW, database_adv_router_detail_cmd);</a>
<a name="ln1824">  INSTALL (VIEW, database_type_id_cmd);</a>
<a name="ln1825">  INSTALL (VIEW, database_type_id_detail_cmd);</a>
<a name="ln1826">  INSTALL (VIEW, database_type_linkstate_id_cmd);</a>
<a name="ln1827">  INSTALL (VIEW, database_type_linkstate_id_detail_cmd);</a>
<a name="ln1828">  INSTALL (VIEW, database_type_router_cmd);</a>
<a name="ln1829">  INSTALL (VIEW, database_type_router_detail_cmd);</a>
<a name="ln1830">  INSTALL (VIEW, database_type_adv_router_cmd);</a>
<a name="ln1831">  INSTALL (VIEW, database_type_adv_router_detail_cmd);</a>
<a name="ln1832">  INSTALL (VIEW, database_adv_router_linkstate_id_cmd);</a>
<a name="ln1833">  INSTALL (VIEW, database_adv_router_linkstate_id_detail_cmd);</a>
<a name="ln1834">  INSTALL (VIEW, database_id_router_cmd);</a>
<a name="ln1835">  INSTALL (VIEW, database_id_router_detail_cmd);</a>
<a name="ln1836">  INSTALL (VIEW, database_type_id_router_cmd);</a>
<a name="ln1837">  INSTALL (VIEW, database_type_id_router_detail_cmd);</a>
<a name="ln1838">  INSTALL (VIEW, database_type_adv_router_linkstate_id_cmd);</a>
<a name="ln1839">  INSTALL (VIEW, database_type_adv_router_linkstate_id_detail_cmd);</a>
<a name="ln1840">  INSTALL (VIEW, database_self_originated_cmd);</a>
<a name="ln1841">  INSTALL (VIEW, database_self_originated_detail_cmd);</a>
<a name="ln1842">  INSTALL (VIEW, database_type_self_originated_cmd);</a>
<a name="ln1843">  INSTALL (VIEW, database_type_self_originated_detail_cmd);</a>
<a name="ln1844">  INSTALL (VIEW, database_type_id_self_originated_cmd);</a>
<a name="ln1845">  INSTALL (VIEW, database_type_id_self_originated_detail_cmd);</a>
<a name="ln1846">  INSTALL (VIEW, database_type_self_originated_linkstate_id_cmd);</a>
<a name="ln1847">  INSTALL (VIEW, database_type_self_originated_linkstate_id_detail_cmd);</a>
<a name="ln1848"> </a>
<a name="ln1849">  /* Make ospf protocol socket. */</a>
<a name="ln1850">  ospf6_serv_sock ();</a>
<a name="ln1851">  thread_add_read (master, ospf6_receive, NULL, ospf6_sock);</a>
<a name="ln1852">}</a>
<a name="ln1853"> </a>
<a name="ln1854">void</a>
<a name="ln1855">ospf6_clean (void)</a>
<a name="ln1856">{</a>
<a name="ln1857">  if (!ospf6)</a>
<a name="ln1858">    return;</a>
<a name="ln1859">  if (ospf6-&gt;route_table)</a>
<a name="ln1860">    ospf6_route_remove_all (ospf6-&gt;route_table);</a>
<a name="ln1861">  if (ospf6-&gt;brouter_table)</a>
<a name="ln1862">    ospf6_route_remove_all (ospf6-&gt;brouter_table);</a>
<a name="ln1863">}</a>

</code></pre>
<div class="balloon" rel="7"><p><span style="font-size:18px">&uarr;</span> <a href="https://pvs-studio.com/en/docs/warnings/v1042/" target="_blank">V1042</a> This file is marked with copyleft license, which requires you to open the derived source code.</p></div>

<link rel="stylesheet" href="highlight.css">
<script src="highlight.pack.js"></script>
<script src="highlightjs-line-numbers.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
<script>hljs.initLineNumbersOnLoad();</script>
<script>
  $(document).ready(function() {
      $('.balloon').each(function () {
          var bl = $(this);
          var line = bl.attr('rel');
          var text = $('a[name="ln'+line+'"]').text();

          var space_count = 0;
          for(var i = 0; i<text.length; i++){
              var char = text[i];
              if((char !== ' ')&&(char !== '\t'))break;
              if(char === '\t')space_count++;
              space_count++;
          }

          bl.css('margin-left', space_count*8);
          $('a[name="ln'+line+'"]').after(bl);
      });

      window.location = window.location;
  });
</script>
</body>
</html>
