
<html>
<head>

  <meta http-equiv="Content-Type" content="text/html; charset=US-ASCII" />
  <title>ospf_dump.c</title>

  <link rel="stylesheet" href="../style.css"/>
  <script src="../jquery-3.5.1.min.js"></script>
</head>
<body>

<pre><code class = "cpp">
<a name="ln1">/*</a>
<a name="ln2"> * OSPFd dump routine.</a>
<a name="ln3"> * Copyright (C) 1999, 2000 Toshiaki Takada</a>
<a name="ln4"> *</a>
<a name="ln5"> * This file is part of GNU Zebra.</a>
<a name="ln6"> *</a>
<a name="ln7"> * GNU Zebra is free software; you can redistribute it and/or modify it</a>
<a name="ln8"> * under the terms of the GNU General Public License as published by the</a>
<a name="ln9"> * Free Software Foundation; either version 2, or (at your option) any</a>
<a name="ln10"> * later version.</a>
<a name="ln11"> *</a>
<a name="ln12"> * GNU Zebra is distributed in the hope that it will be useful, but</a>
<a name="ln13"> * WITHOUT ANY WARRANTY; without even the implied warranty of</a>
<a name="ln14"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</a>
<a name="ln15"> * General Public License for more details.</a>
<a name="ln16"> *</a>
<a name="ln17"> * You should have received a copy of the GNU General Public License</a>
<a name="ln18"> * along with GNU Zebra; see the file COPYING.  If not, write to the</a>
<a name="ln19"> * Free Software Foundation, Inc., 59 Temple Place - Suite 330,</a>
<a name="ln20"> * Boston, MA 02111-1307, USA. </a>
<a name="ln21"> */</a>
<a name="ln22"> </a>
<a name="ln23">#include &lt;zebra.h&gt;</a>
<a name="ln24"> </a>
<a name="ln25">#include &quot;linklist.h&quot;</a>
<a name="ln26">#include &quot;thread.h&quot;</a>
<a name="ln27">#include &quot;prefix.h&quot;</a>
<a name="ln28">#include &quot;command.h&quot;</a>
<a name="ln29">#include &quot;stream.h&quot;</a>
<a name="ln30">#include &quot;log.h&quot;</a>
<a name="ln31">#include &quot;sockopt.h&quot;</a>
<a name="ln32"> </a>
<a name="ln33">#include &quot;ospfd/ospfd.h&quot;</a>
<a name="ln34">#include &quot;ospfd/ospf_interface.h&quot;</a>
<a name="ln35">#include &quot;ospfd/ospf_ism.h&quot;</a>
<a name="ln36">#include &quot;ospfd/ospf_asbr.h&quot;</a>
<a name="ln37">#include &quot;ospfd/ospf_lsa.h&quot;</a>
<a name="ln38">#include &quot;ospfd/ospf_lsdb.h&quot;</a>
<a name="ln39">#include &quot;ospfd/ospf_neighbor.h&quot;</a>
<a name="ln40">#include &quot;ospfd/ospf_nsm.h&quot;</a>
<a name="ln41">#include &quot;ospfd/ospf_dump.h&quot;</a>
<a name="ln42">#include &quot;ospfd/ospf_packet.h&quot;</a>
<a name="ln43">#include &quot;ospfd/ospf_network.h&quot;</a>
<a name="ln44"> </a>
<a name="ln45">const struct message ospf_ism_state_msg[] =</a>
<a name="ln46">{</a>
<a name="ln47">  { ISM_DependUpon,   &quot;DependUpon&quot; },</a>
<a name="ln48">  { ISM_Down,         &quot;Down&quot; },</a>
<a name="ln49">  { ISM_Loopback,     &quot;Loopback&quot; },</a>
<a name="ln50">  { ISM_Waiting,      &quot;Waiting&quot; },</a>
<a name="ln51">  { ISM_PointToPoint, &quot;Point-To-Point&quot; },</a>
<a name="ln52">  { ISM_DROther,      &quot;DROther&quot; },</a>
<a name="ln53">  { ISM_Backup,       &quot;Backup&quot; },</a>
<a name="ln54">  { ISM_DR,           &quot;DR&quot; },</a>
<a name="ln55">};</a>
<a name="ln56">const int ospf_ism_state_msg_max = OSPF_ISM_STATE_MAX;</a>
<a name="ln57"> </a>
<a name="ln58">const struct message ospf_nsm_state_msg[] =</a>
<a name="ln59">{</a>
<a name="ln60">  { NSM_DependUpon, &quot;DependUpon&quot; },</a>
<a name="ln61">  { NSM_Deleted,    &quot;Deleted&quot;    },</a>
<a name="ln62">  { NSM_Down,       &quot;Down&quot; },</a>
<a name="ln63">  { NSM_Attempt,    &quot;Attempt&quot; },</a>
<a name="ln64">  { NSM_Init,       &quot;Init&quot; },</a>
<a name="ln65">  { NSM_TwoWay,     &quot;2-Way&quot; },</a>
<a name="ln66">  { NSM_ExStart,    &quot;ExStart&quot; },</a>
<a name="ln67">  { NSM_Exchange,   &quot;Exchange&quot; },</a>
<a name="ln68">  { NSM_Loading,    &quot;Loading&quot; },</a>
<a name="ln69">  { NSM_Full,       &quot;Full&quot; },</a>
<a name="ln70">};</a>
<a name="ln71">const int ospf_nsm_state_msg_max = OSPF_NSM_STATE_MAX;</a>
<a name="ln72"> </a>
<a name="ln73">const struct message ospf_lsa_type_msg[] =</a>
<a name="ln74">{</a>
<a name="ln75">  { OSPF_UNKNOWN_LSA,      &quot;unknown&quot; },</a>
<a name="ln76">  { OSPF_ROUTER_LSA,       &quot;router-LSA&quot; },</a>
<a name="ln77">  { OSPF_NETWORK_LSA,      &quot;network-LSA&quot; },</a>
<a name="ln78">  { OSPF_SUMMARY_LSA,      &quot;summary-LSA&quot; },</a>
<a name="ln79">  { OSPF_ASBR_SUMMARY_LSA, &quot;summary-LSA&quot; },</a>
<a name="ln80">  { OSPF_AS_EXTERNAL_LSA,  &quot;AS-external-LSA&quot; },</a>
<a name="ln81">  { OSPF_GROUP_MEMBER_LSA, &quot;GROUP MEMBER LSA&quot; },</a>
<a name="ln82">  { OSPF_AS_NSSA_LSA,      &quot;NSSA-LSA&quot; },</a>
<a name="ln83">  { 8,                     &quot;Type-8 LSA&quot; },</a>
<a name="ln84">  { OSPF_OPAQUE_LINK_LSA,  &quot;Link-Local Opaque-LSA&quot; },</a>
<a name="ln85">  { OSPF_OPAQUE_AREA_LSA,  &quot;Area-Local Opaque-LSA&quot; },</a>
<a name="ln86">  { OSPF_OPAQUE_AS_LSA,    &quot;AS-external Opaque-LSA&quot; },</a>
<a name="ln87">};</a>
<a name="ln88">const int ospf_lsa_type_msg_max = OSPF_MAX_LSA;</a>
<a name="ln89"> </a>
<a name="ln90">const struct message ospf_link_state_id_type_msg[] =</a>
<a name="ln91">{</a>
<a name="ln92">  { OSPF_UNKNOWN_LSA,      &quot;(unknown)&quot; },</a>
<a name="ln93">  { OSPF_ROUTER_LSA,       &quot;&quot; },</a>
<a name="ln94">  { OSPF_NETWORK_LSA,      &quot;(address of Designated Router)&quot; },</a>
<a name="ln95">  { OSPF_SUMMARY_LSA,      &quot;(summary Network Number)&quot; },</a>
<a name="ln96">  { OSPF_ASBR_SUMMARY_LSA, &quot;(AS Boundary Router address)&quot; },</a>
<a name="ln97">  { OSPF_AS_EXTERNAL_LSA,  &quot;(External Network Number)&quot; },</a>
<a name="ln98">  { OSPF_GROUP_MEMBER_LSA, &quot;(Group membership information)&quot; },</a>
<a name="ln99">  { OSPF_AS_NSSA_LSA,      &quot;(External Network Number for NSSA)&quot; },</a>
<a name="ln100">  { 8,                     &quot;(Type-8 LSID)&quot; },</a>
<a name="ln101">  { OSPF_OPAQUE_LINK_LSA,  &quot;(Link-Local Opaque-Type/ID)&quot; },</a>
<a name="ln102">  { OSPF_OPAQUE_AREA_LSA,  &quot;(Area-Local Opaque-Type/ID)&quot; },</a>
<a name="ln103">  { OSPF_OPAQUE_AS_LSA,    &quot;(AS-external Opaque-Type/ID)&quot; },</a>
<a name="ln104">};</a>
<a name="ln105">const int ospf_link_state_id_type_msg_max = OSPF_MAX_LSA;</a>
<a name="ln106"> </a>
<a name="ln107">const struct message ospf_network_type_msg[] =</a>
<a name="ln108">{</a>
<a name="ln109">  { OSPF_IFTYPE_NONE,		  &quot;NONE&quot; },</a>
<a name="ln110">  { OSPF_IFTYPE_POINTOPOINT,      &quot;Point-to-Point&quot; },</a>
<a name="ln111">  { OSPF_IFTYPE_BROADCAST,        &quot;Broadcast&quot; },</a>
<a name="ln112">  { OSPF_IFTYPE_NBMA,             &quot;NBMA&quot; },</a>
<a name="ln113">  { OSPF_IFTYPE_POINTOMULTIPOINT, &quot;Point-to-MultiPoint&quot; },</a>
<a name="ln114">  { OSPF_IFTYPE_VIRTUALLINK,      &quot;Virtual-Link&quot; },</a>
<a name="ln115">};</a>
<a name="ln116">const int ospf_network_type_msg_max = OSPF_IFTYPE_MAX;</a>
<a name="ln117"> </a>
<a name="ln118">/* AuType */</a>
<a name="ln119">const struct message ospf_auth_type_str[] =</a>
<a name="ln120">{</a>
<a name="ln121">  { OSPF_AUTH_NULL,          &quot;Null&quot;          },</a>
<a name="ln122">  { OSPF_AUTH_SIMPLE,        &quot;Simple&quot;        },</a>
<a name="ln123">  { OSPF_AUTH_CRYPTOGRAPHIC, &quot;Cryptographic&quot; },</a>
<a name="ln124">};</a>
<a name="ln125">const size_t ospf_auth_type_str_max = sizeof (ospf_auth_type_str) /</a>
<a name="ln126">  sizeof (ospf_auth_type_str[0]);</a>
<a name="ln127"> </a>
<a name="ln128">/* Configuration debug option variables. */</a>
<a name="ln129">unsigned long conf_debug_ospf_packet[5] = {0, 0, 0, 0, 0};</a>
<a name="ln130">unsigned long conf_debug_ospf_event = 0;</a>
<a name="ln131">unsigned long conf_debug_ospf_ism = 0;</a>
<a name="ln132">unsigned long conf_debug_ospf_nsm = 0;</a>
<a name="ln133">unsigned long conf_debug_ospf_lsa = 0;</a>
<a name="ln134">unsigned long conf_debug_ospf_zebra = 0;</a>
<a name="ln135">unsigned long conf_debug_ospf_nssa = 0;</a>
<a name="ln136">unsigned long conf_debug_ospf_te = 0;</a>
<a name="ln137"> </a>
<a name="ln138">/* Enable debug option variables -- valid only session. */</a>
<a name="ln139">unsigned long term_debug_ospf_packet[5] = {0, 0, 0, 0, 0};</a>
<a name="ln140">unsigned long term_debug_ospf_event = 0;</a>
<a name="ln141">unsigned long term_debug_ospf_ism = 0;</a>
<a name="ln142">unsigned long term_debug_ospf_nsm = 0;</a>
<a name="ln143">unsigned long term_debug_ospf_lsa = 0;</a>
<a name="ln144">unsigned long term_debug_ospf_zebra = 0;</a>
<a name="ln145">unsigned long term_debug_ospf_nssa = 0;</a>
<a name="ln146">unsigned long term_debug_ospf_te = 0;</a>
<a name="ln147"> </a>
<a name="ln148"> </a>
<a name="ln149">const char *</a>
<a name="ln150">ospf_redist_string(u_int route_type)</a>
<a name="ln151">{</a>
<a name="ln152">  return (route_type == ZEBRA_ROUTE_MAX) ?</a>
<a name="ln153">  	 &quot;Default&quot; : zebra_route_string(route_type);</a>
<a name="ln154">}</a>
<a name="ln155"> </a>
<a name="ln156">#define OSPF_AREA_STRING_MAXLEN  16</a>
<a name="ln157">const char *</a>
<a name="ln158">ospf_area_name_string (struct ospf_area *area)</a>
<a name="ln159">{</a>
<a name="ln160">  static char buf[OSPF_AREA_STRING_MAXLEN] = &quot;&quot;;</a>
<a name="ln161">  u_int32_t area_id;</a>
<a name="ln162"> </a>
<a name="ln163">  if (!area)</a>
<a name="ln164">    return &quot;-&quot;;</a>
<a name="ln165"> </a>
<a name="ln166">  area_id = ntohl (area-&gt;area_id.s_addr);</a>
<a name="ln167">  snprintf (buf, OSPF_AREA_STRING_MAXLEN, &quot;%d.%d.%d.%d&quot;,</a>
<a name="ln168">            (area_id &gt;&gt; 24) &amp; 0xff, (area_id &gt;&gt; 16) &amp; 0xff,</a>
<a name="ln169">            (area_id &gt;&gt; 8) &amp; 0xff, area_id &amp; 0xff);</a>
<a name="ln170">  return buf;</a>
<a name="ln171">}</a>
<a name="ln172"> </a>
<a name="ln173">#define OSPF_AREA_DESC_STRING_MAXLEN  23</a>
<a name="ln174">const char *</a>
<a name="ln175">ospf_area_desc_string (struct ospf_area *area)</a>
<a name="ln176">{</a>
<a name="ln177">  static char buf[OSPF_AREA_DESC_STRING_MAXLEN] = &quot;&quot;;</a>
<a name="ln178">  u_char type;</a>
<a name="ln179"> </a>
<a name="ln180">  if (!area)</a>
<a name="ln181">    return &quot;(incomplete)&quot;;</a>
<a name="ln182"> </a>
<a name="ln183">  type = area-&gt;external_routing;</a>
<a name="ln184">  switch (type)</a>
<a name="ln185">    {</a>
<a name="ln186">    case OSPF_AREA_NSSA:</a>
<a name="ln187">      snprintf (buf, OSPF_AREA_DESC_STRING_MAXLEN, &quot;%s [NSSA]&quot;,</a>
<a name="ln188">                ospf_area_name_string (area));</a>
<a name="ln189">      break;</a>
<a name="ln190">    case OSPF_AREA_STUB:</a>
<a name="ln191">      snprintf (buf, OSPF_AREA_DESC_STRING_MAXLEN, &quot;%s [Stub]&quot;,</a>
<a name="ln192">                ospf_area_name_string (area));</a>
<a name="ln193">      break;</a>
<a name="ln194">    default:</a>
<a name="ln195">      return ospf_area_name_string (area);</a>
<a name="ln196">    }</a>
<a name="ln197"> </a>
<a name="ln198">  return buf;</a>
<a name="ln199">}</a>
<a name="ln200"> </a>
<a name="ln201">#define OSPF_IF_STRING_MAXLEN  40</a>
<a name="ln202">const char *</a>
<a name="ln203">ospf_if_name_string (struct ospf_interface *oi)</a>
<a name="ln204">{</a>
<a name="ln205">  static char buf[OSPF_IF_STRING_MAXLEN] = &quot;&quot;;</a>
<a name="ln206">  u_int32_t ifaddr;</a>
<a name="ln207"> </a>
<a name="ln208">  if (!oi)</a>
<a name="ln209">    return &quot;inactive&quot;;</a>
<a name="ln210"> </a>
<a name="ln211">  if (oi-&gt;type == OSPF_IFTYPE_VIRTUALLINK)</a>
<a name="ln212">    return oi-&gt;ifp-&gt;name;</a>
<a name="ln213"> </a>
<a name="ln214">  ifaddr = ntohl (oi-&gt;address-&gt;u.prefix4.s_addr);</a>
<a name="ln215">  snprintf (buf, OSPF_IF_STRING_MAXLEN,</a>
<a name="ln216">            &quot;%s:%d.%d.%d.%d&quot;, oi-&gt;ifp-&gt;name,</a>
<a name="ln217">            (ifaddr &gt;&gt; 24) &amp; 0xff, (ifaddr &gt;&gt; 16) &amp; 0xff,</a>
<a name="ln218">            (ifaddr &gt;&gt; 8) &amp; 0xff, ifaddr &amp; 0xff);</a>
<a name="ln219">  return buf;</a>
<a name="ln220">}</a>
<a name="ln221"> </a>
<a name="ln222"> </a>
<a name="ln223">void</a>
<a name="ln224">ospf_nbr_state_message (struct ospf_neighbor *nbr, char *buf, size_t size)</a>
<a name="ln225">{</a>
<a name="ln226">  int state;</a>
<a name="ln227">  struct ospf_interface *oi = nbr-&gt;oi;</a>
<a name="ln228"> </a>
<a name="ln229">  if (IPV4_ADDR_SAME (&amp;DR (oi), &amp;nbr-&gt;address.u.prefix4))</a>
<a name="ln230">    state = ISM_DR;</a>
<a name="ln231">  else if (IPV4_ADDR_SAME (&amp;BDR (oi), &amp;nbr-&gt;address.u.prefix4))</a>
<a name="ln232">    state = ISM_Backup;</a>
<a name="ln233">  else</a>
<a name="ln234">    state = ISM_DROther;</a>
<a name="ln235"> </a>
<a name="ln236">  memset (buf, 0, size);</a>
<a name="ln237"> </a>
<a name="ln238">  snprintf (buf, size, &quot;%s/%s&quot;,</a>
<a name="ln239">	    LOOKUP (ospf_nsm_state_msg, nbr-&gt;state),</a>
<a name="ln240">	    LOOKUP (ospf_ism_state_msg, state));</a>
<a name="ln241">}</a>
<a name="ln242"> </a>
<a name="ln243">const char *</a>
<a name="ln244">ospf_timeval_dump (struct timeval *t, char *buf, size_t size)</a>
<a name="ln245">{</a>
<a name="ln246">  /* Making formatted timer strings. */</a>
<a name="ln247">#define MINUTE_IN_SECONDS	60</a>
<a name="ln248">#define HOUR_IN_SECONDS		(60*MINUTE_IN_SECONDS)</a>
<a name="ln249">#define DAY_IN_SECONDS		(24*HOUR_IN_SECONDS)</a>
<a name="ln250">#define WEEK_IN_SECONDS		(7*DAY_IN_SECONDS)</a>
<a name="ln251">  unsigned long w, d, h, m, s, ms, us;</a>
<a name="ln252">  </a>
<a name="ln253">  if (!t)</a>
<a name="ln254">    return &quot;inactive&quot;;</a>
<a name="ln255">  </a>
<a name="ln256">  w = d = h = m = s = ms = us = 0;</a>
<a name="ln257">  memset (buf, 0, size);</a>
<a name="ln258"> </a>
<a name="ln259">  us = t-&gt;tv_usec;</a>
<a name="ln260">  if (us &gt;= 1000)</a>
<a name="ln261">    {</a>
<a name="ln262">      ms = us / 1000;</a>
<a name="ln263">      us %= 1000;</a>
<a name="ln264">    }</a>
<a name="ln265"> </a>
<a name="ln266">  if (ms &gt;= 1000)</a>
<a name="ln267">    {</a>
<a name="ln268">      t-&gt;tv_sec += ms / 1000;</a>
<a name="ln269">      ms %= 1000;</a>
<a name="ln270">    }</a>
<a name="ln271">  </a>
<a name="ln272">  if (t-&gt;tv_sec &gt; WEEK_IN_SECONDS)</a>
<a name="ln273">    {</a>
<a name="ln274">      w = t-&gt;tv_sec / WEEK_IN_SECONDS;</a>
<a name="ln275">      t-&gt;tv_sec -= w * WEEK_IN_SECONDS;</a>
<a name="ln276">    }</a>
<a name="ln277">  </a>
<a name="ln278">  if (t-&gt;tv_sec &gt; DAY_IN_SECONDS)</a>
<a name="ln279">    {</a>
<a name="ln280">      d = t-&gt;tv_sec / DAY_IN_SECONDS;</a>
<a name="ln281">      t-&gt;tv_sec -= d * DAY_IN_SECONDS;</a>
<a name="ln282">    }</a>
<a name="ln283">  </a>
<a name="ln284">  if (t-&gt;tv_sec &gt;= HOUR_IN_SECONDS)</a>
<a name="ln285">    {</a>
<a name="ln286">      h = t-&gt;tv_sec / HOUR_IN_SECONDS;</a>
<a name="ln287">      t-&gt;tv_sec -= h * HOUR_IN_SECONDS;</a>
<a name="ln288">    }</a>
<a name="ln289">  </a>
<a name="ln290">  if (t-&gt;tv_sec &gt;= MINUTE_IN_SECONDS)</a>
<a name="ln291">    {</a>
<a name="ln292">      m = t-&gt;tv_sec / MINUTE_IN_SECONDS;</a>
<a name="ln293">      t-&gt;tv_sec -= m * MINUTE_IN_SECONDS;</a>
<a name="ln294">    }</a>
<a name="ln295">  </a>
<a name="ln296">  if (w &gt; 99)</a>
<a name="ln297">    snprintf (buf, size, &quot;%ldw%1ldd&quot;, w, d);</a>
<a name="ln298">  else if (w)</a>
<a name="ln299">    snprintf (buf, size, &quot;%ldw%1ldd%02ldh&quot;, w, d, h);</a>
<a name="ln300">  else if (d)</a>
<a name="ln301">    snprintf (buf, size, &quot;%1ldd%02ldh%02ldm&quot;, d, h, m);</a>
<a name="ln302">  else if (h)</a>
<a name="ln303">    snprintf (buf, size, &quot;%ldh%02ldm%02lds&quot;, h, m, (long)t-&gt;tv_sec);</a>
<a name="ln304">  else if (m)</a>
<a name="ln305">    snprintf (buf, size, &quot;%ldm%02lds&quot;, m, (long)t-&gt;tv_sec);</a>
<a name="ln306">  else if (ms)</a>
<a name="ln307">    snprintf (buf, size, &quot;%ld.%03lds&quot;, (long)t-&gt;tv_sec, ms);</a>
<a name="ln308">  else</a>
<a name="ln309">    snprintf (buf, size, &quot;%ld usecs&quot;, (long)t-&gt;tv_usec);</a>
<a name="ln310"> </a>
<a name="ln311">  return buf;</a>
<a name="ln312">}</a>
<a name="ln313"> </a>
<a name="ln314">const char *</a>
<a name="ln315">ospf_timer_dump (struct thread *t, char *buf, size_t size)</a>
<a name="ln316">{</a>
<a name="ln317">  struct timeval result;</a>
<a name="ln318">  if (!t)</a>
<a name="ln319">    return &quot;inactive&quot;;</a>
<a name="ln320">  </a>
<a name="ln321">  result = tv_sub (t-&gt;u.sands, recent_relative_time());</a>
<a name="ln322">  return ospf_timeval_dump (&amp;result, buf, size);</a>
<a name="ln323">}</a>
<a name="ln324"> </a>
<a name="ln325">#define OSPF_OPTION_STR_MAXLEN		24</a>
<a name="ln326"> </a>
<a name="ln327">char *</a>
<a name="ln328">ospf_options_dump (u_char options)</a>
<a name="ln329">{</a>
<a name="ln330">  static char buf[OSPF_OPTION_STR_MAXLEN];</a>
<a name="ln331"> </a>
<a name="ln332">  snprintf (buf, OSPF_OPTION_STR_MAXLEN, &quot;*|%s|%s|%s|%s|%s|%s|%s&quot;,</a>
<a name="ln333">	    (options &amp; OSPF_OPTION_O) ? &quot;O&quot; : &quot;-&quot;,</a>
<a name="ln334">	    (options &amp; OSPF_OPTION_DC) ? &quot;DC&quot; : &quot;-&quot;,</a>
<a name="ln335">	    (options &amp; OSPF_OPTION_EA) ? &quot;EA&quot; : &quot;-&quot;,</a>
<a name="ln336">	    (options &amp; OSPF_OPTION_NP) ? &quot;N/P&quot; : &quot;-&quot;,</a>
<a name="ln337">	    (options &amp; OSPF_OPTION_MC) ? &quot;MC&quot; : &quot;-&quot;,</a>
<a name="ln338">           (options &amp; OSPF_OPTION_E) ? &quot;E&quot; : &quot;-&quot;,</a>
<a name="ln339">           (options &amp; OSPF_OPTION_MT) ? &quot;M/T&quot; : &quot;-&quot;);</a>
<a name="ln340"> </a>
<a name="ln341">  return buf;</a>
<a name="ln342">}</a>
<a name="ln343"> </a>
<a name="ln344">static void</a>
<a name="ln345">ospf_packet_hello_dump (struct stream *s, u_int16_t length)</a>
<a name="ln346">{</a>
<a name="ln347">  struct ospf_hello *hello;</a>
<a name="ln348">  int i;</a>
<a name="ln349"> </a>
<a name="ln350">  hello = (struct ospf_hello *) STREAM_PNT (s);</a>
<a name="ln351"> </a>
<a name="ln352">  zlog_debug (&quot;Hello&quot;);</a>
<a name="ln353">  zlog_debug (&quot;  NetworkMask %s&quot;, inet_ntoa (hello-&gt;network_mask));</a>
<a name="ln354">  zlog_debug (&quot;  HelloInterval %d&quot;, ntohs (hello-&gt;hello_interval));</a>
<a name="ln355">  zlog_debug (&quot;  Options %d (%s)&quot;, hello-&gt;options,</a>
<a name="ln356">	     ospf_options_dump (hello-&gt;options));</a>
<a name="ln357">  zlog_debug (&quot;  RtrPriority %d&quot;, hello-&gt;priority);</a>
<a name="ln358">  zlog_debug (&quot;  RtrDeadInterval %ld&quot;, (u_long)ntohl (hello-&gt;dead_interval));</a>
<a name="ln359">  zlog_debug (&quot;  DRouter %s&quot;, inet_ntoa (hello-&gt;d_router));</a>
<a name="ln360">  zlog_debug (&quot;  BDRouter %s&quot;, inet_ntoa (hello-&gt;bd_router));</a>
<a name="ln361"> </a>
<a name="ln362">  length -= OSPF_HEADER_SIZE + OSPF_HELLO_MIN_SIZE;</a>
<a name="ln363">  zlog_debug (&quot;  # Neighbors %d&quot;, length / 4);</a>
<a name="ln364">  for (i = 0; length &gt; 0; i++, length -= sizeof (struct in_addr))</a>
<a name="ln365">    zlog_debug (&quot;    Neighbor %s&quot;, inet_ntoa (hello-&gt;neighbors[i]));</a>
<a name="ln366">}</a>
<a name="ln367"> </a>
<a name="ln368">static char *</a>
<a name="ln369">ospf_dd_flags_dump (u_char flags, char *buf, size_t size)</a>
<a name="ln370">{</a>
<a name="ln371">  memset (buf, 0, size);</a>
<a name="ln372"> </a>
<a name="ln373">  snprintf (buf, size, &quot;%s|%s|%s&quot;,</a>
<a name="ln374">	    (flags &amp; OSPF_DD_FLAG_I) ? &quot;I&quot; : &quot;-&quot;,</a>
<a name="ln375">	    (flags &amp; OSPF_DD_FLAG_M) ? &quot;M&quot; : &quot;-&quot;,</a>
<a name="ln376">	    (flags &amp; OSPF_DD_FLAG_MS) ? &quot;MS&quot; : &quot;-&quot;);</a>
<a name="ln377"> </a>
<a name="ln378">  return buf;</a>
<a name="ln379">}</a>
<a name="ln380"> </a>
<a name="ln381">void</a>
<a name="ln382">ospf_lsa_header_dump (struct lsa_header *lsah)</a>
<a name="ln383">{</a>
<a name="ln384">  const char *lsah_type = LOOKUP (ospf_lsa_type_msg, lsah-&gt;type);</a>
<a name="ln385">  </a>
<a name="ln386">  zlog_debug (&quot;  LSA Header&quot;);</a>
<a name="ln387">  zlog_debug (&quot;    LS age %d&quot;, ntohs (lsah-&gt;ls_age));</a>
<a name="ln388">  zlog_debug (&quot;    Options %d (%s)&quot;, lsah-&gt;options,</a>
<a name="ln389">	     ospf_options_dump (lsah-&gt;options));</a>
<a name="ln390">  zlog_debug (&quot;    LS type %d (%s)&quot;, lsah-&gt;type,</a>
<a name="ln391">             (lsah-&gt;type ? lsah_type : &quot;unknown type&quot;));</a>
<a name="ln392">  zlog_debug (&quot;    Link State ID %s&quot;, inet_ntoa (lsah-&gt;id));</a>
<a name="ln393">  zlog_debug (&quot;    Advertising Router %s&quot;, inet_ntoa (lsah-&gt;adv_router));</a>
<a name="ln394">  zlog_debug (&quot;    LS sequence number 0x%lx&quot;, (u_long)ntohl (lsah-&gt;ls_seqnum));</a>
<a name="ln395">  zlog_debug (&quot;    LS checksum 0x%x&quot;, ntohs (lsah-&gt;checksum));</a>
<a name="ln396">  zlog_debug (&quot;    length %d&quot;, ntohs (lsah-&gt;length));</a>
<a name="ln397">}</a>
<a name="ln398"> </a>
<a name="ln399">static char *</a>
<a name="ln400">ospf_router_lsa_flags_dump (u_char flags, char *buf, size_t size)</a>
<a name="ln401">{</a>
<a name="ln402">  memset (buf, 0, size);</a>
<a name="ln403"> </a>
<a name="ln404">  snprintf (buf, size, &quot;%s|%s|%s&quot;,</a>
<a name="ln405">	    (flags &amp; ROUTER_LSA_VIRTUAL) ? &quot;V&quot; : &quot;-&quot;,</a>
<a name="ln406">	    (flags &amp; ROUTER_LSA_EXTERNAL) ? &quot;E&quot; : &quot;-&quot;,</a>
<a name="ln407">	    (flags &amp; ROUTER_LSA_BORDER) ? &quot;B&quot; : &quot;-&quot;);</a>
<a name="ln408"> </a>
<a name="ln409">  return buf;</a>
<a name="ln410">}</a>
<a name="ln411"> </a>
<a name="ln412">static void</a>
<a name="ln413">ospf_router_lsa_dump (struct stream *s, u_int16_t length)</a>
<a name="ln414">{</a>
<a name="ln415">  char buf[BUFSIZ];</a>
<a name="ln416">  struct router_lsa *rl;</a>
<a name="ln417">  int i, len;</a>
<a name="ln418"> </a>
<a name="ln419">  rl = (struct router_lsa *) STREAM_PNT (s);</a>
<a name="ln420"> </a>
<a name="ln421">  zlog_debug (&quot;  Router-LSA&quot;);</a>
<a name="ln422">  zlog_debug (&quot;    flags %s&quot;, </a>
<a name="ln423">	     ospf_router_lsa_flags_dump (rl-&gt;flags, buf, BUFSIZ));</a>
<a name="ln424">  zlog_debug (&quot;    # links %d&quot;, ntohs (rl-&gt;links));</a>
<a name="ln425"> </a>
<a name="ln426">  len = ntohs (rl-&gt;header.length) - OSPF_LSA_HEADER_SIZE - 4;</a>
<a name="ln427">  for (i = 0; len &gt; 0; i++)</a>
<a name="ln428">    {</a>
<a name="ln429">      zlog_debug (&quot;    Link ID %s&quot;, inet_ntoa (rl-&gt;link[i].link_id));</a>
<a name="ln430">      zlog_debug (&quot;    Link Data %s&quot;, inet_ntoa (rl-&gt;link[i].link_data));</a>
<a name="ln431">      zlog_debug (&quot;    Type %d&quot;, (u_char) rl-&gt;link[i].type);</a>
<a name="ln432">      zlog_debug (&quot;    TOS %d&quot;, (u_char) rl-&gt;link[i].tos);</a>
<a name="ln433">      zlog_debug (&quot;    metric %d&quot;, ntohs (rl-&gt;link[i].metric));</a>
<a name="ln434"> </a>
<a name="ln435">      len -= 12;</a>
<a name="ln436">    }</a>
<a name="ln437">}</a>
<a name="ln438"> </a>
<a name="ln439">static void</a>
<a name="ln440">ospf_network_lsa_dump (struct stream *s, u_int16_t length)</a>
<a name="ln441">{</a>
<a name="ln442">  struct network_lsa *nl;</a>
<a name="ln443">  int i, cnt;</a>
<a name="ln444"> </a>
<a name="ln445">  nl = (struct network_lsa *) STREAM_PNT (s);</a>
<a name="ln446">  cnt = (ntohs (nl-&gt;header.length) - (OSPF_LSA_HEADER_SIZE + 4)) / 4;</a>
<a name="ln447">  </a>
<a name="ln448">  zlog_debug (&quot;  Network-LSA&quot;);</a>
<a name="ln449">  /*</a>
<a name="ln450">  zlog_debug (&quot;LSA total size %d&quot;, ntohs (nl-&gt;header.length));</a>
<a name="ln451">  zlog_debug (&quot;Network-LSA size %d&quot;, </a>
<a name="ln452">  ntohs (nl-&gt;header.length) - OSPF_LSA_HEADER_SIZE);</a>
<a name="ln453">  */</a>
<a name="ln454">  zlog_debug (&quot;    Network Mask %s&quot;, inet_ntoa (nl-&gt;mask));</a>
<a name="ln455">  zlog_debug (&quot;    # Attached Routers %d&quot;, cnt);</a>
<a name="ln456">  for (i = 0; i &lt; cnt; i++)</a>
<a name="ln457">    zlog_debug (&quot;      Attached Router %s&quot;, inet_ntoa (nl-&gt;routers[i]));</a>
<a name="ln458">}</a>
<a name="ln459"> </a>
<a name="ln460">static void</a>
<a name="ln461">ospf_summary_lsa_dump (struct stream *s, u_int16_t length)</a>
<a name="ln462">{</a>
<a name="ln463">  struct summary_lsa *sl;</a>
<a name="ln464">  int size;</a>
<a name="ln465">  int i;</a>
<a name="ln466"> </a>
<a name="ln467">  sl = (struct summary_lsa *) STREAM_PNT (s);</a>
<a name="ln468"> </a>
<a name="ln469">  zlog_debug (&quot;  Summary-LSA&quot;);</a>
<a name="ln470">  zlog_debug (&quot;    Network Mask %s&quot;, inet_ntoa (sl-&gt;mask));</a>
<a name="ln471"> </a>
<a name="ln472">  size = ntohs (sl-&gt;header.length) - OSPF_LSA_HEADER_SIZE - 4;</a>
<a name="ln473">  for (i = 0; size &gt; 0; size -= 4, i++)</a>
<a name="ln474">    zlog_debug (&quot;    TOS=%d metric %d&quot;, sl-&gt;tos,</a>
<a name="ln475">	       GET_METRIC (sl-&gt;metric));</a>
<a name="ln476">}</a>
<a name="ln477"> </a>
<a name="ln478">static void</a>
<a name="ln479">ospf_as_external_lsa_dump (struct stream *s, u_int16_t length)</a>
<a name="ln480">{</a>
<a name="ln481">  struct as_external_lsa *al;</a>
<a name="ln482">  int size;</a>
<a name="ln483">  int i;</a>
<a name="ln484"> </a>
<a name="ln485">  al = (struct as_external_lsa *) STREAM_PNT (s);</a>
<a name="ln486">  zlog_debug (&quot;  %s&quot;, ospf_lsa_type_msg[al-&gt;header.type].str);</a>
<a name="ln487">  zlog_debug (&quot;    Network Mask %s&quot;, inet_ntoa (al-&gt;mask));</a>
<a name="ln488"> </a>
<a name="ln489">  size = ntohs (al-&gt;header.length) - OSPF_LSA_HEADER_SIZE -4;</a>
<a name="ln490">  for (i = 0; size &gt; 0; size -= 12, i++)</a>
<a name="ln491">    {</a>
<a name="ln492">      zlog_debug (&quot;    bit %s TOS=%d metric %d&quot;,</a>
<a name="ln493">		 IS_EXTERNAL_METRIC (al-&gt;e[i].tos) ? &quot;E&quot; : &quot;-&quot;,</a>
<a name="ln494">		 al-&gt;e[i].tos &amp; 0x7f, GET_METRIC (al-&gt;e[i].metric));</a>
<a name="ln495">      zlog_debug (&quot;    Forwarding address %s&quot;, inet_ntoa (al-&gt;e[i].fwd_addr));</a>
<a name="ln496">      zlog_debug (&quot;    External Route Tag %u&quot;, al-&gt;e[i].route_tag);</a>
<a name="ln497">    }</a>
<a name="ln498">}</a>
<a name="ln499"> </a>
<a name="ln500">static void</a>
<a name="ln501">ospf_lsa_header_list_dump (struct stream *s, u_int16_t length)</a>
<a name="ln502">{</a>
<a name="ln503">  struct lsa_header *lsa;</a>
<a name="ln504"> </a>
<a name="ln505">  zlog_debug (&quot;  # LSA Headers %d&quot;, length / OSPF_LSA_HEADER_SIZE);</a>
<a name="ln506"> </a>
<a name="ln507">  /* LSA Headers. */</a>
<a name="ln508">  while (length &gt; 0)</a>
<a name="ln509">    {</a>
<a name="ln510">      lsa = (struct lsa_header *) STREAM_PNT (s);</a>
<a name="ln511">      ospf_lsa_header_dump (lsa);</a>
<a name="ln512"> </a>
<a name="ln513">      stream_forward_getp (s, OSPF_LSA_HEADER_SIZE);</a>
<a name="ln514">      length -= OSPF_LSA_HEADER_SIZE;</a>
<a name="ln515">    }</a>
<a name="ln516">}</a>
<a name="ln517"> </a>
<a name="ln518">static void</a>
<a name="ln519">ospf_packet_db_desc_dump (struct stream *s, u_int16_t length)</a>
<a name="ln520">{</a>
<a name="ln521">  struct ospf_db_desc *dd;</a>
<a name="ln522">  char dd_flags[8];</a>
<a name="ln523"> </a>
<a name="ln524">  u_int32_t gp;</a>
<a name="ln525"> </a>
<a name="ln526">  gp = stream_get_getp (s);</a>
<a name="ln527">  dd = (struct ospf_db_desc *) STREAM_PNT (s);</a>
<a name="ln528"> </a>
<a name="ln529">  zlog_debug (&quot;Database Description&quot;);</a>
<a name="ln530">  zlog_debug (&quot;  Interface MTU %d&quot;, ntohs (dd-&gt;mtu));</a>
<a name="ln531">  zlog_debug (&quot;  Options %d (%s)&quot;, dd-&gt;options,</a>
<a name="ln532">	     ospf_options_dump (dd-&gt;options));</a>
<a name="ln533">  zlog_debug (&quot;  Flags %d (%s)&quot;, dd-&gt;flags,</a>
<a name="ln534">	     ospf_dd_flags_dump (dd-&gt;flags, dd_flags, sizeof dd_flags));</a>
<a name="ln535">  zlog_debug (&quot;  Sequence Number 0x%08lx&quot;, (u_long)ntohl (dd-&gt;dd_seqnum));</a>
<a name="ln536"> </a>
<a name="ln537">  length -= OSPF_HEADER_SIZE + OSPF_DB_DESC_MIN_SIZE;</a>
<a name="ln538"> </a>
<a name="ln539">  stream_forward_getp (s, OSPF_DB_DESC_MIN_SIZE);</a>
<a name="ln540"> </a>
<a name="ln541">  ospf_lsa_header_list_dump (s, length);</a>
<a name="ln542"> </a>
<a name="ln543">  stream_set_getp (s, gp);</a>
<a name="ln544">}</a>
<a name="ln545"> </a>
<a name="ln546">static void</a>
<a name="ln547">ospf_packet_ls_req_dump (struct stream *s, u_int16_t length)</a>
<a name="ln548">{</a>
<a name="ln549">  u_int32_t sp;</a>
<a name="ln550">  u_int32_t ls_type;</a>
<a name="ln551">  struct in_addr ls_id;</a>
<a name="ln552">  struct in_addr adv_router;</a>
<a name="ln553"> </a>
<a name="ln554">  sp = stream_get_getp (s);</a>
<a name="ln555"> </a>
<a name="ln556">  length -= OSPF_HEADER_SIZE;</a>
<a name="ln557"> </a>
<a name="ln558">  zlog_debug (&quot;Link State Request&quot;);</a>
<a name="ln559">  zlog_debug (&quot;  # Requests %d&quot;, length / 12);</a>
<a name="ln560"> </a>
<a name="ln561">  for (; length &gt; 0; length -= 12)</a>
<a name="ln562">    {</a>
<a name="ln563">      ls_type = stream_getl (s);</a>
<a name="ln564">      ls_id.s_addr = stream_get_ipv4 (s);</a>
<a name="ln565">      adv_router.s_addr = stream_get_ipv4 (s);</a>
<a name="ln566"> </a>
<a name="ln567">      zlog_debug (&quot;  LS type %d&quot;, ls_type);</a>
<a name="ln568">      zlog_debug (&quot;  Link State ID %s&quot;, inet_ntoa (ls_id));</a>
<a name="ln569">      zlog_debug (&quot;  Advertising Router %s&quot;,</a>
<a name="ln570">		 inet_ntoa (adv_router));</a>
<a name="ln571">    }</a>
<a name="ln572"> </a>
<a name="ln573">  stream_set_getp (s, sp);</a>
<a name="ln574">}</a>
<a name="ln575"> </a>
<a name="ln576">static void</a>
<a name="ln577">ospf_packet_ls_upd_dump (struct stream *s, u_int16_t length)</a>
<a name="ln578">{</a>
<a name="ln579">  u_int32_t sp;</a>
<a name="ln580">  struct lsa_header *lsa;</a>
<a name="ln581">  int lsa_len;</a>
<a name="ln582">  u_int32_t count;</a>
<a name="ln583"> </a>
<a name="ln584">  length -= OSPF_HEADER_SIZE;</a>
<a name="ln585"> </a>
<a name="ln586">  sp = stream_get_getp (s);</a>
<a name="ln587"> </a>
<a name="ln588">  count = stream_getl (s);</a>
<a name="ln589">  length -= 4;</a>
<a name="ln590"> </a>
<a name="ln591">  zlog_debug (&quot;Link State Update&quot;);</a>
<a name="ln592">  zlog_debug (&quot;  # LSAs %d&quot;, count);</a>
<a name="ln593"> </a>
<a name="ln594">  while (length &gt; 0 &amp;&amp; count &gt; 0)</a>
<a name="ln595">    {</a>
<a name="ln596">      if (length &lt; OSPF_HEADER_SIZE || length % 4 != 0)</a>
<a name="ln597">	{</a>
<a name="ln598">          zlog_debug (&quot;  Remaining %d bytes; Incorrect length.&quot;, length);</a>
<a name="ln599">	  break;</a>
<a name="ln600">	}</a>
<a name="ln601"> </a>
<a name="ln602">      lsa = (struct lsa_header *) STREAM_PNT (s);</a>
<a name="ln603">      lsa_len = ntohs (lsa-&gt;length);</a>
<a name="ln604">      ospf_lsa_header_dump (lsa);</a>
<a name="ln605"> </a>
<a name="ln606">      switch (lsa-&gt;type)</a>
<a name="ln607">	{</a>
<a name="ln608">	case OSPF_ROUTER_LSA:</a>
<a name="ln609">	  ospf_router_lsa_dump (s, length);</a>
<a name="ln610">	  break;</a>
<a name="ln611">	case OSPF_NETWORK_LSA:</a>
<a name="ln612">	  ospf_network_lsa_dump (s, length);</a>
<a name="ln613">	  break;</a>
<a name="ln614">	case OSPF_SUMMARY_LSA:</a>
<a name="ln615">	case OSPF_ASBR_SUMMARY_LSA:</a>
<a name="ln616">	  ospf_summary_lsa_dump (s, length);</a>
<a name="ln617">	  break;</a>
<a name="ln618">	case OSPF_AS_EXTERNAL_LSA:</a>
<a name="ln619">	  ospf_as_external_lsa_dump (s, length);</a>
<a name="ln620">	  break;</a>
<a name="ln621">	case OSPF_AS_NSSA_LSA:</a>
<a name="ln622">	  ospf_as_external_lsa_dump (s, length);</a>
<a name="ln623">	  break;</a>
<a name="ln624">	case OSPF_OPAQUE_LINK_LSA:</a>
<a name="ln625">	case OSPF_OPAQUE_AREA_LSA:</a>
<a name="ln626">	case OSPF_OPAQUE_AS_LSA:</a>
<a name="ln627">	  ospf_opaque_lsa_dump (s, length);</a>
<a name="ln628">	  break;</a>
<a name="ln629">	default:</a>
<a name="ln630">	  break;</a>
<a name="ln631">	}</a>
<a name="ln632"> </a>
<a name="ln633">      stream_forward_getp (s, lsa_len);</a>
<a name="ln634">      length -= lsa_len;</a>
<a name="ln635">      count--;</a>
<a name="ln636">    }</a>
<a name="ln637"> </a>
<a name="ln638">  stream_set_getp (s, sp);</a>
<a name="ln639">}</a>
<a name="ln640"> </a>
<a name="ln641">static void</a>
<a name="ln642">ospf_packet_ls_ack_dump (struct stream *s, u_int16_t length)</a>
<a name="ln643">{</a>
<a name="ln644">  u_int32_t sp;</a>
<a name="ln645"> </a>
<a name="ln646">  length -= OSPF_HEADER_SIZE;</a>
<a name="ln647">  sp = stream_get_getp (s);</a>
<a name="ln648"> </a>
<a name="ln649">  zlog_debug (&quot;Link State Acknowledgment&quot;);</a>
<a name="ln650">  ospf_lsa_header_list_dump (s, length);</a>
<a name="ln651"> </a>
<a name="ln652">  stream_set_getp (s, sp);</a>
<a name="ln653">}</a>
<a name="ln654"> </a>
<a name="ln655">/* Expects header to be in host order */</a>
<a name="ln656">void</a>
<a name="ln657">ospf_ip_header_dump (struct ip *iph)</a>
<a name="ln658">{</a>
<a name="ln659">  /* IP Header dump. */</a>
<a name="ln660">  zlog_debug (&quot;ip_v %d&quot;, iph-&gt;ip_v);</a>
<a name="ln661">  zlog_debug (&quot;ip_hl %d&quot;, iph-&gt;ip_hl);</a>
<a name="ln662">  zlog_debug (&quot;ip_tos %d&quot;, iph-&gt;ip_tos);</a>
<a name="ln663">  zlog_debug (&quot;ip_len %d&quot;, iph-&gt;ip_len);</a>
<a name="ln664">  zlog_debug (&quot;ip_id %u&quot;, (u_int32_t) iph-&gt;ip_id);</a>
<a name="ln665">  zlog_debug (&quot;ip_off %u&quot;, (u_int32_t) iph-&gt;ip_off);</a>
<a name="ln666">  zlog_debug (&quot;ip_ttl %d&quot;, iph-&gt;ip_ttl);</a>
<a name="ln667">  zlog_debug (&quot;ip_p %d&quot;, iph-&gt;ip_p);</a>
<a name="ln668">  zlog_debug (&quot;ip_sum 0x%x&quot;, (u_int32_t) iph-&gt;ip_sum);</a>
<a name="ln669">  zlog_debug (&quot;ip_src %s&quot;,  inet_ntoa (iph-&gt;ip_src));</a>
<a name="ln670">  zlog_debug (&quot;ip_dst %s&quot;, inet_ntoa (iph-&gt;ip_dst));</a>
<a name="ln671">}</a>
<a name="ln672"> </a>
<a name="ln673">static void</a>
<a name="ln674">ospf_header_dump (struct ospf_header *ospfh)</a>
<a name="ln675">{</a>
<a name="ln676">  char buf[9];</a>
<a name="ln677">  u_int16_t auth_type = ntohs (ospfh-&gt;auth_type);</a>
<a name="ln678"> </a>
<a name="ln679">  zlog_debug (&quot;Header&quot;);</a>
<a name="ln680">  zlog_debug (&quot;  Version %d&quot;, ospfh-&gt;version);</a>
<a name="ln681">  zlog_debug (&quot;  Type %d (%s)&quot;, ospfh-&gt;type,</a>
<a name="ln682">	     LOOKUP (ospf_packet_type_str, ospfh-&gt;type));</a>
<a name="ln683">  zlog_debug (&quot;  Packet Len %d&quot;, ntohs (ospfh-&gt;length));</a>
<a name="ln684">  zlog_debug (&quot;  Router ID %s&quot;, inet_ntoa (ospfh-&gt;router_id));</a>
<a name="ln685">  zlog_debug (&quot;  Area ID %s&quot;, inet_ntoa (ospfh-&gt;area_id));</a>
<a name="ln686">  zlog_debug (&quot;  Checksum 0x%x&quot;, ntohs (ospfh-&gt;checksum));</a>
<a name="ln687">  zlog_debug (&quot;  AuType %s&quot;, LOOKUP (ospf_auth_type_str, auth_type));</a>
<a name="ln688"> </a>
<a name="ln689">  switch (auth_type)</a>
<a name="ln690">    {</a>
<a name="ln691">    case OSPF_AUTH_NULL:</a>
<a name="ln692">      break;</a>
<a name="ln693">    case OSPF_AUTH_SIMPLE:</a>
<a name="ln694">      memset (buf, 0, 9);</a>
<a name="ln695">      strncpy (buf, (char *) ospfh-&gt;u.auth_data, 8);</a>
<a name="ln696">      zlog_debug (&quot;  Simple Password %s&quot;, buf);</a>
<a name="ln697">      break;</a>
<a name="ln698">    case OSPF_AUTH_CRYPTOGRAPHIC:</a>
<a name="ln699">      zlog_debug (&quot;  Cryptographic Authentication&quot;);</a>
<a name="ln700">      zlog_debug (&quot;  Key ID %d&quot;, ospfh-&gt;u.crypt.key_id);</a>
<a name="ln701">      zlog_debug (&quot;  Auth Data Len %d&quot;, ospfh-&gt;u.crypt.auth_data_len);</a>
<a name="ln702">      zlog_debug (&quot;  Sequence number %ld&quot;,</a>
<a name="ln703">		 (u_long)ntohl (ospfh-&gt;u.crypt.crypt_seqnum));</a>
<a name="ln704">      break;</a>
<a name="ln705">    default:</a>
<a name="ln706">      zlog_debug (&quot;* This is not supported authentication type&quot;);</a>
<a name="ln707">      break;</a>
<a name="ln708">    }</a>
<a name="ln709">    </a>
<a name="ln710">}</a>
<a name="ln711"> </a>
<a name="ln712">void</a>
<a name="ln713">ospf_packet_dump (struct stream *s)</a>
<a name="ln714">{</a>
<a name="ln715">  struct ospf_header *ospfh;</a>
<a name="ln716">  unsigned long gp;</a>
<a name="ln717"> </a>
<a name="ln718">  /* Preserve pointer. */</a>
<a name="ln719">  gp = stream_get_getp (s);</a>
<a name="ln720"> </a>
<a name="ln721">  /* OSPF Header dump. */</a>
<a name="ln722">  ospfh = (struct ospf_header *) STREAM_PNT (s);</a>
<a name="ln723"> </a>
<a name="ln724">  /* Until detail flag is set, return. */</a>
<a name="ln725">  if (!(term_debug_ospf_packet[ospfh-&gt;type - 1] &amp; OSPF_DEBUG_DETAIL))</a>
<a name="ln726">    return;</a>
<a name="ln727"> </a>
<a name="ln728">  /* Show OSPF header detail. */</a>
<a name="ln729">  ospf_header_dump (ospfh);</a>
<a name="ln730">  stream_forward_getp (s, OSPF_HEADER_SIZE);</a>
<a name="ln731"> </a>
<a name="ln732">  switch (ospfh-&gt;type)</a>
<a name="ln733">    {</a>
<a name="ln734">    case OSPF_MSG_HELLO:</a>
<a name="ln735">      ospf_packet_hello_dump (s, ntohs (ospfh-&gt;length));</a>
<a name="ln736">      break;</a>
<a name="ln737">    case OSPF_MSG_DB_DESC:</a>
<a name="ln738">      ospf_packet_db_desc_dump (s, ntohs (ospfh-&gt;length));</a>
<a name="ln739">      break;</a>
<a name="ln740">    case OSPF_MSG_LS_REQ:</a>
<a name="ln741">      ospf_packet_ls_req_dump (s, ntohs (ospfh-&gt;length));</a>
<a name="ln742">      break;</a>
<a name="ln743">    case OSPF_MSG_LS_UPD:</a>
<a name="ln744">      ospf_packet_ls_upd_dump (s, ntohs (ospfh-&gt;length));</a>
<a name="ln745">      break;</a>
<a name="ln746">    case OSPF_MSG_LS_ACK:</a>
<a name="ln747">      ospf_packet_ls_ack_dump (s, ntohs (ospfh-&gt;length));</a>
<a name="ln748">      break;</a>
<a name="ln749">    default:</a>
<a name="ln750">      break;</a>
<a name="ln751">    }</a>
<a name="ln752"> </a>
<a name="ln753">  stream_set_getp (s, gp);</a>
<a name="ln754">}</a>
<a name="ln755"> </a>
<a name="ln756"> </a>
<a name="ln757">/*</a>
<a name="ln758">   [no] debug ospf packet (hello|dd|ls-request|ls-update|ls-ack|all)</a>
<a name="ln759">                          [send|recv [detail]]</a>
<a name="ln760">*/</a>
<a name="ln761">DEFUN (debug_ospf_packet,</a>
<a name="ln762">       debug_ospf_packet_all_cmd,</a>
<a name="ln763">       &quot;debug ospf packet (hello|dd|ls-request|ls-update|ls-ack|all)&quot;,</a>
<a name="ln764">       DEBUG_STR</a>
<a name="ln765">       OSPF_STR</a>
<a name="ln766">       &quot;OSPF packets\n&quot;</a>
<a name="ln767">       &quot;OSPF Hello\n&quot;</a>
<a name="ln768">       &quot;OSPF Database Description\n&quot;</a>
<a name="ln769">       &quot;OSPF Link State Request\n&quot;</a>
<a name="ln770">       &quot;OSPF Link State Update\n&quot;</a>
<a name="ln771">       &quot;OSPF Link State Acknowledgment\n&quot;</a>
<a name="ln772">       &quot;OSPF all packets\n&quot;)</a>
<a name="ln773">{</a>
<a name="ln774">  int type = 0;</a>
<a name="ln775">  int flag = 0;</a>
<a name="ln776">  int i;</a>
<a name="ln777"> </a>
<a name="ln778">  assert (argc &gt; 0);</a>
<a name="ln779"> </a>
<a name="ln780">  /* Check packet type. */</a>
<a name="ln781">  if (strncmp (argv[0], &quot;h&quot;, 1) == 0)</a>
<a name="ln782">    type = OSPF_DEBUG_HELLO;</a>
<a name="ln783">  else if (strncmp (argv[0], &quot;d&quot;, 1) == 0)</a>
<a name="ln784">    type = OSPF_DEBUG_DB_DESC;</a>
<a name="ln785">  else if (strncmp (argv[0], &quot;ls-r&quot;, 4) == 0)</a>
<a name="ln786">    type = OSPF_DEBUG_LS_REQ;</a>
<a name="ln787">  else if (strncmp (argv[0], &quot;ls-u&quot;, 4) == 0)</a>
<a name="ln788">    type = OSPF_DEBUG_LS_UPD;</a>
<a name="ln789">  else if (strncmp (argv[0], &quot;ls-a&quot;, 4) == 0)</a>
<a name="ln790">    type = OSPF_DEBUG_LS_ACK;</a>
<a name="ln791">  else if (strncmp (argv[0], &quot;a&quot;, 1) == 0)</a>
<a name="ln792">    type = OSPF_DEBUG_ALL;</a>
<a name="ln793"> </a>
<a name="ln794">  /* Default, both send and recv. */</a>
<a name="ln795">  if (argc == 1)</a>
<a name="ln796">    flag = OSPF_DEBUG_SEND | OSPF_DEBUG_RECV;</a>
<a name="ln797"> </a>
<a name="ln798">  /* send or recv. */</a>
<a name="ln799">  if (argc &gt;= 2)</a>
<a name="ln800">    {</a>
<a name="ln801">      if (strncmp (argv[1], &quot;s&quot;, 1) == 0)</a>
<a name="ln802">	flag = OSPF_DEBUG_SEND;</a>
<a name="ln803">      else if (strncmp (argv[1], &quot;r&quot;, 1) == 0)</a>
<a name="ln804">	flag = OSPF_DEBUG_RECV;</a>
<a name="ln805">      else if (strncmp (argv[1], &quot;d&quot;, 1) == 0)</a>
<a name="ln806">	flag = OSPF_DEBUG_SEND | OSPF_DEBUG_RECV | OSPF_DEBUG_DETAIL;</a>
<a name="ln807">    }</a>
<a name="ln808"> </a>
<a name="ln809">  /* detail. */</a>
<a name="ln810">  if (argc == 3)</a>
<a name="ln811">    if (strncmp (argv[2], &quot;d&quot;, 1) == 0)</a>
<a name="ln812">      flag |= OSPF_DEBUG_DETAIL;</a>
<a name="ln813"> </a>
<a name="ln814">  for (i = 0; i &lt; 5; i++)</a>
<a name="ln815">    if (type &amp; (0x01 &lt;&lt; i))</a>
<a name="ln816">      {</a>
<a name="ln817">	if (vty-&gt;node == CONFIG_NODE)</a>
<a name="ln818">	  DEBUG_PACKET_ON (i, flag);</a>
<a name="ln819">	else</a>
<a name="ln820">	  TERM_DEBUG_PACKET_ON (i, flag);</a>
<a name="ln821">      }</a>
<a name="ln822"> </a>
<a name="ln823">  return CMD_SUCCESS;</a>
<a name="ln824">}</a>
<a name="ln825"> </a>
<a name="ln826">ALIAS (debug_ospf_packet,</a>
<a name="ln827">       debug_ospf_packet_send_recv_cmd,</a>
<a name="ln828">       &quot;debug ospf packet (hello|dd|ls-request|ls-update|ls-ack|all) (send|recv|detail)&quot;,</a>
<a name="ln829">       &quot;Debugging functions\n&quot;</a>
<a name="ln830">       &quot;OSPF information\n&quot;</a>
<a name="ln831">       &quot;OSPF packets\n&quot;</a>
<a name="ln832">       &quot;OSPF Hello\n&quot;</a>
<a name="ln833">       &quot;OSPF Database Description\n&quot;</a>
<a name="ln834">       &quot;OSPF Link State Request\n&quot;</a>
<a name="ln835">       &quot;OSPF Link State Update\n&quot;</a>
<a name="ln836">       &quot;OSPF Link State Acknowledgment\n&quot;</a>
<a name="ln837">       &quot;OSPF all packets\n&quot;</a>
<a name="ln838">       &quot;Packet sent\n&quot;</a>
<a name="ln839">       &quot;Packet received\n&quot;</a>
<a name="ln840">       &quot;Detail information\n&quot;)</a>
<a name="ln841"> </a>
<a name="ln842">ALIAS (debug_ospf_packet,</a>
<a name="ln843">       debug_ospf_packet_send_recv_detail_cmd,</a>
<a name="ln844">       &quot;debug ospf packet (hello|dd|ls-request|ls-update|ls-ack|all) (send|recv) (detail|)&quot;,</a>
<a name="ln845">       &quot;Debugging functions\n&quot;</a>
<a name="ln846">       &quot;OSPF information\n&quot;</a>
<a name="ln847">       &quot;OSPF packets\n&quot;</a>
<a name="ln848">       &quot;OSPF Hello\n&quot;</a>
<a name="ln849">       &quot;OSPF Database Description\n&quot;</a>
<a name="ln850">       &quot;OSPF Link State Request\n&quot;</a>
<a name="ln851">       &quot;OSPF Link State Update\n&quot;</a>
<a name="ln852">       &quot;OSPF Link State Acknowledgment\n&quot;</a>
<a name="ln853">       &quot;OSPF all packets\n&quot;</a>
<a name="ln854">       &quot;Packet sent\n&quot;</a>
<a name="ln855">       &quot;Packet received\n&quot;</a>
<a name="ln856">       &quot;Detail Information\n&quot;)</a>
<a name="ln857">       </a>
<a name="ln858"> </a>
<a name="ln859">DEFUN (no_debug_ospf_packet,</a>
<a name="ln860">       no_debug_ospf_packet_all_cmd,</a>
<a name="ln861">       &quot;no debug ospf packet (hello|dd|ls-request|ls-update|ls-ack|all)&quot;,</a>
<a name="ln862">       NO_STR</a>
<a name="ln863">       DEBUG_STR</a>
<a name="ln864">       OSPF_STR</a>
<a name="ln865">       &quot;OSPF packets\n&quot;</a>
<a name="ln866">       &quot;OSPF Hello\n&quot;</a>
<a name="ln867">       &quot;OSPF Database Description\n&quot;</a>
<a name="ln868">       &quot;OSPF Link State Request\n&quot;</a>
<a name="ln869">       &quot;OSPF Link State Update\n&quot;</a>
<a name="ln870">       &quot;OSPF Link State Acknowledgment\n&quot;</a>
<a name="ln871">       &quot;OSPF all packets\n&quot;)</a>
<a name="ln872">{</a>
<a name="ln873">  int type = 0;</a>
<a name="ln874">  int flag = 0;</a>
<a name="ln875">  int i;</a>
<a name="ln876"> </a>
<a name="ln877">  assert (argc &gt; 0);</a>
<a name="ln878"> </a>
<a name="ln879">  /* Check packet type. */</a>
<a name="ln880">  if (strncmp (argv[0], &quot;h&quot;, 1) == 0)</a>
<a name="ln881">    type = OSPF_DEBUG_HELLO;</a>
<a name="ln882">  else if (strncmp (argv[0], &quot;d&quot;, 1) == 0)</a>
<a name="ln883">    type = OSPF_DEBUG_DB_DESC;</a>
<a name="ln884">  else if (strncmp (argv[0], &quot;ls-r&quot;, 4) == 0)</a>
<a name="ln885">    type = OSPF_DEBUG_LS_REQ;</a>
<a name="ln886">  else if (strncmp (argv[0], &quot;ls-u&quot;, 4) == 0)</a>
<a name="ln887">    type = OSPF_DEBUG_LS_UPD;</a>
<a name="ln888">  else if (strncmp (argv[0], &quot;ls-a&quot;, 4) == 0)</a>
<a name="ln889">    type = OSPF_DEBUG_LS_ACK;</a>
<a name="ln890">  else if (strncmp (argv[0], &quot;a&quot;, 1) == 0)</a>
<a name="ln891">    type = OSPF_DEBUG_ALL;</a>
<a name="ln892"> </a>
<a name="ln893">  /* Default, both send and recv. */</a>
<a name="ln894">  if (argc == 1)</a>
<a name="ln895">    flag = OSPF_DEBUG_SEND | OSPF_DEBUG_RECV | OSPF_DEBUG_DETAIL ;</a>
<a name="ln896"> </a>
<a name="ln897">  /* send or recv. */</a>
<a name="ln898">  if (argc == 2)</a>
<a name="ln899">    {</a>
<a name="ln900">      if (strncmp (argv[1], &quot;s&quot;, 1) == 0)</a>
<a name="ln901">	flag = OSPF_DEBUG_SEND | OSPF_DEBUG_DETAIL;</a>
<a name="ln902">      else if (strncmp (argv[1], &quot;r&quot;, 1) == 0)</a>
<a name="ln903">	flag = OSPF_DEBUG_RECV | OSPF_DEBUG_DETAIL;</a>
<a name="ln904">      else if (strncmp (argv[1], &quot;d&quot;, 1) == 0)</a>
<a name="ln905">	flag = OSPF_DEBUG_SEND | OSPF_DEBUG_RECV | OSPF_DEBUG_DETAIL;</a>
<a name="ln906">    }</a>
<a name="ln907"> </a>
<a name="ln908">  /* detail. */</a>
<a name="ln909">  if (argc == 3)</a>
<a name="ln910">    if (strncmp (argv[2], &quot;d&quot;, 1) == 0)</a>
<a name="ln911">      flag = OSPF_DEBUG_DETAIL;</a>
<a name="ln912"> </a>
<a name="ln913">  for (i = 0; i &lt; 5; i++)</a>
<a name="ln914">    if (type &amp; (0x01 &lt;&lt; i))</a>
<a name="ln915">      {</a>
<a name="ln916">	if (vty-&gt;node == CONFIG_NODE)</a>
<a name="ln917">	  DEBUG_PACKET_OFF (i, flag);</a>
<a name="ln918">	else</a>
<a name="ln919">	  TERM_DEBUG_PACKET_OFF (i, flag);</a>
<a name="ln920">      }</a>
<a name="ln921"> </a>
<a name="ln922">#ifdef DEBUG</a>
<a name="ln923">  /*</a>
<a name="ln924">  for (i = 0; i &lt; 5; i++)</a>
<a name="ln925">    zlog_debug (&quot;flag[%d] = %d&quot;, i, ospf_debug_packet[i]);</a>
<a name="ln926">  */</a>
<a name="ln927">#endif /* DEBUG */</a>
<a name="ln928"> </a>
<a name="ln929">  return CMD_SUCCESS;</a>
<a name="ln930">}</a>
<a name="ln931"> </a>
<a name="ln932">ALIAS (no_debug_ospf_packet,</a>
<a name="ln933">       no_debug_ospf_packet_send_recv_cmd,</a>
<a name="ln934">       &quot;no debug ospf packet (hello|dd|ls-request|ls-update|ls-ack|all) (send|recv|detail)&quot;,</a>
<a name="ln935">       NO_STR</a>
<a name="ln936">       &quot;Debugging functions\n&quot;</a>
<a name="ln937">       &quot;OSPF information\n&quot;</a>
<a name="ln938">       &quot;OSPF packets\n&quot;</a>
<a name="ln939">       &quot;OSPF Hello\n&quot;</a>
<a name="ln940">       &quot;OSPF Database Description\n&quot;</a>
<a name="ln941">       &quot;OSPF Link State Request\n&quot;</a>
<a name="ln942">       &quot;OSPF Link State Update\n&quot;</a>
<a name="ln943">       &quot;OSPF Link State Acknowledgment\n&quot;</a>
<a name="ln944">       &quot;OSPF all packets\n&quot;</a>
<a name="ln945">       &quot;Packet sent\n&quot;</a>
<a name="ln946">       &quot;Packet received\n&quot;</a>
<a name="ln947">       &quot;Detail Information\n&quot;)</a>
<a name="ln948"> </a>
<a name="ln949">ALIAS (no_debug_ospf_packet,</a>
<a name="ln950">       no_debug_ospf_packet_send_recv_detail_cmd,</a>
<a name="ln951">       &quot;no debug ospf packet (hello|dd|ls-request|ls-update|ls-ack|all) (send|recv) (detail|)&quot;,</a>
<a name="ln952">       NO_STR</a>
<a name="ln953">       &quot;Debugging functions\n&quot;</a>
<a name="ln954">       &quot;OSPF information\n&quot;</a>
<a name="ln955">       &quot;OSPF packets\n&quot;</a>
<a name="ln956">       &quot;OSPF Hello\n&quot;</a>
<a name="ln957">       &quot;OSPF Database Description\n&quot;</a>
<a name="ln958">       &quot;OSPF Link State Request\n&quot;</a>
<a name="ln959">       &quot;OSPF Link State Update\n&quot;</a>
<a name="ln960">       &quot;OSPF Link State Acknowledgment\n&quot;</a>
<a name="ln961">       &quot;OSPF all packets\n&quot;</a>
<a name="ln962">       &quot;Packet sent\n&quot;</a>
<a name="ln963">       &quot;Packet received\n&quot;</a>
<a name="ln964">       &quot;Detail Information\n&quot;)</a>
<a name="ln965"> </a>
<a name="ln966"> </a>
<a name="ln967">DEFUN (debug_ospf_ism,</a>
<a name="ln968">       debug_ospf_ism_cmd,</a>
<a name="ln969">       &quot;debug ospf ism&quot;,</a>
<a name="ln970">       DEBUG_STR</a>
<a name="ln971">       OSPF_STR</a>
<a name="ln972">       &quot;OSPF Interface State Machine\n&quot;)</a>
<a name="ln973">{</a>
<a name="ln974">  if (vty-&gt;node == CONFIG_NODE)</a>
<a name="ln975">    {</a>
<a name="ln976">      if (argc == 0)</a>
<a name="ln977">	DEBUG_ON (ism, ISM);</a>
<a name="ln978">      else if (argc == 1)</a>
<a name="ln979">	{</a>
<a name="ln980">	  if (strncmp (argv[0], &quot;s&quot;, 1) == 0)</a>
<a name="ln981">	    DEBUG_ON (ism, ISM_STATUS);</a>
<a name="ln982">	  else if (strncmp (argv[0], &quot;e&quot;, 1) == 0)</a>
<a name="ln983">	    DEBUG_ON (ism, ISM_EVENTS);</a>
<a name="ln984">	  else if (strncmp (argv[0], &quot;t&quot;, 1) == 0)</a>
<a name="ln985">	    DEBUG_ON (ism, ISM_TIMERS);</a>
<a name="ln986">	}</a>
<a name="ln987"> </a>
<a name="ln988">      return CMD_SUCCESS;</a>
<a name="ln989">    }</a>
<a name="ln990"> </a>
<a name="ln991">  /* ENABLE_NODE. */</a>
<a name="ln992">  if (argc == 0)</a>
<a name="ln993">    TERM_DEBUG_ON (ism, ISM);</a>
<a name="ln994">  else if (argc == 1)</a>
<a name="ln995">    {</a>
<a name="ln996">      if (strncmp (argv[0], &quot;s&quot;, 1) == 0)</a>
<a name="ln997">	TERM_DEBUG_ON (ism, ISM_STATUS);</a>
<a name="ln998">      else if (strncmp (argv[0], &quot;e&quot;, 1) == 0)</a>
<a name="ln999">	TERM_DEBUG_ON (ism, ISM_EVENTS);</a>
<a name="ln1000">      else if (strncmp (argv[0], &quot;t&quot;, 1) == 0)</a>
<a name="ln1001">	TERM_DEBUG_ON (ism, ISM_TIMERS);</a>
<a name="ln1002">    }</a>
<a name="ln1003"> </a>
<a name="ln1004">  return CMD_SUCCESS;</a>
<a name="ln1005">}</a>
<a name="ln1006"> </a>
<a name="ln1007">ALIAS (debug_ospf_ism,</a>
<a name="ln1008">       debug_ospf_ism_sub_cmd,</a>
<a name="ln1009">       &quot;debug ospf ism (status|events|timers)&quot;,</a>
<a name="ln1010">       DEBUG_STR</a>
<a name="ln1011">       OSPF_STR</a>
<a name="ln1012">       &quot;OSPF Interface State Machine\n&quot;</a>
<a name="ln1013">       &quot;ISM Status Information\n&quot;</a>
<a name="ln1014">       &quot;ISM Event Information\n&quot;</a>
<a name="ln1015">       &quot;ISM TImer Information\n&quot;)</a>
<a name="ln1016"> </a>
<a name="ln1017">DEFUN (no_debug_ospf_ism,</a>
<a name="ln1018">       no_debug_ospf_ism_cmd,</a>
<a name="ln1019">       &quot;no debug ospf ism&quot;,</a>
<a name="ln1020">       NO_STR</a>
<a name="ln1021">       DEBUG_STR</a>
<a name="ln1022">       OSPF_STR</a>
<a name="ln1023">       &quot;OSPF Interface State Machine&quot;)</a>
<a name="ln1024">{</a>
<a name="ln1025">  if (vty-&gt;node == CONFIG_NODE)</a>
<a name="ln1026">    {</a>
<a name="ln1027">      if (argc == 0)</a>
<a name="ln1028">	DEBUG_OFF (ism, ISM);</a>
<a name="ln1029">      else if (argc == 1)</a>
<a name="ln1030">	{</a>
<a name="ln1031">	  if (strncmp (argv[0], &quot;s&quot;, 1) == 0)</a>
<a name="ln1032">	    DEBUG_OFF (ism, ISM_STATUS);</a>
<a name="ln1033">	  else if (strncmp (argv[0], &quot;e&quot;, 1) == 0)</a>
<a name="ln1034">	    DEBUG_OFF (ism, ISM_EVENTS);</a>
<a name="ln1035">	  else if (strncmp (argv[0], &quot;t&quot;, 1) == 0)</a>
<a name="ln1036">	    DEBUG_OFF (ism, ISM_TIMERS);</a>
<a name="ln1037">	}</a>
<a name="ln1038">      return CMD_SUCCESS;</a>
<a name="ln1039">    }</a>
<a name="ln1040"> </a>
<a name="ln1041">  /* ENABLE_NODE. */</a>
<a name="ln1042">  if (argc == 0)</a>
<a name="ln1043">    TERM_DEBUG_OFF (ism, ISM);</a>
<a name="ln1044">  else if (argc == 1)</a>
<a name="ln1045">    {</a>
<a name="ln1046">      if (strncmp (argv[0], &quot;s&quot;, 1) == 0)</a>
<a name="ln1047">	TERM_DEBUG_OFF (ism, ISM_STATUS);</a>
<a name="ln1048">      else if (strncmp (argv[0], &quot;e&quot;, 1) == 0)</a>
<a name="ln1049">	TERM_DEBUG_OFF (ism, ISM_EVENTS);</a>
<a name="ln1050">      else if (strncmp (argv[0], &quot;t&quot;, 1) == 0)</a>
<a name="ln1051">	TERM_DEBUG_OFF (ism, ISM_TIMERS);</a>
<a name="ln1052">    }</a>
<a name="ln1053"> </a>
<a name="ln1054">  return CMD_SUCCESS;</a>
<a name="ln1055">}</a>
<a name="ln1056"> </a>
<a name="ln1057">ALIAS (no_debug_ospf_ism,</a>
<a name="ln1058">       no_debug_ospf_ism_sub_cmd,</a>
<a name="ln1059">       &quot;no debug ospf ism (status|events|timers)&quot;,</a>
<a name="ln1060">       NO_STR</a>
<a name="ln1061">       &quot;Debugging functions\n&quot;</a>
<a name="ln1062">       &quot;OSPF information\n&quot;</a>
<a name="ln1063">       &quot;OSPF Interface State Machine\n&quot;</a>
<a name="ln1064">       &quot;ISM Status Information\n&quot;</a>
<a name="ln1065">       &quot;ISM Event Information\n&quot;</a>
<a name="ln1066">       &quot;ISM Timer Information\n&quot;)</a>
<a name="ln1067"> </a>
<a name="ln1068"> </a>
<a name="ln1069">DEFUN (debug_ospf_nsm,</a>
<a name="ln1070">       debug_ospf_nsm_cmd,</a>
<a name="ln1071">       &quot;debug ospf nsm&quot;,</a>
<a name="ln1072">       DEBUG_STR</a>
<a name="ln1073">       OSPF_STR</a>
<a name="ln1074">       &quot;OSPF Neighbor State Machine\n&quot;)</a>
<a name="ln1075">{</a>
<a name="ln1076">  if (vty-&gt;node == CONFIG_NODE)</a>
<a name="ln1077">    {</a>
<a name="ln1078">      if (argc == 0)</a>
<a name="ln1079">	DEBUG_ON (nsm, NSM);</a>
<a name="ln1080">      else if (argc == 1)</a>
<a name="ln1081">	{</a>
<a name="ln1082">	  if (strncmp (argv[0], &quot;s&quot;, 1) == 0)</a>
<a name="ln1083">	    DEBUG_ON (nsm, NSM_STATUS);</a>
<a name="ln1084">	  else if (strncmp (argv[0], &quot;e&quot;, 1) == 0)</a>
<a name="ln1085">	    DEBUG_ON (nsm, NSM_EVENTS);</a>
<a name="ln1086">	  else if (strncmp (argv[0], &quot;t&quot;, 1) == 0)</a>
<a name="ln1087">	    DEBUG_ON (nsm, NSM_TIMERS);</a>
<a name="ln1088">	}</a>
<a name="ln1089"> </a>
<a name="ln1090">      return CMD_SUCCESS;</a>
<a name="ln1091">    }</a>
<a name="ln1092"> </a>
<a name="ln1093">  /* ENABLE_NODE. */</a>
<a name="ln1094">  if (argc == 0)</a>
<a name="ln1095">    TERM_DEBUG_ON (nsm, NSM);</a>
<a name="ln1096">  else if (argc == 1)</a>
<a name="ln1097">    {</a>
<a name="ln1098">      if (strncmp (argv[0], &quot;s&quot;, 1) == 0)</a>
<a name="ln1099">	TERM_DEBUG_ON (nsm, NSM_STATUS);</a>
<a name="ln1100">      else if (strncmp (argv[0], &quot;e&quot;, 1) == 0)</a>
<a name="ln1101">	TERM_DEBUG_ON (nsm, NSM_EVENTS);</a>
<a name="ln1102">      else if (strncmp (argv[0], &quot;t&quot;, 1) == 0)</a>
<a name="ln1103">	TERM_DEBUG_ON (nsm, NSM_TIMERS);</a>
<a name="ln1104">    }</a>
<a name="ln1105"> </a>
<a name="ln1106">  return CMD_SUCCESS;</a>
<a name="ln1107">}</a>
<a name="ln1108"> </a>
<a name="ln1109">ALIAS (debug_ospf_nsm,</a>
<a name="ln1110">       debug_ospf_nsm_sub_cmd,</a>
<a name="ln1111">       &quot;debug ospf nsm (status|events|timers)&quot;,</a>
<a name="ln1112">       DEBUG_STR</a>
<a name="ln1113">       OSPF_STR</a>
<a name="ln1114">       &quot;OSPF Neighbor State Machine\n&quot;</a>
<a name="ln1115">       &quot;NSM Status Information\n&quot;</a>
<a name="ln1116">       &quot;NSM Event Information\n&quot;</a>
<a name="ln1117">       &quot;NSM Timer Information\n&quot;)</a>
<a name="ln1118"> </a>
<a name="ln1119">DEFUN (no_debug_ospf_nsm,</a>
<a name="ln1120">       no_debug_ospf_nsm_cmd,</a>
<a name="ln1121">       &quot;no debug ospf nsm&quot;,</a>
<a name="ln1122">       NO_STR</a>
<a name="ln1123">       DEBUG_STR</a>
<a name="ln1124">       OSPF_STR</a>
<a name="ln1125">       &quot;OSPF Neighbor State Machine&quot;)</a>
<a name="ln1126">{</a>
<a name="ln1127">  if (vty-&gt;node == CONFIG_NODE)</a>
<a name="ln1128">    {</a>
<a name="ln1129">      if (argc == 0)</a>
<a name="ln1130">	DEBUG_OFF (nsm, NSM);</a>
<a name="ln1131">      else if (argc == 1)</a>
<a name="ln1132">	{</a>
<a name="ln1133">	  if (strncmp (argv[0], &quot;s&quot;, 1) == 0)</a>
<a name="ln1134">	    DEBUG_OFF (nsm, NSM_STATUS);</a>
<a name="ln1135">	  else if (strncmp (argv[0], &quot;e&quot;, 1) == 0)</a>
<a name="ln1136">	    DEBUG_OFF (nsm, NSM_EVENTS);</a>
<a name="ln1137">	  else if (strncmp (argv[0], &quot;t&quot;, 1) == 0)</a>
<a name="ln1138">	    DEBUG_OFF (nsm, NSM_TIMERS);</a>
<a name="ln1139">	}</a>
<a name="ln1140"> </a>
<a name="ln1141">      return CMD_SUCCESS;</a>
<a name="ln1142">    }</a>
<a name="ln1143"> </a>
<a name="ln1144">  /* ENABLE_NODE. */</a>
<a name="ln1145">  if (argc == 0)</a>
<a name="ln1146">    TERM_DEBUG_OFF (nsm, NSM);</a>
<a name="ln1147">  else if (argc == 1)</a>
<a name="ln1148">    {</a>
<a name="ln1149">      if (strncmp (argv[0], &quot;s&quot;, 1) == 0)</a>
<a name="ln1150">	TERM_DEBUG_OFF (nsm, NSM_STATUS);</a>
<a name="ln1151">      else if (strncmp (argv[0], &quot;e&quot;, 1) == 0)</a>
<a name="ln1152">	TERM_DEBUG_OFF (nsm, NSM_EVENTS);</a>
<a name="ln1153">      else if (strncmp (argv[0], &quot;t&quot;, 1) == 0)</a>
<a name="ln1154">	TERM_DEBUG_OFF (nsm, NSM_TIMERS);</a>
<a name="ln1155">    }</a>
<a name="ln1156"> </a>
<a name="ln1157">  return CMD_SUCCESS;</a>
<a name="ln1158">}</a>
<a name="ln1159"> </a>
<a name="ln1160">ALIAS (no_debug_ospf_nsm,</a>
<a name="ln1161">       no_debug_ospf_nsm_sub_cmd,</a>
<a name="ln1162">       &quot;no debug ospf nsm (status|events|timers)&quot;,</a>
<a name="ln1163">       NO_STR</a>
<a name="ln1164">       &quot;Debugging functions\n&quot;</a>
<a name="ln1165">       &quot;OSPF information\n&quot;</a>
<a name="ln1166">       &quot;OSPF Interface State Machine\n&quot;</a>
<a name="ln1167">       &quot;NSM Status Information\n&quot;</a>
<a name="ln1168">       &quot;NSM Event Information\n&quot;</a>
<a name="ln1169">       &quot;NSM Timer Information\n&quot;)</a>
<a name="ln1170"> </a>
<a name="ln1171"> </a>
<a name="ln1172">DEFUN (debug_ospf_lsa,</a>
<a name="ln1173">       debug_ospf_lsa_cmd,</a>
<a name="ln1174">       &quot;debug ospf lsa&quot;,</a>
<a name="ln1175">       DEBUG_STR</a>
<a name="ln1176">       OSPF_STR</a>
<a name="ln1177">       &quot;OSPF Link State Advertisement\n&quot;)</a>
<a name="ln1178">{</a>
<a name="ln1179">  if (vty-&gt;node == CONFIG_NODE)</a>
<a name="ln1180">    {</a>
<a name="ln1181">      if (argc == 0)</a>
<a name="ln1182">	DEBUG_ON (lsa, LSA);</a>
<a name="ln1183">      else if (argc == 1)</a>
<a name="ln1184">	{</a>
<a name="ln1185">	  if (strncmp (argv[0], &quot;g&quot;, 1) == 0)</a>
<a name="ln1186">	    DEBUG_ON (lsa, LSA_GENERATE);</a>
<a name="ln1187">	  else if (strncmp (argv[0], &quot;f&quot;, 1) == 0)</a>
<a name="ln1188">	    DEBUG_ON (lsa, LSA_FLOODING);</a>
<a name="ln1189">	  else if (strncmp (argv[0], &quot;i&quot;, 1) == 0)</a>
<a name="ln1190">	    DEBUG_ON (lsa, LSA_INSTALL);</a>
<a name="ln1191">	  else if (strncmp (argv[0], &quot;r&quot;, 1) == 0)</a>
<a name="ln1192">	    DEBUG_ON (lsa, LSA_REFRESH);</a>
<a name="ln1193">	}</a>
<a name="ln1194"> </a>
<a name="ln1195">      return CMD_SUCCESS;</a>
<a name="ln1196">    }</a>
<a name="ln1197"> </a>
<a name="ln1198">  /* ENABLE_NODE. */</a>
<a name="ln1199">  if (argc == 0)</a>
<a name="ln1200">    TERM_DEBUG_ON (lsa, LSA);</a>
<a name="ln1201">  else if (argc == 1)</a>
<a name="ln1202">    {</a>
<a name="ln1203">      if (strncmp (argv[0], &quot;g&quot;, 1) == 0)</a>
<a name="ln1204">	TERM_DEBUG_ON (lsa, LSA_GENERATE);</a>
<a name="ln1205">      else if (strncmp (argv[0], &quot;f&quot;, 1) == 0)</a>
<a name="ln1206">	TERM_DEBUG_ON (lsa, LSA_FLOODING);</a>
<a name="ln1207">      else if (strncmp (argv[0], &quot;i&quot;, 1) == 0)</a>
<a name="ln1208">	TERM_DEBUG_ON (lsa, LSA_INSTALL);</a>
<a name="ln1209">      else if (strncmp (argv[0], &quot;r&quot;, 1) == 0)</a>
<a name="ln1210">	TERM_DEBUG_ON (lsa, LSA_REFRESH);</a>
<a name="ln1211">    }</a>
<a name="ln1212"> </a>
<a name="ln1213">  return CMD_SUCCESS;</a>
<a name="ln1214">}</a>
<a name="ln1215"> </a>
<a name="ln1216">ALIAS (debug_ospf_lsa,</a>
<a name="ln1217">       debug_ospf_lsa_sub_cmd,</a>
<a name="ln1218">       &quot;debug ospf lsa (generate|flooding|install|refresh)&quot;,</a>
<a name="ln1219">       DEBUG_STR</a>
<a name="ln1220">       OSPF_STR</a>
<a name="ln1221">       &quot;OSPF Link State Advertisement\n&quot;</a>
<a name="ln1222">       &quot;LSA Generation\n&quot;</a>
<a name="ln1223">       &quot;LSA Flooding\n&quot;</a>
<a name="ln1224">       &quot;LSA Install/Delete\n&quot;</a>
<a name="ln1225">       &quot;LSA Refresh\n&quot;)</a>
<a name="ln1226"> </a>
<a name="ln1227">DEFUN (no_debug_ospf_lsa,</a>
<a name="ln1228">       no_debug_ospf_lsa_cmd,</a>
<a name="ln1229">       &quot;no debug ospf lsa&quot;,</a>
<a name="ln1230">       NO_STR</a>
<a name="ln1231">       DEBUG_STR</a>
<a name="ln1232">       OSPF_STR</a>
<a name="ln1233">       &quot;OSPF Link State Advertisement\n&quot;)</a>
<a name="ln1234">{</a>
<a name="ln1235">  if (vty-&gt;node == CONFIG_NODE)</a>
<a name="ln1236">    {</a>
<a name="ln1237">      if (argc == 0)</a>
<a name="ln1238">	DEBUG_OFF (lsa, LSA);</a>
<a name="ln1239">      else if (argc == 1)</a>
<a name="ln1240">	{</a>
<a name="ln1241">	  if (strncmp (argv[0], &quot;g&quot;, 1) == 0)</a>
<a name="ln1242">	    DEBUG_OFF (lsa, LSA_GENERATE);</a>
<a name="ln1243">	  else if (strncmp (argv[0], &quot;f&quot;, 1) == 0)</a>
<a name="ln1244">	    DEBUG_OFF (lsa, LSA_FLOODING);</a>
<a name="ln1245">	  else if (strncmp (argv[0], &quot;i&quot;, 1) == 0)</a>
<a name="ln1246">	    DEBUG_OFF (lsa, LSA_INSTALL);</a>
<a name="ln1247">	  else if (strncmp (argv[0], &quot;r&quot;, 1) == 0)</a>
<a name="ln1248">	    DEBUG_OFF (lsa, LSA_REFRESH);</a>
<a name="ln1249">	}</a>
<a name="ln1250"> </a>
<a name="ln1251">      return CMD_SUCCESS;</a>
<a name="ln1252">    }</a>
<a name="ln1253"> </a>
<a name="ln1254">  /* ENABLE_NODE. */</a>
<a name="ln1255">  if (argc == 0)</a>
<a name="ln1256">    TERM_DEBUG_OFF (lsa, LSA);</a>
<a name="ln1257">  else if (argc == 1)</a>
<a name="ln1258">    {</a>
<a name="ln1259">      if (strncmp (argv[0], &quot;g&quot;, 1) == 0)</a>
<a name="ln1260">	TERM_DEBUG_OFF (lsa, LSA_GENERATE);</a>
<a name="ln1261">      else if (strncmp (argv[0], &quot;f&quot;, 1) == 0)</a>
<a name="ln1262">	TERM_DEBUG_OFF (lsa, LSA_FLOODING);</a>
<a name="ln1263">      else if (strncmp (argv[0], &quot;i&quot;, 1) == 0)</a>
<a name="ln1264">	TERM_DEBUG_OFF (lsa, LSA_INSTALL);</a>
<a name="ln1265">      else if (strncmp (argv[0], &quot;r&quot;, 1) == 0)</a>
<a name="ln1266">	TERM_DEBUG_OFF (lsa, LSA_REFRESH);</a>
<a name="ln1267">    }</a>
<a name="ln1268"> </a>
<a name="ln1269">  return CMD_SUCCESS;</a>
<a name="ln1270">}</a>
<a name="ln1271"> </a>
<a name="ln1272">ALIAS (no_debug_ospf_lsa,</a>
<a name="ln1273">       no_debug_ospf_lsa_sub_cmd,</a>
<a name="ln1274">       &quot;no debug ospf lsa (generate|flooding|install|refresh)&quot;,</a>
<a name="ln1275">       NO_STR</a>
<a name="ln1276">       DEBUG_STR</a>
<a name="ln1277">       OSPF_STR</a>
<a name="ln1278">       &quot;OSPF Link State Advertisement\n&quot;</a>
<a name="ln1279">       &quot;LSA Generation\n&quot;</a>
<a name="ln1280">       &quot;LSA Flooding\n&quot;</a>
<a name="ln1281">       &quot;LSA Install/Delete\n&quot;</a>
<a name="ln1282">       &quot;LSA Refres\n&quot;)</a>
<a name="ln1283"> </a>
<a name="ln1284"> </a>
<a name="ln1285">DEFUN (debug_ospf_zebra,</a>
<a name="ln1286">       debug_ospf_zebra_cmd,</a>
<a name="ln1287">       &quot;debug ospf zebra&quot;,</a>
<a name="ln1288">       DEBUG_STR</a>
<a name="ln1289">       OSPF_STR</a>
<a name="ln1290">       &quot;OSPF Zebra information\n&quot;)</a>
<a name="ln1291">{</a>
<a name="ln1292">  if (vty-&gt;node == CONFIG_NODE)</a>
<a name="ln1293">    {</a>
<a name="ln1294">      if (argc == 0)</a>
<a name="ln1295">	DEBUG_ON (zebra, ZEBRA);</a>
<a name="ln1296">      else if (argc == 1)</a>
<a name="ln1297">	{</a>
<a name="ln1298">	  if (strncmp (argv[0], &quot;i&quot;, 1) == 0)</a>
<a name="ln1299">	    DEBUG_ON (zebra, ZEBRA_INTERFACE);</a>
<a name="ln1300">	  else if (strncmp (argv[0], &quot;r&quot;, 1) == 0)</a>
<a name="ln1301">	    DEBUG_ON (zebra, ZEBRA_REDISTRIBUTE);</a>
<a name="ln1302">	}</a>
<a name="ln1303"> </a>
<a name="ln1304">      return CMD_SUCCESS;</a>
<a name="ln1305">    }</a>
<a name="ln1306"> </a>
<a name="ln1307">  /* ENABLE_NODE. */</a>
<a name="ln1308">  if (argc == 0)</a>
<a name="ln1309">    TERM_DEBUG_ON (zebra, ZEBRA);</a>
<a name="ln1310">  else if (argc == 1)</a>
<a name="ln1311">    {</a>
<a name="ln1312">      if (strncmp (argv[0], &quot;i&quot;, 1) == 0)</a>
<a name="ln1313">	TERM_DEBUG_ON (zebra, ZEBRA_INTERFACE);</a>
<a name="ln1314">      else if (strncmp (argv[0], &quot;r&quot;, 1) == 0)</a>
<a name="ln1315">	TERM_DEBUG_ON (zebra, ZEBRA_REDISTRIBUTE);</a>
<a name="ln1316">    }</a>
<a name="ln1317"> </a>
<a name="ln1318">  return CMD_SUCCESS;</a>
<a name="ln1319">}</a>
<a name="ln1320"> </a>
<a name="ln1321">ALIAS (debug_ospf_zebra,</a>
<a name="ln1322">       debug_ospf_zebra_sub_cmd,</a>
<a name="ln1323">       &quot;debug ospf zebra (interface|redistribute)&quot;,</a>
<a name="ln1324">       DEBUG_STR</a>
<a name="ln1325">       OSPF_STR</a>
<a name="ln1326">       &quot;OSPF Zebra information\n&quot;</a>
<a name="ln1327">       &quot;Zebra interface\n&quot;</a>
<a name="ln1328">       &quot;Zebra redistribute\n&quot;)</a>
<a name="ln1329"> </a>
<a name="ln1330">DEFUN (no_debug_ospf_zebra,</a>
<a name="ln1331">       no_debug_ospf_zebra_cmd,</a>
<a name="ln1332">       &quot;no debug ospf zebra&quot;,</a>
<a name="ln1333">       NO_STR</a>
<a name="ln1334">       DEBUG_STR</a>
<a name="ln1335">       OSPF_STR</a>
<a name="ln1336">       &quot;OSPF Zebra information\n&quot;)</a>
<a name="ln1337">{</a>
<a name="ln1338">  if (vty-&gt;node == CONFIG_NODE)</a>
<a name="ln1339">    {</a>
<a name="ln1340">      if (argc == 0)</a>
<a name="ln1341">	DEBUG_OFF (zebra, ZEBRA);</a>
<a name="ln1342">      else if (argc == 1)</a>
<a name="ln1343">	{</a>
<a name="ln1344">	  if (strncmp (argv[0], &quot;i&quot;, 1) == 0)</a>
<a name="ln1345">	    DEBUG_OFF (zebra, ZEBRA_INTERFACE);</a>
<a name="ln1346">	  else if (strncmp (argv[0], &quot;r&quot;, 1) == 0)</a>
<a name="ln1347">	    DEBUG_OFF (zebra, ZEBRA_REDISTRIBUTE);</a>
<a name="ln1348">	}</a>
<a name="ln1349"> </a>
<a name="ln1350">      return CMD_SUCCESS;</a>
<a name="ln1351">    }</a>
<a name="ln1352"> </a>
<a name="ln1353">  /* ENABLE_NODE. */</a>
<a name="ln1354">  if (argc == 0)</a>
<a name="ln1355">    TERM_DEBUG_OFF (zebra, ZEBRA);</a>
<a name="ln1356">  else if (argc == 1)</a>
<a name="ln1357">    {</a>
<a name="ln1358">      if (strncmp (argv[0], &quot;i&quot;, 1) == 0)</a>
<a name="ln1359">	TERM_DEBUG_OFF (zebra, ZEBRA_INTERFACE);</a>
<a name="ln1360">      else if (strncmp (argv[0], &quot;r&quot;, 1) == 0)</a>
<a name="ln1361">	TERM_DEBUG_OFF (zebra, ZEBRA_REDISTRIBUTE);</a>
<a name="ln1362">    }</a>
<a name="ln1363"> </a>
<a name="ln1364">  return CMD_SUCCESS;</a>
<a name="ln1365">}</a>
<a name="ln1366"> </a>
<a name="ln1367">ALIAS (no_debug_ospf_zebra,</a>
<a name="ln1368">       no_debug_ospf_zebra_sub_cmd,</a>
<a name="ln1369">       &quot;no debug ospf zebra (interface|redistribute)&quot;,</a>
<a name="ln1370">       NO_STR</a>
<a name="ln1371">       DEBUG_STR</a>
<a name="ln1372">       OSPF_STR</a>
<a name="ln1373">       &quot;OSPF Zebra information\n&quot;</a>
<a name="ln1374">       &quot;Zebra interface\n&quot;</a>
<a name="ln1375">       &quot;Zebra redistribute\n&quot;)</a>
<a name="ln1376"> </a>
<a name="ln1377">DEFUN (debug_ospf_event,</a>
<a name="ln1378">       debug_ospf_event_cmd,</a>
<a name="ln1379">       &quot;debug ospf event&quot;,</a>
<a name="ln1380">       DEBUG_STR</a>
<a name="ln1381">       OSPF_STR</a>
<a name="ln1382">       &quot;OSPF event information\n&quot;)</a>
<a name="ln1383">{</a>
<a name="ln1384">  if (vty-&gt;node == CONFIG_NODE)</a>
<a name="ln1385">    CONF_DEBUG_ON (event, EVENT);</a>
<a name="ln1386">  TERM_DEBUG_ON (event, EVENT);</a>
<a name="ln1387">  return CMD_SUCCESS;</a>
<a name="ln1388">}</a>
<a name="ln1389"> </a>
<a name="ln1390">DEFUN (no_debug_ospf_event,</a>
<a name="ln1391">       no_debug_ospf_event_cmd,</a>
<a name="ln1392">       &quot;no debug ospf event&quot;,</a>
<a name="ln1393">       NO_STR</a>
<a name="ln1394">       DEBUG_STR</a>
<a name="ln1395">       OSPF_STR</a>
<a name="ln1396">       &quot;OSPF event information\n&quot;)</a>
<a name="ln1397">{</a>
<a name="ln1398">  if (vty-&gt;node == CONFIG_NODE)</a>
<a name="ln1399">    CONF_DEBUG_OFF (event, EVENT);</a>
<a name="ln1400">  TERM_DEBUG_OFF (event, EVENT);</a>
<a name="ln1401">  return CMD_SUCCESS;</a>
<a name="ln1402">}</a>
<a name="ln1403"> </a>
<a name="ln1404">DEFUN (debug_ospf_nssa,</a>
<a name="ln1405">       debug_ospf_nssa_cmd,</a>
<a name="ln1406">       &quot;debug ospf nssa&quot;,</a>
<a name="ln1407">       DEBUG_STR</a>
<a name="ln1408">       OSPF_STR</a>
<a name="ln1409">       &quot;OSPF nssa information\n&quot;)</a>
<a name="ln1410">{</a>
<a name="ln1411">  if (vty-&gt;node == CONFIG_NODE)</a>
<a name="ln1412">    CONF_DEBUG_ON (nssa, NSSA);</a>
<a name="ln1413">  TERM_DEBUG_ON (nssa, NSSA);</a>
<a name="ln1414">  return CMD_SUCCESS;</a>
<a name="ln1415">}</a>
<a name="ln1416"> </a>
<a name="ln1417">DEFUN (no_debug_ospf_nssa,</a>
<a name="ln1418">       no_debug_ospf_nssa_cmd,</a>
<a name="ln1419">       &quot;no debug ospf nssa&quot;,</a>
<a name="ln1420">       NO_STR</a>
<a name="ln1421">       DEBUG_STR</a>
<a name="ln1422">       OSPF_STR</a>
<a name="ln1423">       &quot;OSPF nssa information\n&quot;)</a>
<a name="ln1424">{</a>
<a name="ln1425">  if (vty-&gt;node == CONFIG_NODE)</a>
<a name="ln1426">    CONF_DEBUG_OFF (nssa, NSSA);</a>
<a name="ln1427">  TERM_DEBUG_OFF (nssa, NSSA);</a>
<a name="ln1428">  return CMD_SUCCESS;</a>
<a name="ln1429">}</a>
<a name="ln1430"> </a>
<a name="ln1431">DEFUN (debug_ospf_te,</a>
<a name="ln1432">       debug_ospf_te_cmd,</a>
<a name="ln1433">       &quot;debug ospf te&quot;,</a>
<a name="ln1434">       DEBUG_STR</a>
<a name="ln1435">       OSPF_STR</a>
<a name="ln1436">       &quot;OSPF-TE information\n&quot;)</a>
<a name="ln1437">{</a>
<a name="ln1438">  if (vty-&gt;node == CONFIG_NODE)</a>
<a name="ln1439">    CONF_DEBUG_ON (te, TE);</a>
<a name="ln1440">  TERM_DEBUG_ON (te, TE);</a>
<a name="ln1441">  return CMD_SUCCESS;</a>
<a name="ln1442">}</a>
<a name="ln1443"> </a>
<a name="ln1444">DEFUN (no_debug_ospf_te,</a>
<a name="ln1445">       no_debug_ospf_te_cmd,</a>
<a name="ln1446">       &quot;no debug ospf te&quot;,</a>
<a name="ln1447">       NO_STR</a>
<a name="ln1448">       DEBUG_STR</a>
<a name="ln1449">       OSPF_STR</a>
<a name="ln1450">       &quot;OSPF-TE information\n&quot;)</a>
<a name="ln1451">{</a>
<a name="ln1452">  if (vty-&gt;node == CONFIG_NODE)</a>
<a name="ln1453">    CONF_DEBUG_OFF (te, TE);</a>
<a name="ln1454">  TERM_DEBUG_OFF (te, TE);</a>
<a name="ln1455">  return CMD_SUCCESS;</a>
<a name="ln1456">}</a>
<a name="ln1457"> </a>
<a name="ln1458">DEFUN (show_debugging_ospf,</a>
<a name="ln1459">       show_debugging_ospf_cmd,</a>
<a name="ln1460">       &quot;show debugging ospf&quot;,</a>
<a name="ln1461">       SHOW_STR</a>
<a name="ln1462">       DEBUG_STR</a>
<a name="ln1463">       OSPF_STR)</a>
<a name="ln1464">{</a>
<a name="ln1465">  int i;</a>
<a name="ln1466"> </a>
<a name="ln1467">  vty_out (vty, &quot;OSPF debugging status:%s&quot;, VTY_NEWLINE);</a>
<a name="ln1468"> </a>
<a name="ln1469">  /* Show debug status for events. */</a>
<a name="ln1470">  if (IS_DEBUG_OSPF(event,EVENT))</a>
<a name="ln1471">    vty_out (vty, &quot;  OSPF event debugging is on%s&quot;, VTY_NEWLINE);</a>
<a name="ln1472"> </a>
<a name="ln1473">  /* Show debug status for ISM. */</a>
<a name="ln1474">  if (IS_DEBUG_OSPF (ism, ISM) == OSPF_DEBUG_ISM)</a>
<a name="ln1475">    vty_out (vty, &quot;  OSPF ISM debugging is on%s&quot;, VTY_NEWLINE);</a>
<a name="ln1476">  else</a>
<a name="ln1477">    {</a>
<a name="ln1478">      if (IS_DEBUG_OSPF (ism, ISM_STATUS))</a>
<a name="ln1479">	vty_out (vty, &quot;  OSPF ISM status debugging is on%s&quot;, VTY_NEWLINE);</a>
<a name="ln1480">      if (IS_DEBUG_OSPF (ism, ISM_EVENTS))</a>
<a name="ln1481">	vty_out (vty, &quot;  OSPF ISM event debugging is on%s&quot;, VTY_NEWLINE);</a>
<a name="ln1482">      if (IS_DEBUG_OSPF (ism, ISM_TIMERS))</a>
<a name="ln1483">	vty_out (vty, &quot;  OSPF ISM timer debugging is on%s&quot;, VTY_NEWLINE);</a>
<a name="ln1484">    }</a>
<a name="ln1485"> </a>
<a name="ln1486">  /* Show debug status for NSM. */</a>
<a name="ln1487">  if (IS_DEBUG_OSPF (nsm, NSM) == OSPF_DEBUG_NSM)</a>
<a name="ln1488">    vty_out (vty, &quot;  OSPF NSM debugging is on%s&quot;, VTY_NEWLINE);</a>
<a name="ln1489">  else</a>
<a name="ln1490">    {</a>
<a name="ln1491">      if (IS_DEBUG_OSPF (nsm, NSM_STATUS))</a>
<a name="ln1492">	vty_out (vty, &quot;  OSPF NSM status debugging is on%s&quot;, VTY_NEWLINE);</a>
<a name="ln1493">      if (IS_DEBUG_OSPF (nsm, NSM_EVENTS))</a>
<a name="ln1494">	vty_out (vty, &quot;  OSPF NSM event debugging is on%s&quot;, VTY_NEWLINE);</a>
<a name="ln1495">      if (IS_DEBUG_OSPF (nsm, NSM_TIMERS))</a>
<a name="ln1496">	vty_out (vty, &quot;  OSPF NSM timer debugging is on%s&quot;, VTY_NEWLINE);</a>
<a name="ln1497">    }</a>
<a name="ln1498"> </a>
<a name="ln1499">  /* Show debug status for OSPF Packets. */</a>
<a name="ln1500">  for (i = 0; i &lt; 5; i++)</a>
<a name="ln1501">    if (IS_DEBUG_OSPF_PACKET (i, SEND) &amp;&amp; IS_DEBUG_OSPF_PACKET (i, RECV))</a>
<a name="ln1502">      {</a>
<a name="ln1503">	vty_out (vty, &quot;  OSPF packet %s%s debugging is on%s&quot;,</a>
<a name="ln1504">		 LOOKUP (ospf_packet_type_str, i + 1),</a>
<a name="ln1505">		 IS_DEBUG_OSPF_PACKET (i, DETAIL) ? &quot; detail&quot; : &quot;&quot;,</a>
<a name="ln1506">		 VTY_NEWLINE);</a>
<a name="ln1507">      }</a>
<a name="ln1508">    else</a>
<a name="ln1509">      {</a>
<a name="ln1510">	if (IS_DEBUG_OSPF_PACKET (i, SEND))</a>
<a name="ln1511">	  vty_out (vty, &quot;  OSPF packet %s send%s debugging is on%s&quot;,</a>
<a name="ln1512">		   LOOKUP (ospf_packet_type_str, i + 1),</a>
<a name="ln1513">		   IS_DEBUG_OSPF_PACKET (i, DETAIL) ? &quot; detail&quot; : &quot;&quot;,</a>
<a name="ln1514">		   VTY_NEWLINE);</a>
<a name="ln1515">	if (IS_DEBUG_OSPF_PACKET (i, RECV))</a>
<a name="ln1516">	  vty_out (vty, &quot;  OSPF packet %s receive%s debugging is on%s&quot;,</a>
<a name="ln1517">		   LOOKUP (ospf_packet_type_str, i + 1),</a>
<a name="ln1518">		   IS_DEBUG_OSPF_PACKET (i, DETAIL) ? &quot; detail&quot; : &quot;&quot;,</a>
<a name="ln1519">		   VTY_NEWLINE);</a>
<a name="ln1520">      }</a>
<a name="ln1521"> </a>
<a name="ln1522">  /* Show debug status for OSPF LSAs. */</a>
<a name="ln1523">  if (IS_DEBUG_OSPF (lsa, LSA) == OSPF_DEBUG_LSA)</a>
<a name="ln1524">    vty_out (vty, &quot;  OSPF LSA debugging is on%s&quot;, VTY_NEWLINE);</a>
<a name="ln1525">  else</a>
<a name="ln1526">    {</a>
<a name="ln1527">      if (IS_DEBUG_OSPF (lsa, LSA_GENERATE))</a>
<a name="ln1528">	vty_out (vty, &quot;  OSPF LSA generation debugging is on%s&quot;, VTY_NEWLINE);</a>
<a name="ln1529">      if (IS_DEBUG_OSPF (lsa, LSA_FLOODING))</a>
<a name="ln1530">	vty_out (vty, &quot;  OSPF LSA flooding debugging is on%s&quot;, VTY_NEWLINE);</a>
<a name="ln1531">      if (IS_DEBUG_OSPF (lsa, LSA_INSTALL))</a>
<a name="ln1532">	vty_out (vty, &quot;  OSPF LSA install debugging is on%s&quot;, VTY_NEWLINE);</a>
<a name="ln1533">      if (IS_DEBUG_OSPF (lsa, LSA_REFRESH))</a>
<a name="ln1534">	vty_out (vty, &quot;  OSPF LSA refresh debugging is on%s&quot;, VTY_NEWLINE);</a>
<a name="ln1535">    }</a>
<a name="ln1536"> </a>
<a name="ln1537">  /* Show debug status for Zebra. */</a>
<a name="ln1538">  if (IS_DEBUG_OSPF (zebra, ZEBRA) == OSPF_DEBUG_ZEBRA)</a>
<a name="ln1539">    vty_out (vty, &quot;  OSPF Zebra debugging is on%s&quot;, VTY_NEWLINE);</a>
<a name="ln1540">  else</a>
<a name="ln1541">    {</a>
<a name="ln1542">      if (IS_DEBUG_OSPF (zebra, ZEBRA_INTERFACE))</a>
<a name="ln1543">	vty_out (vty, &quot;  OSPF Zebra interface debugging is on%s&quot;, VTY_NEWLINE);</a>
<a name="ln1544">      if (IS_DEBUG_OSPF (zebra, ZEBRA_REDISTRIBUTE))</a>
<a name="ln1545">	vty_out (vty, &quot;  OSPF Zebra redistribute debugging is on%s&quot;, VTY_NEWLINE);</a>
<a name="ln1546">    }</a>
<a name="ln1547"> </a>
<a name="ln1548">  /* Show debug status for NSSA. */</a>
<a name="ln1549">  if (IS_DEBUG_OSPF (nssa, NSSA) == OSPF_DEBUG_NSSA)</a>
<a name="ln1550">    vty_out (vty, &quot;  OSPF NSSA debugging is on%s&quot;, VTY_NEWLINE);</a>
<a name="ln1551"> </a>
<a name="ln1552">  return CMD_SUCCESS;</a>
<a name="ln1553">}</a>
<a name="ln1554"> </a>
<a name="ln1555">/* Debug node. */</a>
<a name="ln1556">static struct cmd_node debug_node =</a>
<a name="ln1557">{</a>
<a name="ln1558">  DEBUG_NODE,</a>
<a name="ln1559">  &quot;&quot;,</a>
<a name="ln1560">  1 /* VTYSH */</a>
<a name="ln1561">};</a>
<a name="ln1562"> </a>
<a name="ln1563">static int</a>
<a name="ln1564">config_write_debug (struct vty *vty)</a>
<a name="ln1565">{</a>
<a name="ln1566">  int write = 0;</a>
<a name="ln1567">  int i, r;</a>
<a name="ln1568"> </a>
<a name="ln1569">  const char *type_str[] = {&quot;hello&quot;, &quot;dd&quot;, &quot;ls-request&quot;, &quot;ls-update&quot;, &quot;ls-ack&quot;};</a>
<a name="ln1570">  const char *detail_str[] = {&quot;&quot;, &quot; send&quot;, &quot; recv&quot;, &quot;&quot;, &quot; detail&quot;,</a>
<a name="ln1571">			&quot; send detail&quot;, &quot; recv detail&quot;, &quot; detail&quot;};</a>
<a name="ln1572"> </a>
<a name="ln1573">  /* debug ospf ism (status|events|timers). */</a>
<a name="ln1574">  if (IS_CONF_DEBUG_OSPF (ism, ISM) == OSPF_DEBUG_ISM)</a>
<a name="ln1575">    vty_out (vty, &quot;debug ospf ism%s&quot;, VTY_NEWLINE);</a>
<a name="ln1576">  else</a>
<a name="ln1577">    {</a>
<a name="ln1578">      if (IS_CONF_DEBUG_OSPF (ism, ISM_STATUS))</a>
<a name="ln1579">	vty_out (vty, &quot;debug ospf ism status%s&quot;, VTY_NEWLINE);</a>
<a name="ln1580">      if (IS_CONF_DEBUG_OSPF (ism, ISM_EVENTS))</a>
<a name="ln1581">	vty_out (vty, &quot;debug ospf ism event%s&quot;, VTY_NEWLINE);</a>
<a name="ln1582">      if (IS_CONF_DEBUG_OSPF (ism, ISM_TIMERS))</a>
<a name="ln1583">	vty_out (vty, &quot;debug ospf ism timer%s&quot;, VTY_NEWLINE);</a>
<a name="ln1584">    }</a>
<a name="ln1585"> </a>
<a name="ln1586">  /* debug ospf nsm (status|events|timers). */</a>
<a name="ln1587">  if (IS_CONF_DEBUG_OSPF (nsm, NSM) == OSPF_DEBUG_NSM)</a>
<a name="ln1588">    vty_out (vty, &quot;debug ospf nsm%s&quot;, VTY_NEWLINE);</a>
<a name="ln1589">  else</a>
<a name="ln1590">    {</a>
<a name="ln1591">      if (IS_CONF_DEBUG_OSPF (nsm, NSM_STATUS))</a>
<a name="ln1592">	vty_out (vty, &quot;debug ospf nsm status%s&quot;, VTY_NEWLINE);</a>
<a name="ln1593">      if (IS_CONF_DEBUG_OSPF (nsm, NSM_EVENTS))</a>
<a name="ln1594">	vty_out (vty, &quot;debug ospf nsm event%s&quot;, VTY_NEWLINE);</a>
<a name="ln1595">      if (IS_CONF_DEBUG_OSPF (nsm, NSM_TIMERS))</a>
<a name="ln1596">	vty_out (vty, &quot;debug ospf nsm timer%s&quot;, VTY_NEWLINE);</a>
<a name="ln1597">    }</a>
<a name="ln1598"> </a>
<a name="ln1599">  /* debug ospf lsa (generate|flooding|install|refresh). */</a>
<a name="ln1600">  if (IS_CONF_DEBUG_OSPF (lsa, LSA) == OSPF_DEBUG_LSA)</a>
<a name="ln1601">    vty_out (vty, &quot;debug ospf lsa%s&quot;, VTY_NEWLINE);</a>
<a name="ln1602">  else</a>
<a name="ln1603">    {</a>
<a name="ln1604">      if (IS_CONF_DEBUG_OSPF (lsa, LSA_GENERATE))</a>
<a name="ln1605">	vty_out (vty, &quot;debug ospf lsa generate%s&quot;, VTY_NEWLINE);</a>
<a name="ln1606">      if (IS_CONF_DEBUG_OSPF (lsa, LSA_FLOODING))</a>
<a name="ln1607">	vty_out (vty, &quot;debug ospf lsa flooding%s&quot;, VTY_NEWLINE);</a>
<a name="ln1608">      if (IS_CONF_DEBUG_OSPF (lsa, LSA_INSTALL))</a>
<a name="ln1609">	vty_out (vty, &quot;debug ospf lsa install%s&quot;, VTY_NEWLINE);</a>
<a name="ln1610">      if (IS_CONF_DEBUG_OSPF (lsa, LSA_REFRESH))</a>
<a name="ln1611">	vty_out (vty, &quot;debug ospf lsa refresh%s&quot;, VTY_NEWLINE);</a>
<a name="ln1612"> </a>
<a name="ln1613">      write = 1;</a>
<a name="ln1614">    }</a>
<a name="ln1615"> </a>
<a name="ln1616">  /* debug ospf zebra (interface|redistribute). */</a>
<a name="ln1617">  if (IS_CONF_DEBUG_OSPF (zebra, ZEBRA) == OSPF_DEBUG_ZEBRA)</a>
<a name="ln1618">    vty_out (vty, &quot;debug ospf zebra%s&quot;, VTY_NEWLINE);</a>
<a name="ln1619">  else</a>
<a name="ln1620">    {</a>
<a name="ln1621">      if (IS_CONF_DEBUG_OSPF (zebra, ZEBRA_INTERFACE))</a>
<a name="ln1622">	vty_out (vty, &quot;debug ospf zebra interface%s&quot;, VTY_NEWLINE);</a>
<a name="ln1623">      if (IS_CONF_DEBUG_OSPF (zebra, ZEBRA_REDISTRIBUTE))</a>
<a name="ln1624">	vty_out (vty, &quot;debug ospf zebra redistribute%s&quot;, VTY_NEWLINE);</a>
<a name="ln1625"> </a>
<a name="ln1626">      write = 1;</a>
<a name="ln1627">    }</a>
<a name="ln1628"> </a>
<a name="ln1629">  /* debug ospf event. */</a>
<a name="ln1630">  if (IS_CONF_DEBUG_OSPF (event, EVENT) == OSPF_DEBUG_EVENT)</a>
<a name="ln1631">    {</a>
<a name="ln1632">      vty_out (vty, &quot;debug ospf event%s&quot;, VTY_NEWLINE);</a>
<a name="ln1633">      write = 1;</a>
<a name="ln1634">    }</a>
<a name="ln1635"> </a>
<a name="ln1636">  /* debug ospf nssa. */</a>
<a name="ln1637">  if (IS_CONF_DEBUG_OSPF (nssa, NSSA) == OSPF_DEBUG_NSSA)</a>
<a name="ln1638">    {</a>
<a name="ln1639">      vty_out (vty, &quot;debug ospf nssa%s&quot;, VTY_NEWLINE);</a>
<a name="ln1640">      write = 1;</a>
<a name="ln1641">    }</a>
<a name="ln1642">  </a>
<a name="ln1643">  /* debug ospf packet all detail. */</a>
<a name="ln1644">  r = OSPF_DEBUG_SEND_RECV|OSPF_DEBUG_DETAIL;</a>
<a name="ln1645">  for (i = 0; i &lt; 5; i++)</a>
<a name="ln1646">    r &amp;= conf_debug_ospf_packet[i] &amp; (OSPF_DEBUG_SEND_RECV|OSPF_DEBUG_DETAIL);</a>
<a name="ln1647">  if (r == (OSPF_DEBUG_SEND_RECV|OSPF_DEBUG_DETAIL))</a>
<a name="ln1648">    {</a>
<a name="ln1649">      vty_out (vty, &quot;debug ospf packet all detail%s&quot;, VTY_NEWLINE);</a>
<a name="ln1650">      return 1;</a>
<a name="ln1651">    }</a>
<a name="ln1652"> </a>
<a name="ln1653">  /* debug ospf packet all. */</a>
<a name="ln1654">  r = OSPF_DEBUG_SEND_RECV;</a>
<a name="ln1655">  for (i = 0; i &lt; 5; i++)</a>
<a name="ln1656">    r &amp;= conf_debug_ospf_packet[i] &amp; OSPF_DEBUG_SEND_RECV;</a>
<a name="ln1657">  if (r == OSPF_DEBUG_SEND_RECV)</a>
<a name="ln1658">    {</a>
<a name="ln1659">      vty_out (vty, &quot;debug ospf packet all%s&quot;, VTY_NEWLINE);</a>
<a name="ln1660">      for (i = 0; i &lt; 5; i++)</a>
<a name="ln1661">	if (conf_debug_ospf_packet[i] &amp; OSPF_DEBUG_DETAIL)</a>
<a name="ln1662">	  vty_out (vty, &quot;debug ospf packet %s detail%s&quot;,</a>
<a name="ln1663">		   type_str[i],</a>
<a name="ln1664">		   VTY_NEWLINE);</a>
<a name="ln1665">      return 1;</a>
<a name="ln1666">    }</a>
<a name="ln1667"> </a>
<a name="ln1668">  /* debug ospf packet (hello|dd|ls-request|ls-update|ls-ack)</a>
<a name="ln1669">     (send|recv) (detail). */</a>
<a name="ln1670">  for (i = 0; i &lt; 5; i++)</a>
<a name="ln1671">    {</a>
<a name="ln1672">      if (conf_debug_ospf_packet[i] == 0)</a>
<a name="ln1673">	continue;</a>
<a name="ln1674">      </a>
<a name="ln1675">      vty_out (vty, &quot;debug ospf packet %s%s%s&quot;,</a>
<a name="ln1676">	       type_str[i], detail_str[conf_debug_ospf_packet[i]],</a>
<a name="ln1677">	       VTY_NEWLINE);</a>
<a name="ln1678">      write = 1;</a>
<a name="ln1679">    }</a>
<a name="ln1680"> </a>
<a name="ln1681">  return write;</a>
<a name="ln1682">}</a>
<a name="ln1683"> </a>
<a name="ln1684">/* Initialize debug commands. */</a>
<a name="ln1685">void</a>
<a name="ln1686">debug_init ()</a>
<a name="ln1687">{</a>
<a name="ln1688">  install_node (&amp;debug_node, config_write_debug);</a>
<a name="ln1689"> </a>
<a name="ln1690">  install_element (ENABLE_NODE, &amp;show_debugging_ospf_cmd);</a>
<a name="ln1691">  install_element (ENABLE_NODE, &amp;debug_ospf_packet_send_recv_detail_cmd);</a>
<a name="ln1692">  install_element (ENABLE_NODE, &amp;debug_ospf_packet_send_recv_cmd);</a>
<a name="ln1693">  install_element (ENABLE_NODE, &amp;debug_ospf_packet_all_cmd);</a>
<a name="ln1694">  install_element (ENABLE_NODE, &amp;debug_ospf_ism_sub_cmd);</a>
<a name="ln1695">  install_element (ENABLE_NODE, &amp;debug_ospf_ism_cmd);</a>
<a name="ln1696">  install_element (ENABLE_NODE, &amp;debug_ospf_nsm_sub_cmd);</a>
<a name="ln1697">  install_element (ENABLE_NODE, &amp;debug_ospf_nsm_cmd);</a>
<a name="ln1698">  install_element (ENABLE_NODE, &amp;debug_ospf_lsa_sub_cmd);</a>
<a name="ln1699">  install_element (ENABLE_NODE, &amp;debug_ospf_lsa_cmd);</a>
<a name="ln1700">  install_element (ENABLE_NODE, &amp;debug_ospf_zebra_sub_cmd);</a>
<a name="ln1701">  install_element (ENABLE_NODE, &amp;debug_ospf_zebra_cmd);</a>
<a name="ln1702">  install_element (ENABLE_NODE, &amp;debug_ospf_event_cmd);</a>
<a name="ln1703">  install_element (ENABLE_NODE, &amp;debug_ospf_nssa_cmd);</a>
<a name="ln1704">  install_element (ENABLE_NODE, &amp;debug_ospf_te_cmd);</a>
<a name="ln1705">  install_element (ENABLE_NODE, &amp;no_debug_ospf_packet_send_recv_detail_cmd);</a>
<a name="ln1706">  install_element (ENABLE_NODE, &amp;no_debug_ospf_packet_send_recv_cmd);</a>
<a name="ln1707">  install_element (ENABLE_NODE, &amp;no_debug_ospf_packet_all_cmd);</a>
<a name="ln1708">  install_element (ENABLE_NODE, &amp;no_debug_ospf_ism_sub_cmd);</a>
<a name="ln1709">  install_element (ENABLE_NODE, &amp;no_debug_ospf_ism_cmd);</a>
<a name="ln1710">  install_element (ENABLE_NODE, &amp;no_debug_ospf_nsm_sub_cmd);</a>
<a name="ln1711">  install_element (ENABLE_NODE, &amp;no_debug_ospf_nsm_cmd);</a>
<a name="ln1712">  install_element (ENABLE_NODE, &amp;no_debug_ospf_lsa_sub_cmd);</a>
<a name="ln1713">  install_element (ENABLE_NODE, &amp;no_debug_ospf_lsa_cmd);</a>
<a name="ln1714">  install_element (ENABLE_NODE, &amp;no_debug_ospf_zebra_sub_cmd);</a>
<a name="ln1715">  install_element (ENABLE_NODE, &amp;no_debug_ospf_zebra_cmd);</a>
<a name="ln1716">  install_element (ENABLE_NODE, &amp;no_debug_ospf_event_cmd);</a>
<a name="ln1717">  install_element (ENABLE_NODE, &amp;no_debug_ospf_nssa_cmd);</a>
<a name="ln1718">  install_element (ENABLE_NODE, &amp;no_debug_ospf_te_cmd);</a>
<a name="ln1719"> </a>
<a name="ln1720">  install_element (CONFIG_NODE, &amp;debug_ospf_packet_send_recv_detail_cmd);</a>
<a name="ln1721">  install_element (CONFIG_NODE, &amp;debug_ospf_packet_send_recv_cmd);</a>
<a name="ln1722">  install_element (CONFIG_NODE, &amp;debug_ospf_packet_all_cmd);</a>
<a name="ln1723">  install_element (CONFIG_NODE, &amp;debug_ospf_ism_sub_cmd);</a>
<a name="ln1724">  install_element (CONFIG_NODE, &amp;debug_ospf_ism_cmd);</a>
<a name="ln1725">  install_element (CONFIG_NODE, &amp;debug_ospf_nsm_sub_cmd);</a>
<a name="ln1726">  install_element (CONFIG_NODE, &amp;debug_ospf_nsm_cmd);</a>
<a name="ln1727">  install_element (CONFIG_NODE, &amp;debug_ospf_lsa_sub_cmd);</a>
<a name="ln1728">  install_element (CONFIG_NODE, &amp;debug_ospf_lsa_cmd);</a>
<a name="ln1729">  install_element (CONFIG_NODE, &amp;debug_ospf_zebra_sub_cmd);</a>
<a name="ln1730">  install_element (CONFIG_NODE, &amp;debug_ospf_zebra_cmd);</a>
<a name="ln1731">  install_element (CONFIG_NODE, &amp;debug_ospf_event_cmd);</a>
<a name="ln1732">  install_element (CONFIG_NODE, &amp;debug_ospf_nssa_cmd);</a>
<a name="ln1733">  install_element (CONFIG_NODE, &amp;debug_ospf_te_cmd);</a>
<a name="ln1734">  install_element (CONFIG_NODE, &amp;no_debug_ospf_packet_send_recv_detail_cmd);</a>
<a name="ln1735">  install_element (CONFIG_NODE, &amp;no_debug_ospf_packet_send_recv_cmd);</a>
<a name="ln1736">  install_element (CONFIG_NODE, &amp;no_debug_ospf_packet_all_cmd);</a>
<a name="ln1737">  install_element (CONFIG_NODE, &amp;no_debug_ospf_ism_sub_cmd);</a>
<a name="ln1738">  install_element (CONFIG_NODE, &amp;no_debug_ospf_ism_cmd);</a>
<a name="ln1739">  install_element (CONFIG_NODE, &amp;no_debug_ospf_nsm_sub_cmd);</a>
<a name="ln1740">  install_element (CONFIG_NODE, &amp;no_debug_ospf_nsm_cmd);</a>
<a name="ln1741">  install_element (CONFIG_NODE, &amp;no_debug_ospf_lsa_sub_cmd);</a>
<a name="ln1742">  install_element (CONFIG_NODE, &amp;no_debug_ospf_lsa_cmd);</a>
<a name="ln1743">  install_element (CONFIG_NODE, &amp;no_debug_ospf_zebra_sub_cmd);</a>
<a name="ln1744">  install_element (CONFIG_NODE, &amp;no_debug_ospf_zebra_cmd);</a>
<a name="ln1745">  install_element (CONFIG_NODE, &amp;no_debug_ospf_event_cmd);</a>
<a name="ln1746">  install_element (CONFIG_NODE, &amp;no_debug_ospf_nssa_cmd);</a>
<a name="ln1747">  install_element (CONFIG_NODE, &amp;no_debug_ospf_te_cmd);</a>
<a name="ln1748">}</a>

</code></pre>
<div class="balloon" rel="8"><p><span style="font-size:18px">&uarr;</span> <a href="https://pvs-studio.com/en/docs/warnings/v1042/" target="_blank">V1042</a> This file is marked with copyleft license, which requires you to open the derived source code.</p></div>
<div class="balloon" rel="619"><p><span style="font-size:18px">&uarr;</span> <a href="https://pvs-studio.com/en/docs/warnings/v1037/" target="_blank">V1037</a> Two or more case-branches perform the same actions. Check lines: 619, 622</p></div>

<link rel="stylesheet" href="highlight.css">
<script src="highlight.pack.js"></script>
<script src="highlightjs-line-numbers.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
<script>hljs.initLineNumbersOnLoad();</script>
<script>
  $(document).ready(function() {
      $('.balloon').each(function () {
          var bl = $(this);
          var line = bl.attr('rel');
          var text = $('a[name="ln'+line+'"]').text();

          var space_count = 0;
          for(var i = 0; i<text.length; i++){
              var char = text[i];
              if((char !== ' ')&&(char !== '\t'))break;
              if(char === '\t')space_count++;
              space_count++;
          }

          bl.css('margin-left', space_count*8);
          $('a[name="ln'+line+'"]').after(bl);
      });

      window.location = window.location;
  });
</script>
</body>
</html>
