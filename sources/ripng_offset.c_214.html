
<html>
<head>

  <meta http-equiv="Content-Type" content="text/html; charset=US-ASCII" />
  <title>ripng_offset.c</title>

  <link rel="stylesheet" href="../style.css"/>
  <script src="../jquery-3.5.1.min.js"></script>
</head>
<body>

<pre><code class = "cpp">
<a name="ln1">/* RIPng offset-list</a>
<a name="ln2"> * Copyright (C) 2000 Kunihiro Ishiguro &lt;kunihiro@zebra.org&gt;</a>
<a name="ln3"> *</a>
<a name="ln4"> * This file is part of GNU Zebra.</a>
<a name="ln5"> *</a>
<a name="ln6"> * GNU Zebra is free software; you can redistribute it and/or modify it</a>
<a name="ln7"> * under the terms of the GNU General Public License as published by the</a>
<a name="ln8"> * Free Software Foundation; either version 2, or (at your option) any</a>
<a name="ln9"> * later version.</a>
<a name="ln10"> *</a>
<a name="ln11"> * GNU Zebra is distributed in the hope that it will be useful, but</a>
<a name="ln12"> * WITHOUT ANY WARRANTY; without even the implied warranty of</a>
<a name="ln13"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</a>
<a name="ln14"> * General Public License for more details.</a>
<a name="ln15"> *</a>
<a name="ln16"> * You should have received a copy of the GNU General Public License</a>
<a name="ln17"> * along with GNU Zebra; see the file COPYING.  If not, write to the Free</a>
<a name="ln18"> * Software Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA</a>
<a name="ln19"> * 02111-1307, USA.  </a>
<a name="ln20"> */</a>
<a name="ln21"> </a>
<a name="ln22"> /* RIPng support by Vincent Jardin &lt;vincent.jardin@6wind.com&gt;</a>
<a name="ln23">  * Copyright (C) 2002 6WIND</a>
<a name="ln24">  */</a>
<a name="ln25"> </a>
<a name="ln26">#include &lt;zebra.h&gt;</a>
<a name="ln27"> </a>
<a name="ln28">#include &quot;if.h&quot;</a>
<a name="ln29">#include &quot;prefix.h&quot;</a>
<a name="ln30">#include &quot;filter.h&quot;</a>
<a name="ln31">#include &quot;command.h&quot;</a>
<a name="ln32">#include &quot;linklist.h&quot;</a>
<a name="ln33">#include &quot;memory.h&quot;</a>
<a name="ln34"> </a>
<a name="ln35">#include &quot;ripngd/ripngd.h&quot;</a>
<a name="ln36"> </a>
<a name="ln37">#define RIPNG_OFFSET_LIST_IN  0</a>
<a name="ln38">#define RIPNG_OFFSET_LIST_OUT 1</a>
<a name="ln39">#define RIPNG_OFFSET_LIST_MAX 2</a>
<a name="ln40"> </a>
<a name="ln41">struct ripng_offset_list</a>
<a name="ln42">{</a>
<a name="ln43">  char *ifname;</a>
<a name="ln44"> </a>
<a name="ln45">  struct </a>
<a name="ln46">  {</a>
<a name="ln47">    char *alist_name;</a>
<a name="ln48">    /* struct access_list *alist; */</a>
<a name="ln49">    int metric;</a>
<a name="ln50">  } direct[RIPNG_OFFSET_LIST_MAX];</a>
<a name="ln51">};</a>
<a name="ln52"> </a>
<a name="ln53">static struct list *ripng_offset_list_master;</a>
<a name="ln54"> </a>
<a name="ln55">static int</a>
<a name="ln56">strcmp_safe (const char *s1, const char *s2)</a>
<a name="ln57">{</a>
<a name="ln58">  if (s1 == NULL &amp;&amp; s2 == NULL)</a>
<a name="ln59">    return 0;</a>
<a name="ln60">  if (s1 == NULL)</a>
<a name="ln61">    return -1;</a>
<a name="ln62">  if (s2 == NULL)</a>
<a name="ln63">    return 1;</a>
<a name="ln64">  return strcmp (s1, s2);</a>
<a name="ln65">}</a>
<a name="ln66"> </a>
<a name="ln67">static struct ripng_offset_list *</a>
<a name="ln68">ripng_offset_list_new ()</a>
<a name="ln69">{</a>
<a name="ln70">  struct ripng_offset_list *new;</a>
<a name="ln71"> </a>
<a name="ln72">  new = XCALLOC (MTYPE_RIPNG_OFFSET_LIST, sizeof (struct ripng_offset_list));</a>
<a name="ln73">  return new;</a>
<a name="ln74">}</a>
<a name="ln75"> </a>
<a name="ln76">static void</a>
<a name="ln77">ripng_offset_list_free (struct ripng_offset_list *offset)</a>
<a name="ln78">{</a>
<a name="ln79">  XFREE (MTYPE_RIPNG_OFFSET_LIST, offset);</a>
<a name="ln80">}</a>
<a name="ln81"> </a>
<a name="ln82">static struct ripng_offset_list *</a>
<a name="ln83">ripng_offset_list_lookup (const char *ifname)</a>
<a name="ln84">{</a>
<a name="ln85">  struct ripng_offset_list *offset;</a>
<a name="ln86">  struct listnode *node, *nnode;</a>
<a name="ln87"> </a>
<a name="ln88">  for (ALL_LIST_ELEMENTS (ripng_offset_list_master, node, nnode, offset))</a>
<a name="ln89">    {</a>
<a name="ln90">      if (strcmp_safe (offset-&gt;ifname, ifname) == 0)</a>
<a name="ln91">	return offset;</a>
<a name="ln92">    }</a>
<a name="ln93">  return NULL;</a>
<a name="ln94">}</a>
<a name="ln95"> </a>
<a name="ln96">static struct ripng_offset_list *</a>
<a name="ln97">ripng_offset_list_get (const char *ifname)</a>
<a name="ln98">{</a>
<a name="ln99">  struct ripng_offset_list *offset;</a>
<a name="ln100">  </a>
<a name="ln101">  offset = ripng_offset_list_lookup (ifname);</a>
<a name="ln102">  if (offset)</a>
<a name="ln103">    return offset;</a>
<a name="ln104"> </a>
<a name="ln105">  offset = ripng_offset_list_new ();</a>
<a name="ln106">  if (ifname)</a>
<a name="ln107">    offset-&gt;ifname = strdup (ifname);</a>
<a name="ln108">  listnode_add_sort (ripng_offset_list_master, offset);</a>
<a name="ln109"> </a>
<a name="ln110">  return offset;</a>
<a name="ln111">}</a>
<a name="ln112"> </a>
<a name="ln113">static int</a>
<a name="ln114">ripng_offset_list_set (struct vty *vty, const char *alist,</a>
<a name="ln115">		       const char *direct_str, const char *metric_str,</a>
<a name="ln116">		       const char *ifname)</a>
<a name="ln117">{</a>
<a name="ln118">  int direct;</a>
<a name="ln119">  int metric;</a>
<a name="ln120">  struct ripng_offset_list *offset;</a>
<a name="ln121"> </a>
<a name="ln122">  /* Check direction. */</a>
<a name="ln123">  if (strncmp (direct_str, &quot;i&quot;, 1) == 0)</a>
<a name="ln124">    direct = RIPNG_OFFSET_LIST_IN;</a>
<a name="ln125">  else if (strncmp (direct_str, &quot;o&quot;, 1) == 0)</a>
<a name="ln126">    direct = RIPNG_OFFSET_LIST_OUT;</a>
<a name="ln127">  else</a>
<a name="ln128">    {</a>
<a name="ln129">      vty_out (vty, &quot;Invalid direction: %s%s&quot;, direct_str, VTY_NEWLINE);</a>
<a name="ln130">      return CMD_WARNING;</a>
<a name="ln131">    }</a>
<a name="ln132"> </a>
<a name="ln133">  /* Check metric. */</a>
<a name="ln134">  metric = atoi (metric_str);</a>
<a name="ln135">  if (metric &lt; 0 || metric &gt; 16)</a>
<a name="ln136">    {</a>
<a name="ln137">      vty_out (vty, &quot;Invalid metric: %s%s&quot;, metric_str, VTY_NEWLINE);</a>
<a name="ln138">      return CMD_WARNING;</a>
<a name="ln139">    }</a>
<a name="ln140"> </a>
<a name="ln141">  /* Get offset-list structure with interface name. */</a>
<a name="ln142">  offset = ripng_offset_list_get (ifname);</a>
<a name="ln143"> </a>
<a name="ln144">  if (offset-&gt;direct[direct].alist_name)</a>
<a name="ln145">    free (offset-&gt;direct[direct].alist_name);</a>
<a name="ln146">  offset-&gt;direct[direct].alist_name = strdup (alist);</a>
<a name="ln147">  offset-&gt;direct[direct].metric = metric;</a>
<a name="ln148"> </a>
<a name="ln149">  return CMD_SUCCESS;</a>
<a name="ln150">}</a>
<a name="ln151"> </a>
<a name="ln152">static int</a>
<a name="ln153">ripng_offset_list_unset (struct vty *vty, const char *alist,</a>
<a name="ln154">			 const char *direct_str, const char *metric_str,</a>
<a name="ln155">			 const char *ifname)</a>
<a name="ln156">{</a>
<a name="ln157">  int direct;</a>
<a name="ln158">  int metric;</a>
<a name="ln159">  struct ripng_offset_list *offset;</a>
<a name="ln160"> </a>
<a name="ln161">  /* Check direction. */</a>
<a name="ln162">  if (strncmp (direct_str, &quot;i&quot;, 1) == 0)</a>
<a name="ln163">    direct = RIPNG_OFFSET_LIST_IN;</a>
<a name="ln164">  else if (strncmp (direct_str, &quot;o&quot;, 1) == 0)</a>
<a name="ln165">    direct = RIPNG_OFFSET_LIST_OUT;</a>
<a name="ln166">  else</a>
<a name="ln167">    {</a>
<a name="ln168">      vty_out (vty, &quot;Invalid direction: %s%s&quot;, direct_str, VTY_NEWLINE);</a>
<a name="ln169">      return CMD_WARNING;</a>
<a name="ln170">    }</a>
<a name="ln171"> </a>
<a name="ln172">  /* Check metric. */</a>
<a name="ln173">  metric = atoi (metric_str);</a>
<a name="ln174">  if (metric &lt; 0 || metric &gt; 16)</a>
<a name="ln175">    {</a>
<a name="ln176">      vty_out (vty, &quot;Invalid metric: %s%s&quot;, metric_str, VTY_NEWLINE);</a>
<a name="ln177">      return CMD_WARNING;</a>
<a name="ln178">    }</a>
<a name="ln179"> </a>
<a name="ln180">  /* Get offset-list structure with interface name. */</a>
<a name="ln181">  offset = ripng_offset_list_lookup (ifname);</a>
<a name="ln182"> </a>
<a name="ln183">  if (offset)</a>
<a name="ln184">    {</a>
<a name="ln185">      if (offset-&gt;direct[direct].alist_name)</a>
<a name="ln186">	free (offset-&gt;direct[direct].alist_name);</a>
<a name="ln187">      offset-&gt;direct[direct].alist_name = NULL;</a>
<a name="ln188"> </a>
<a name="ln189">      if (offset-&gt;direct[RIPNG_OFFSET_LIST_IN].alist_name == NULL &amp;&amp;</a>
<a name="ln190">	  offset-&gt;direct[RIPNG_OFFSET_LIST_OUT].alist_name == NULL)</a>
<a name="ln191">	{</a>
<a name="ln192">	  listnode_delete (ripng_offset_list_master, offset);</a>
<a name="ln193">	  if (offset-&gt;ifname)</a>
<a name="ln194">	    free (offset-&gt;ifname);</a>
<a name="ln195">	  ripng_offset_list_free (offset);</a>
<a name="ln196">	}</a>
<a name="ln197">    }</a>
<a name="ln198">  else</a>
<a name="ln199">    {</a>
<a name="ln200">      vty_out (vty, &quot;Can't find offset-list%s&quot;, VTY_NEWLINE);</a>
<a name="ln201">      return CMD_WARNING;</a>
<a name="ln202">    }</a>
<a name="ln203">  return CMD_SUCCESS;</a>
<a name="ln204">}</a>
<a name="ln205"> </a>
<a name="ln206">#define OFFSET_LIST_IN_NAME(O)  ((O)-&gt;direct[RIPNG_OFFSET_LIST_IN].alist_name)</a>
<a name="ln207">#define OFFSET_LIST_IN_METRIC(O)  ((O)-&gt;direct[RIPNG_OFFSET_LIST_IN].metric)</a>
<a name="ln208"> </a>
<a name="ln209">#define OFFSET_LIST_OUT_NAME(O)  ((O)-&gt;direct[RIPNG_OFFSET_LIST_OUT].alist_name)</a>
<a name="ln210">#define OFFSET_LIST_OUT_METRIC(O)  ((O)-&gt;direct[RIPNG_OFFSET_LIST_OUT].metric)</a>
<a name="ln211"> </a>
<a name="ln212">/* If metric is modifed return 1. */</a>
<a name="ln213">int</a>
<a name="ln214">ripng_offset_list_apply_in (struct prefix_ipv6 *p, struct interface *ifp,</a>
<a name="ln215">			    u_char *metric)</a>
<a name="ln216">{</a>
<a name="ln217">  struct ripng_offset_list *offset;</a>
<a name="ln218">  struct access_list *alist;</a>
<a name="ln219"> </a>
<a name="ln220">  /* Look up offset-list with interface name. */</a>
<a name="ln221">  offset = ripng_offset_list_lookup (ifp-&gt;name);</a>
<a name="ln222">  if (offset &amp;&amp; OFFSET_LIST_IN_NAME (offset))</a>
<a name="ln223">    {</a>
<a name="ln224">      alist = access_list_lookup (AFI_IP6, OFFSET_LIST_IN_NAME (offset));</a>
<a name="ln225"> </a>
<a name="ln226">      if (alist </a>
<a name="ln227">	  &amp;&amp; access_list_apply (alist, (struct prefix *)p) == FILTER_PERMIT)</a>
<a name="ln228">	{</a>
<a name="ln229">	  *metric += OFFSET_LIST_IN_METRIC (offset);</a>
<a name="ln230">	  return 1;</a>
<a name="ln231">	}</a>
<a name="ln232">      return 0;</a>
<a name="ln233">    }</a>
<a name="ln234">  /* Look up offset-list without interface name. */</a>
<a name="ln235">  offset = ripng_offset_list_lookup (NULL);</a>
<a name="ln236">  if (offset &amp;&amp; OFFSET_LIST_IN_NAME (offset))</a>
<a name="ln237">    {</a>
<a name="ln238">      alist = access_list_lookup (AFI_IP6, OFFSET_LIST_IN_NAME (offset));</a>
<a name="ln239"> </a>
<a name="ln240">      if (alist </a>
<a name="ln241">	  &amp;&amp; access_list_apply (alist, (struct prefix *)p) == FILTER_PERMIT)</a>
<a name="ln242">	{</a>
<a name="ln243">	  *metric += OFFSET_LIST_IN_METRIC (offset);</a>
<a name="ln244">	  return 1;</a>
<a name="ln245">	}</a>
<a name="ln246">      return 0;</a>
<a name="ln247">    }</a>
<a name="ln248">  return 0;</a>
<a name="ln249">}</a>
<a name="ln250"> </a>
<a name="ln251">/* If metric is modifed return 1. */</a>
<a name="ln252">int</a>
<a name="ln253">ripng_offset_list_apply_out (struct prefix_ipv6 *p, struct interface *ifp,</a>
<a name="ln254">			     u_char *metric)</a>
<a name="ln255">{</a>
<a name="ln256">  struct ripng_offset_list *offset;</a>
<a name="ln257">  struct access_list *alist;</a>
<a name="ln258"> </a>
<a name="ln259">  /* Look up offset-list with interface name. */</a>
<a name="ln260">  offset = ripng_offset_list_lookup (ifp-&gt;name);</a>
<a name="ln261">  if (offset &amp;&amp; OFFSET_LIST_OUT_NAME (offset))</a>
<a name="ln262">    {</a>
<a name="ln263">      alist = access_list_lookup (AFI_IP6, OFFSET_LIST_OUT_NAME (offset));</a>
<a name="ln264"> </a>
<a name="ln265">      if (alist </a>
<a name="ln266">	  &amp;&amp; access_list_apply (alist, (struct prefix *)p) == FILTER_PERMIT)</a>
<a name="ln267">	{</a>
<a name="ln268">	  *metric += OFFSET_LIST_OUT_METRIC (offset);</a>
<a name="ln269">	  return 1;</a>
<a name="ln270">	}</a>
<a name="ln271">      return 0;</a>
<a name="ln272">    }</a>
<a name="ln273"> </a>
<a name="ln274">  /* Look up offset-list without interface name. */</a>
<a name="ln275">  offset = ripng_offset_list_lookup (NULL);</a>
<a name="ln276">  if (offset &amp;&amp; OFFSET_LIST_OUT_NAME (offset))</a>
<a name="ln277">    {</a>
<a name="ln278">      alist = access_list_lookup (AFI_IP6, OFFSET_LIST_OUT_NAME (offset));</a>
<a name="ln279"> </a>
<a name="ln280">      if (alist </a>
<a name="ln281">	  &amp;&amp; access_list_apply (alist, (struct prefix *)p) == FILTER_PERMIT)</a>
<a name="ln282">	{</a>
<a name="ln283">	  *metric += OFFSET_LIST_OUT_METRIC (offset);</a>
<a name="ln284">	  return 1;</a>
<a name="ln285">	}</a>
<a name="ln286">      return 0;</a>
<a name="ln287">    }</a>
<a name="ln288">  return 0;</a>
<a name="ln289">}</a>
<a name="ln290"> </a>
<a name="ln291">DEFUN (ripng_offset_list,</a>
<a name="ln292">       ripng_offset_list_cmd,</a>
<a name="ln293">       &quot;offset-list WORD (in|out) &lt;0-16&gt;&quot;,</a>
<a name="ln294">       &quot;Modify RIPng metric\n&quot;</a>
<a name="ln295">       &quot;Access-list name\n&quot;</a>
<a name="ln296">       &quot;For incoming updates\n&quot;</a>
<a name="ln297">       &quot;For outgoing updates\n&quot;</a>
<a name="ln298">       &quot;Metric value\n&quot;)</a>
<a name="ln299">{</a>
<a name="ln300">  return ripng_offset_list_set (vty, argv[0], argv[1], argv[2], NULL);</a>
<a name="ln301">}</a>
<a name="ln302"> </a>
<a name="ln303">DEFUN (ripng_offset_list_ifname,</a>
<a name="ln304">       ripng_offset_list_ifname_cmd,</a>
<a name="ln305">       &quot;offset-list WORD (in|out) &lt;0-16&gt; IFNAME&quot;,</a>
<a name="ln306">       &quot;Modify RIPng metric\n&quot;</a>
<a name="ln307">       &quot;Access-list name\n&quot;</a>
<a name="ln308">       &quot;For incoming updates\n&quot;</a>
<a name="ln309">       &quot;For outgoing updates\n&quot;</a>
<a name="ln310">       &quot;Metric value\n&quot;</a>
<a name="ln311">       &quot;Interface to match\n&quot;)</a>
<a name="ln312">{</a>
<a name="ln313">  return ripng_offset_list_set (vty, argv[0], argv[1], argv[2], argv[3]);</a>
<a name="ln314">}</a>
<a name="ln315"> </a>
<a name="ln316">DEFUN (no_ripng_offset_list,</a>
<a name="ln317">       no_ripng_offset_list_cmd,</a>
<a name="ln318">       &quot;no offset-list WORD (in|out) &lt;0-16&gt;&quot;,</a>
<a name="ln319">       NO_STR</a>
<a name="ln320">       &quot;Modify RIPng metric\n&quot;</a>
<a name="ln321">       &quot;Access-list name\n&quot;</a>
<a name="ln322">       &quot;For incoming updates\n&quot;</a>
<a name="ln323">       &quot;For outgoing updates\n&quot;</a>
<a name="ln324">       &quot;Metric value\n&quot;)</a>
<a name="ln325">{</a>
<a name="ln326">  return ripng_offset_list_unset (vty, argv[0], argv[1], argv[2], NULL);</a>
<a name="ln327">}</a>
<a name="ln328"> </a>
<a name="ln329">DEFUN (no_ripng_offset_list_ifname,</a>
<a name="ln330">       no_ripng_offset_list_ifname_cmd,</a>
<a name="ln331">       &quot;no offset-list WORD (in|out) &lt;0-16&gt; IFNAME&quot;,</a>
<a name="ln332">       NO_STR</a>
<a name="ln333">       &quot;Modify RIPng metric\n&quot;</a>
<a name="ln334">       &quot;Access-list name\n&quot;</a>
<a name="ln335">       &quot;For incoming updates\n&quot;</a>
<a name="ln336">       &quot;For outgoing updates\n&quot;</a>
<a name="ln337">       &quot;Metric value\n&quot;</a>
<a name="ln338">       &quot;Interface to match\n&quot;)</a>
<a name="ln339">{</a>
<a name="ln340">  return ripng_offset_list_unset (vty, argv[0], argv[1], argv[2], argv[3]);</a>
<a name="ln341">}</a>
<a name="ln342"> </a>
<a name="ln343">static int</a>
<a name="ln344">offset_list_cmp (struct ripng_offset_list *o1, struct ripng_offset_list *o2)</a>
<a name="ln345">{</a>
<a name="ln346">  return strcmp_safe (o1-&gt;ifname, o2-&gt;ifname);</a>
<a name="ln347">}</a>
<a name="ln348"> </a>
<a name="ln349">static void</a>
<a name="ln350">offset_list_del (struct ripng_offset_list *offset)</a>
<a name="ln351">{</a>
<a name="ln352">  if (OFFSET_LIST_IN_NAME (offset))</a>
<a name="ln353">    free (OFFSET_LIST_IN_NAME (offset));</a>
<a name="ln354">  if (OFFSET_LIST_OUT_NAME (offset))</a>
<a name="ln355">    free (OFFSET_LIST_OUT_NAME (offset));</a>
<a name="ln356">  if (offset-&gt;ifname)</a>
<a name="ln357">    free (offset-&gt;ifname);</a>
<a name="ln358">  ripng_offset_list_free (offset);</a>
<a name="ln359">}</a>
<a name="ln360"> </a>
<a name="ln361">void</a>
<a name="ln362">ripng_offset_init (void)</a>
<a name="ln363">{</a>
<a name="ln364">  ripng_offset_list_master = list_new ();</a>
<a name="ln365">  ripng_offset_list_master-&gt;cmp = (int (*)(void *, void *)) offset_list_cmp;</a>
<a name="ln366">  ripng_offset_list_master-&gt;del = (void (*)(void *)) offset_list_del;</a>
<a name="ln367"> </a>
<a name="ln368">  install_element (RIPNG_NODE, &amp;ripng_offset_list_cmd);</a>
<a name="ln369">  install_element (RIPNG_NODE, &amp;ripng_offset_list_ifname_cmd);</a>
<a name="ln370">  install_element (RIPNG_NODE, &amp;no_ripng_offset_list_cmd);</a>
<a name="ln371">  install_element (RIPNG_NODE, &amp;no_ripng_offset_list_ifname_cmd);</a>
<a name="ln372">}</a>
<a name="ln373"> </a>
<a name="ln374">void</a>
<a name="ln375">ripng_offset_clean (void)</a>
<a name="ln376">{</a>
<a name="ln377">  list_delete (ripng_offset_list_master);</a>
<a name="ln378"> </a>
<a name="ln379">  ripng_offset_list_master = list_new ();</a>
<a name="ln380">  ripng_offset_list_master-&gt;cmp = (int (*)(void *, void *)) offset_list_cmp;</a>
<a name="ln381">  ripng_offset_list_master-&gt;del = (void (*)(void *)) offset_list_del;</a>
<a name="ln382">}</a>
<a name="ln383"> </a>
<a name="ln384">int</a>
<a name="ln385">config_write_ripng_offset_list (struct vty *vty)</a>
<a name="ln386">{</a>
<a name="ln387">  struct listnode *node, *nnode;</a>
<a name="ln388">  struct ripng_offset_list *offset;</a>
<a name="ln389"> </a>
<a name="ln390">  for (ALL_LIST_ELEMENTS (ripng_offset_list_master, node, nnode, offset))</a>
<a name="ln391">    {</a>
<a name="ln392">      if (! offset-&gt;ifname)</a>
<a name="ln393">	{</a>
<a name="ln394">	  if (offset-&gt;direct[RIPNG_OFFSET_LIST_IN].alist_name)</a>
<a name="ln395">	    vty_out (vty, &quot; offset-list %s in %d%s&quot;,</a>
<a name="ln396">		     offset-&gt;direct[RIPNG_OFFSET_LIST_IN].alist_name,</a>
<a name="ln397">		     offset-&gt;direct[RIPNG_OFFSET_LIST_IN].metric,</a>
<a name="ln398">		     VTY_NEWLINE);</a>
<a name="ln399">	  if (offset-&gt;direct[RIPNG_OFFSET_LIST_OUT].alist_name)</a>
<a name="ln400">	    vty_out (vty, &quot; offset-list %s out %d%s&quot;,</a>
<a name="ln401">		     offset-&gt;direct[RIPNG_OFFSET_LIST_OUT].alist_name,</a>
<a name="ln402">		     offset-&gt;direct[RIPNG_OFFSET_LIST_OUT].metric,</a>
<a name="ln403">		     VTY_NEWLINE);</a>
<a name="ln404">	}</a>
<a name="ln405">      else</a>
<a name="ln406">	{</a>
<a name="ln407">	  if (offset-&gt;direct[RIPNG_OFFSET_LIST_IN].alist_name)</a>
<a name="ln408">	    vty_out (vty, &quot; offset-list %s in %d %s%s&quot;,</a>
<a name="ln409">		     offset-&gt;direct[RIPNG_OFFSET_LIST_IN].alist_name,</a>
<a name="ln410">		     offset-&gt;direct[RIPNG_OFFSET_LIST_IN].metric,</a>
<a name="ln411">		     offset-&gt;ifname, VTY_NEWLINE);</a>
<a name="ln412">	  if (offset-&gt;direct[RIPNG_OFFSET_LIST_OUT].alist_name)</a>
<a name="ln413">	    vty_out (vty, &quot; offset-list %s out %d %s%s&quot;,</a>
<a name="ln414">		     offset-&gt;direct[RIPNG_OFFSET_LIST_OUT].alist_name,</a>
<a name="ln415">		     offset-&gt;direct[RIPNG_OFFSET_LIST_OUT].metric,</a>
<a name="ln416">		     offset-&gt;ifname, VTY_NEWLINE);</a>
<a name="ln417">	}</a>
<a name="ln418">    }</a>
<a name="ln419"> </a>
<a name="ln420">  return 0;</a>
<a name="ln421">}</a>

</code></pre>
<div class="balloon" rel="7"><p><span style="font-size:18px">&uarr;</span> <a href="https://pvs-studio.com/en/docs/warnings/v1042/" target="_blank">V1042</a> This file is marked with copyleft license, which requires you to open the derived source code.</p></div>

<link rel="stylesheet" href="highlight.css">
<script src="highlight.pack.js"></script>
<script src="highlightjs-line-numbers.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
<script>hljs.initLineNumbersOnLoad();</script>
<script>
  $(document).ready(function() {
      $('.balloon').each(function () {
          var bl = $(this);
          var line = bl.attr('rel');
          var text = $('a[name="ln'+line+'"]').text();

          var space_count = 0;
          for(var i = 0; i<text.length; i++){
              var char = text[i];
              if((char !== ' ')&&(char !== '\t'))break;
              if(char === '\t')space_count++;
              space_count++;
          }

          bl.css('margin-left', space_count*8);
          $('a[name="ln'+line+'"]').after(bl);
      });

      window.location = window.location;
  });
</script>
</body>
</html>
