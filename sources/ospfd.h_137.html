
<html>
<head>

  <meta http-equiv="Content-Type" content="text/html; charset=US-ASCII" />
  <title>ospfd.h</title>

  <link rel="stylesheet" href="../style.css"/>
  <script src="../jquery-3.5.1.min.js"></script>
</head>
<body>

<pre><code class = "cpp">
<a name="ln1">/*</a>
<a name="ln2"> * OSPFd main header.</a>
<a name="ln3"> * Copyright (C) 1998, 99, 2000 Kunihiro Ishiguro, Toshiaki Takada</a>
<a name="ln4"> *</a>
<a name="ln5"> * This file is part of GNU Zebra.</a>
<a name="ln6"> *</a>
<a name="ln7"> * GNU Zebra is free software; you can redistribute it and/or modify it</a>
<a name="ln8"> * under the terms of the GNU General Public License as published by the</a>
<a name="ln9"> * Free Software Foundation; either version 2, or (at your option) any</a>
<a name="ln10"> * later version.</a>
<a name="ln11"> * </a>
<a name="ln12"> * GNU Zebra is distributed in the hope that it will be useful, but</a>
<a name="ln13"> * WITHOUT ANY WARRANTY; without even the implied warranty of</a>
<a name="ln14"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</a>
<a name="ln15"> * General Public License for more details.</a>
<a name="ln16"> *</a>
<a name="ln17"> * You should have received a copy of the GNU General Public License</a>
<a name="ln18"> * along with GNU Zebra; see the file COPYING.  If not, write to the Free</a>
<a name="ln19"> * Software Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA</a>
<a name="ln20"> * 02111-1307, USA.</a>
<a name="ln21"> */</a>
<a name="ln22"> </a>
<a name="ln23">#ifndef _ZEBRA_OSPFD_H</a>
<a name="ln24">#define _ZEBRA_OSPFD_H</a>
<a name="ln25"> </a>
<a name="ln26">#include &lt;zebra.h&gt;</a>
<a name="ln27">#include &quot;libospf.h&quot;</a>
<a name="ln28"> </a>
<a name="ln29">#include &quot;filter.h&quot;</a>
<a name="ln30">#include &quot;log.h&quot;</a>
<a name="ln31"> </a>
<a name="ln32">#define OSPF_VERSION            2</a>
<a name="ln33"> </a>
<a name="ln34">/* VTY port number. */</a>
<a name="ln35">#define OSPF_VTY_PORT          2604</a>
<a name="ln36"> </a>
<a name="ln37">/* IP TTL for OSPF protocol. */</a>
<a name="ln38">#define OSPF_IP_TTL             1</a>
<a name="ln39">#define OSPF_VL_IP_TTL          100</a>
<a name="ln40"> </a>
<a name="ln41">/* Default configuration file name for ospfd. */</a>
<a name="ln42">#define OSPF_DEFAULT_CONFIG   &quot;ospfd.conf&quot;</a>
<a name="ln43"> </a>
<a name="ln44">#define OSPF_NSSA_TRANS_STABLE_DEFAULT		40</a>
<a name="ln45"> </a>
<a name="ln46">#define OSPF_ALLSPFROUTERS              0xe0000005      /* 224.0.0.5 */</a>
<a name="ln47">#define OSPF_ALLDROUTERS                0xe0000006      /* 224.0.0.6 */</a>
<a name="ln48"> </a>
<a name="ln49"> </a>
<a name="ln50">/* OSPF Authentication Type. */</a>
<a name="ln51">#define OSPF_AUTH_NULL                      0</a>
<a name="ln52">#define OSPF_AUTH_SIMPLE                    1</a>
<a name="ln53">#define OSPF_AUTH_CRYPTOGRAPHIC             2</a>
<a name="ln54">/* For Interface authentication setting default */</a>
<a name="ln55">#define OSPF_AUTH_NOTSET                   -1</a>
<a name="ln56">/* For the consumption and sanity of the command handler */ </a>
<a name="ln57">/* DO NIOT REMOVE!!! Need to detect whether a value has</a>
<a name="ln58">   been given or not in VLink command handlers */</a>
<a name="ln59">#define OSPF_AUTH_CMD_NOTSEEN              -2</a>
<a name="ln60"> </a>
<a name="ln61">/* OSPF options. */</a>
<a name="ln62">#define OSPF_OPTION_MT                   0x01  /* M/T */</a>
<a name="ln63">#define OSPF_OPTION_E                    0x02</a>
<a name="ln64">#define OSPF_OPTION_MC                   0x04</a>
<a name="ln65">#define OSPF_OPTION_NP                   0x08</a>
<a name="ln66">#define OSPF_OPTION_EA                   0x10</a>
<a name="ln67">#define OSPF_OPTION_DC                   0x20</a>
<a name="ln68">#define OSPF_OPTION_O                    0x40</a>
<a name="ln69">#define OSPF_OPTION_DN                   0x80</a>
<a name="ln70"> </a>
<a name="ln71">/* OSPF Database Description flags. */</a>
<a name="ln72">#define OSPF_DD_FLAG_MS                  0x01</a>
<a name="ln73">#define OSPF_DD_FLAG_M                   0x02</a>
<a name="ln74">#define OSPF_DD_FLAG_I                   0x04</a>
<a name="ln75">#define OSPF_DD_FLAG_ALL                 0x07</a>
<a name="ln76"> </a>
<a name="ln77">#define OSPF_LS_REFRESH_SHIFT       (60 * 15)</a>
<a name="ln78">#define OSPF_LS_REFRESH_JITTER      60</a>
<a name="ln79"> </a>
<a name="ln80">/* OSPF master for system wide configuration and variables. */</a>
<a name="ln81">struct ospf_master</a>
<a name="ln82">{</a>
<a name="ln83">  /* OSPF instance. */</a>
<a name="ln84">  struct list *ospf;</a>
<a name="ln85"> </a>
<a name="ln86">  /* OSPF thread master. */</a>
<a name="ln87">  struct thread_master *master;</a>
<a name="ln88"> </a>
<a name="ln89">  /* Zebra interface list. */</a>
<a name="ln90">  struct list *iflist;</a>
<a name="ln91"> </a>
<a name="ln92">  /* Redistributed external information. */</a>
<a name="ln93">  struct route_table *external_info[ZEBRA_ROUTE_MAX + 1];</a>
<a name="ln94">#define EXTERNAL_INFO(T)      om-&gt;external_info[T]</a>
<a name="ln95"> </a>
<a name="ln96">  /* OSPF start time. */</a>
<a name="ln97">  time_t start_time;</a>
<a name="ln98"> </a>
<a name="ln99">  /* Various OSPF global configuration. */</a>
<a name="ln100">  u_char options;</a>
<a name="ln101">#define OSPF_MASTER_SHUTDOWN (1 &lt;&lt; 0) /* deferred-shutdown */  </a>
<a name="ln102">};</a>
<a name="ln103"> </a>
<a name="ln104">/* OSPF instance structure. */</a>
<a name="ln105">struct ospf</a>
<a name="ln106">{</a>
<a name="ln107">  /* OSPF Router ID. */</a>
<a name="ln108">  struct in_addr router_id;		/* Configured automatically. */</a>
<a name="ln109">  struct in_addr router_id_static;	/* Configured manually. */</a>
<a name="ln110"> </a>
<a name="ln111">  /* ABR/ASBR internal flags. */</a>
<a name="ln112">  u_char flags;</a>
<a name="ln113">#define OSPF_FLAG_ABR           0x0001</a>
<a name="ln114">#define OSPF_FLAG_ASBR          0x0002</a>
<a name="ln115"> </a>
<a name="ln116">  /* ABR type. */</a>
<a name="ln117">  u_char abr_type;</a>
<a name="ln118">#define OSPF_ABR_UNKNOWN	0</a>
<a name="ln119">#define OSPF_ABR_STAND          1</a>
<a name="ln120">#define OSPF_ABR_IBM            2</a>
<a name="ln121">#define OSPF_ABR_CISCO          3</a>
<a name="ln122">#define OSPF_ABR_SHORTCUT       4</a>
<a name="ln123">#define OSPF_ABR_DEFAULT	OSPF_ABR_CISCO</a>
<a name="ln124"> </a>
<a name="ln125">  /* NSSA ABR */</a>
<a name="ln126">  u_char anyNSSA;		/* Bump for every NSSA attached. */</a>
<a name="ln127"> </a>
<a name="ln128">  /* Configured variables. */</a>
<a name="ln129">  u_char config;</a>
<a name="ln130">#define OSPF_RFC1583_COMPATIBLE         (1 &lt;&lt; 0)</a>
<a name="ln131">#define OSPF_OPAQUE_CAPABLE		(1 &lt;&lt; 2)</a>
<a name="ln132">#define OSPF_LOG_ADJACENCY_CHANGES	(1 &lt;&lt; 3)</a>
<a name="ln133">#define OSPF_LOG_ADJACENCY_DETAIL	(1 &lt;&lt; 4)</a>
<a name="ln134"> </a>
<a name="ln135">  /* Opaque-LSA administrative flags. */</a>
<a name="ln136">  u_char opaque;</a>
<a name="ln137">#define OPAQUE_OPERATION_READY_BIT	(1 &lt;&lt; 0)</a>
<a name="ln138"> </a>
<a name="ln139">  /* RFC3137 stub router. Configured time to stay stub / max-metric */</a>
<a name="ln140">  unsigned int stub_router_startup_time;	/* seconds */</a>
<a name="ln141">  unsigned int stub_router_shutdown_time;	/* seconds */</a>
<a name="ln142">#define OSPF_STUB_ROUTER_UNCONFIGURED	  0</a>
<a name="ln143">  u_char       stub_router_admin_set;</a>
<a name="ln144">#define OSPF_STUB_ROUTER_ADMINISTRATIVE_SET     1</a>
<a name="ln145">#define OSPF_STUB_ROUTER_ADMINISTRATIVE_UNSET   0</a>
<a name="ln146"> </a>
<a name="ln147">#define OSPF_STUB_MAX_METRIC_SUMMARY_COST	0x00ff0000</a>
<a name="ln148"> </a>
<a name="ln149">  /* LSA timers */</a>
<a name="ln150">  unsigned int min_ls_interval; /* minimum delay between LSAs (in msec) */</a>
<a name="ln151">  unsigned int min_ls_arrival; /* minimum interarrival time between LSAs (in msec) */</a>
<a name="ln152"> </a>
<a name="ln153">  /* SPF parameters */</a>
<a name="ln154">  unsigned int spf_delay;		/* SPF delay time. */</a>
<a name="ln155">  unsigned int spf_holdtime;		/* SPF hold time. */</a>
<a name="ln156">  unsigned int spf_max_holdtime;	/* SPF maximum-holdtime */</a>
<a name="ln157">  unsigned int spf_hold_multiplier;	/* Adaptive multiplier for hold time */</a>
<a name="ln158">  </a>
<a name="ln159">  int default_originate;		/* Default information originate. */</a>
<a name="ln160">#define DEFAULT_ORIGINATE_NONE		0</a>
<a name="ln161">#define DEFAULT_ORIGINATE_ZEBRA		1</a>
<a name="ln162">#define DEFAULT_ORIGINATE_ALWAYS	2</a>
<a name="ln163">  u_int32_t ref_bandwidth;		/* Reference Bandwidth (Kbps). */</a>
<a name="ln164">  struct route_table *networks;         /* OSPF config networks. */</a>
<a name="ln165">  struct list *vlinks;                  /* Configured Virtual-Links. */</a>
<a name="ln166">  struct list *areas;                   /* OSPF areas. */</a>
<a name="ln167">  struct route_table *nbr_nbma;</a>
<a name="ln168">  struct ospf_area *backbone;           /* Pointer to the Backbone Area. */</a>
<a name="ln169"> </a>
<a name="ln170">  struct list *oiflist;                 /* ospf interfaces */</a>
<a name="ln171">  u_char passive_interface_default;	/* passive-interface default */</a>
<a name="ln172"> </a>
<a name="ln173">  /* LSDB of AS-external-LSAs. */</a>
<a name="ln174">  struct ospf_lsdb *lsdb;</a>
<a name="ln175">  </a>
<a name="ln176">  /* Flags. */</a>
<a name="ln177">  int external_origin;			/* AS-external-LSA origin flag. */</a>
<a name="ln178">  int ase_calc;				/* ASE calculation flag. */</a>
<a name="ln179"> </a>
<a name="ln180">  struct list *opaque_lsa_self;		/* Type-11 Opaque-LSAs */</a>
<a name="ln181"> </a>
<a name="ln182">  /* Routing tables. */</a>
<a name="ln183">  struct route_table *old_table;        /* Old routing table. */</a>
<a name="ln184">  struct route_table *new_table;        /* Current routing table. */</a>
<a name="ln185"> </a>
<a name="ln186">  struct route_table *old_rtrs;         /* Old ABR/ASBR RT. */</a>
<a name="ln187">  struct route_table *new_rtrs;         /* New ABR/ASBR RT. */</a>
<a name="ln188"> </a>
<a name="ln189">  struct route_table *new_external_route;   /* New External Route. */</a>
<a name="ln190">  struct route_table *old_external_route;   /* Old External Route. */</a>
<a name="ln191">  </a>
<a name="ln192">  struct route_table *external_lsas;    /* Database of external LSAs,</a>
<a name="ln193">					   prefix is LSA's adv. network*/</a>
<a name="ln194"> </a>
<a name="ln195">  /* Time stamps */</a>
<a name="ln196">  struct timeval ts_spf;		/* SPF calculation time stamp. */</a>
<a name="ln197">  struct timeval ts_spf_duration;	/* Execution time of last SPF */</a>
<a name="ln198"> </a>
<a name="ln199">  struct route_table *maxage_lsa;       /* List of MaxAge LSA for deletion. */</a>
<a name="ln200">  int redistribute;                     /* Num of redistributed protocols. */</a>
<a name="ln201"> </a>
<a name="ln202">  /* Threads. */</a>
<a name="ln203">  struct thread *t_abr_task;            /* ABR task timer. */</a>
<a name="ln204">  struct thread *t_asbr_check;          /* ASBR check timer. */</a>
<a name="ln205">  struct thread *t_distribute_update;   /* Distirbute list update timer. */</a>
<a name="ln206">  struct thread *t_spf_calc;	        /* SPF calculation timer. */</a>
<a name="ln207">  struct thread *t_ase_calc;		/* ASE calculation timer. */</a>
<a name="ln208">  struct thread *t_external_lsa;	/* AS-external-LSA origin timer. */</a>
<a name="ln209">  struct thread *t_opaque_lsa_self;	/* Type-11 Opaque-LSAs origin event. */</a>
<a name="ln210"> </a>
<a name="ln211">  unsigned int maxage_delay;		/* Delay on Maxage remover timer, sec */</a>
<a name="ln212">  struct thread *t_maxage;              /* MaxAge LSA remover timer. */</a>
<a name="ln213">  struct thread *t_maxage_walker;       /* MaxAge LSA checking timer. */</a>
<a name="ln214"> </a>
<a name="ln215">  struct thread *t_deferred_shutdown;	/* deferred/stub-router shutdown timer*/</a>
<a name="ln216"> </a>
<a name="ln217">  struct thread *t_write;</a>
<a name="ln218">  struct thread *t_read;</a>
<a name="ln219">  int fd;</a>
<a name="ln220">  unsigned int maxsndbuflen;</a>
<a name="ln221">  struct stream *ibuf;</a>
<a name="ln222">  struct list *oi_write_q;</a>
<a name="ln223">  </a>
<a name="ln224">  /* Distribute lists out of other route sources. */</a>
<a name="ln225">  struct </a>
<a name="ln226">  {</a>
<a name="ln227">    char *name;</a>
<a name="ln228">    struct access_list *list;</a>
<a name="ln229">  } dlist[ZEBRA_ROUTE_MAX];</a>
<a name="ln230">#define DISTRIBUTE_NAME(O,T)    (O)-&gt;dlist[T].name</a>
<a name="ln231">#define DISTRIBUTE_LIST(O,T)    (O)-&gt;dlist[T].list</a>
<a name="ln232"> </a>
<a name="ln233">  /* Redistribute metric info. */</a>
<a name="ln234">  struct </a>
<a name="ln235">  {</a>
<a name="ln236">    int type;                   /* External metric type (E1 or E2).  */</a>
<a name="ln237">    int value;		        /* Value for static metric (24-bit).</a>
<a name="ln238">				   -1 means metric value is not set. */</a>
<a name="ln239">  } dmetric [ZEBRA_ROUTE_MAX + 1];</a>
<a name="ln240"> </a>
<a name="ln241">  /* Redistribute tag info. */</a>
<a name="ln242">  route_tag_t dtag [ZEBRA_ROUTE_MAX + 1];</a>
<a name="ln243"> </a>
<a name="ln244">  /* For redistribute route map. */</a>
<a name="ln245">  struct</a>
<a name="ln246">  {</a>
<a name="ln247">    char *name;</a>
<a name="ln248">    struct route_map *map;</a>
<a name="ln249">  } route_map [ZEBRA_ROUTE_MAX + 1]; /* +1 is for default-information */</a>
<a name="ln250">#define ROUTEMAP_NAME(O,T)   (O)-&gt;route_map[T].name</a>
<a name="ln251">#define ROUTEMAP(O,T)        (O)-&gt;route_map[T].map</a>
<a name="ln252">  </a>
<a name="ln253">  int default_metric;		/* Default metric for redistribute. */</a>
<a name="ln254"> </a>
<a name="ln255">#define OSPF_LSA_REFRESHER_GRANULARITY 10</a>
<a name="ln256">#define OSPF_LSA_REFRESHER_SLOTS ((OSPF_LS_REFRESH_TIME + \</a>
<a name="ln257">                                  OSPF_LS_REFRESH_SHIFT)/10 + 1)</a>
<a name="ln258">  struct</a>
<a name="ln259">  {</a>
<a name="ln260">    u_int16_t index;</a>
<a name="ln261">    struct list *qs[OSPF_LSA_REFRESHER_SLOTS];</a>
<a name="ln262">  } lsa_refresh_queue;</a>
<a name="ln263">  </a>
<a name="ln264">  struct thread *t_lsa_refresher;</a>
<a name="ln265">  time_t lsa_refresher_started;</a>
<a name="ln266">#define OSPF_LSA_REFRESH_INTERVAL_DEFAULT 10</a>
<a name="ln267">  u_int16_t lsa_refresh_interval;</a>
<a name="ln268">  </a>
<a name="ln269">  /* Distance parameter. */</a>
<a name="ln270">  u_char distance_all;</a>
<a name="ln271">  u_char distance_intra;</a>
<a name="ln272">  u_char distance_inter;</a>
<a name="ln273">  u_char distance_external;</a>
<a name="ln274"> </a>
<a name="ln275">  /* Statistics for LSA origination. */</a>
<a name="ln276">  u_int32_t lsa_originate_count;</a>
<a name="ln277"> </a>
<a name="ln278">  /* Statistics for LSA used for new instantiation. */</a>
<a name="ln279">  u_int32_t rx_lsa_count;</a>
<a name="ln280"> </a>
<a name="ln281">  struct route_table *distance_table;</a>
<a name="ln282">};</a>
<a name="ln283"> </a>
<a name="ln284">/* OSPF area structure. */</a>
<a name="ln285">struct ospf_area</a>
<a name="ln286">{</a>
<a name="ln287">  /* OSPF instance. */</a>
<a name="ln288">  struct ospf *ospf;</a>
<a name="ln289"> </a>
<a name="ln290">  /* Zebra interface list belonging to the area. */</a>
<a name="ln291">  struct list *oiflist;</a>
<a name="ln292"> </a>
<a name="ln293">  /* Area ID. */</a>
<a name="ln294">  struct in_addr area_id;</a>
<a name="ln295"> </a>
<a name="ln296">  /* Area ID format. */</a>
<a name="ln297">  char format;</a>
<a name="ln298">#define OSPF_AREA_ID_FORMAT_ADDRESS         1</a>
<a name="ln299">#define OSPF_AREA_ID_FORMAT_DECIMAL         2</a>
<a name="ln300"> </a>
<a name="ln301">  /* Address range. */</a>
<a name="ln302">  struct list *address_range;</a>
<a name="ln303"> </a>
<a name="ln304">  /* Configured variables. */</a>
<a name="ln305">  int external_routing;                 /* ExternalRoutingCapability. */</a>
<a name="ln306">#define OSPF_AREA_DEFAULT       0</a>
<a name="ln307">#define OSPF_AREA_STUB          1</a>
<a name="ln308">#define OSPF_AREA_NSSA          2</a>
<a name="ln309">#define OSPF_AREA_TYPE_MAX	3</a>
<a name="ln310">  int no_summary;                       /* Don't inject summaries into stub.*/</a>
<a name="ln311">  int shortcut_configured;              /* Area configured as shortcut. */</a>
<a name="ln312">#define OSPF_SHORTCUT_DEFAULT	0</a>
<a name="ln313">#define OSPF_SHORTCUT_ENABLE	1</a>
<a name="ln314">#define OSPF_SHORTCUT_DISABLE	2</a>
<a name="ln315">  int shortcut_capability;              /* Other ABRs agree on S-bit */</a>
<a name="ln316">  u_int32_t default_cost;               /* StubDefaultCost. */</a>
<a name="ln317">  int auth_type;                        /* Authentication type. */</a>
<a name="ln318">  </a>
<a name="ln319"> </a>
<a name="ln320">  u_char NSSATranslatorRole;          /* NSSA configured role */</a>
<a name="ln321">#define OSPF_NSSA_ROLE_NEVER     0</a>
<a name="ln322">#define OSPF_NSSA_ROLE_CANDIDATE 1</a>
<a name="ln323">#define OSPF_NSSA_ROLE_ALWAYS    2</a>
<a name="ln324">  u_char NSSATranslatorState;              /* NSSA operational role */</a>
<a name="ln325">#define OSPF_NSSA_TRANSLATE_DISABLED 0</a>
<a name="ln326">#define OSPF_NSSA_TRANSLATE_ENABLED  1</a>
<a name="ln327">  int NSSATranslatorStabilityInterval;</a>
<a name="ln328">  </a>
<a name="ln329">  u_char transit;			/* TransitCapability. */</a>
<a name="ln330">#define OSPF_TRANSIT_FALSE      0</a>
<a name="ln331">#define OSPF_TRANSIT_TRUE       1</a>
<a name="ln332">  struct route_table *ranges;		/* Configured Area Ranges. */</a>
<a name="ln333">  </a>
<a name="ln334">  /* RFC3137 stub router state flags for area */</a>
<a name="ln335">  u_char stub_router_state;</a>
<a name="ln336">#define OSPF_AREA_ADMIN_STUB_ROUTED	(1 &lt;&lt; 0) /* admin stub-router set */</a>
<a name="ln337">#define OSPF_AREA_IS_STUB_ROUTED	(1 &lt;&lt; 1) /* stub-router active */</a>
<a name="ln338">#define OSPF_AREA_WAS_START_STUB_ROUTED	(1 &lt;&lt; 2) /* startup SR was done */</a>
<a name="ln339">  </a>
<a name="ln340">  /* Area related LSDBs[Type1-4]. */</a>
<a name="ln341">  struct ospf_lsdb *lsdb;</a>
<a name="ln342"> </a>
<a name="ln343">  /* Self-originated LSAs. */</a>
<a name="ln344">  struct ospf_lsa *router_lsa_self;</a>
<a name="ln345">  struct list *opaque_lsa_self;		/* Type-10 Opaque-LSAs */</a>
<a name="ln346"> </a>
<a name="ln347">  /* Area announce list. */</a>
<a name="ln348">  struct </a>
<a name="ln349">  {</a>
<a name="ln350">    char *name;</a>
<a name="ln351">    struct access_list *list;</a>
<a name="ln352">  } _export;</a>
<a name="ln353">#define EXPORT_NAME(A)  (A)-&gt;_export.name</a>
<a name="ln354">#define EXPORT_LIST(A)  (A)-&gt;_export.list</a>
<a name="ln355"> </a>
<a name="ln356">  /* Area acceptance list. */</a>
<a name="ln357">  struct </a>
<a name="ln358">  {</a>
<a name="ln359">    char *name;</a>
<a name="ln360">    struct access_list *list;</a>
<a name="ln361">  } import;</a>
<a name="ln362">#define IMPORT_NAME(A)  (A)-&gt;import.name</a>
<a name="ln363">#define IMPORT_LIST(A)  (A)-&gt;import.list</a>
<a name="ln364"> </a>
<a name="ln365">  /* Type 3 LSA Area prefix-list. */</a>
<a name="ln366">  struct </a>
<a name="ln367">  {</a>
<a name="ln368">    char *name;</a>
<a name="ln369">    struct prefix_list *list;</a>
<a name="ln370">  } plist_in;</a>
<a name="ln371">#define PREFIX_LIST_IN(A)   (A)-&gt;plist_in.list</a>
<a name="ln372">#define PREFIX_NAME_IN(A)   (A)-&gt;plist_in.name</a>
<a name="ln373"> </a>
<a name="ln374">  struct</a>
<a name="ln375">  {</a>
<a name="ln376">    char *name;</a>
<a name="ln377">    struct prefix_list *list;</a>
<a name="ln378">  } plist_out;</a>
<a name="ln379">#define PREFIX_LIST_OUT(A)  (A)-&gt;plist_out.list</a>
<a name="ln380">#define PREFIX_NAME_OUT(A)  (A)-&gt;plist_out.name</a>
<a name="ln381"> </a>
<a name="ln382">  /* Shortest Path Tree. */</a>
<a name="ln383">  struct vertex *spf;</a>
<a name="ln384"> </a>
<a name="ln385">  /* Threads. */</a>
<a name="ln386">  struct thread *t_stub_router;    /* Stub-router timer */</a>
<a name="ln387">  struct thread *t_opaque_lsa_self;	/* Type-10 Opaque-LSAs origin. */</a>
<a name="ln388"> </a>
<a name="ln389">  /* Statistics field. */</a>
<a name="ln390">  u_int32_t spf_calculation;	/* SPF Calculation Count. */</a>
<a name="ln391"> </a>
<a name="ln392">  /* Time stamps. */</a>
<a name="ln393">  struct timeval ts_spf;		/* SPF calculation time stamp. */</a>
<a name="ln394"> </a>
<a name="ln395">  /* Router count. */</a>
<a name="ln396">  u_int32_t abr_count;		/* ABR router in this area. */</a>
<a name="ln397">  u_int32_t asbr_count;		/* ASBR router in this area. */</a>
<a name="ln398"> </a>
<a name="ln399">  /* Counters. */</a>
<a name="ln400">  u_int32_t act_ints;		/* Active interfaces. */</a>
<a name="ln401">  u_int32_t full_nbrs;		/* Fully adjacent neighbors. */</a>
<a name="ln402">  u_int32_t full_vls;		/* Fully adjacent virtual neighbors. */</a>
<a name="ln403">};</a>
<a name="ln404"> </a>
<a name="ln405">/* OSPF config network structure. */</a>
<a name="ln406">struct ospf_network</a>
<a name="ln407">{</a>
<a name="ln408">  /* Area ID. */</a>
<a name="ln409">  struct in_addr area_id;</a>
<a name="ln410">  int format;</a>
<a name="ln411">};</a>
<a name="ln412"> </a>
<a name="ln413">/* OSPF NBMA neighbor structure. */</a>
<a name="ln414">struct ospf_nbr_nbma</a>
<a name="ln415">{</a>
<a name="ln416">  /* Neighbor IP address. */</a>
<a name="ln417">  struct in_addr addr;</a>
<a name="ln418"> </a>
<a name="ln419">  /* OSPF interface. */</a>
<a name="ln420">  struct ospf_interface *oi;</a>
<a name="ln421"> </a>
<a name="ln422">  /* OSPF neighbor structure. */</a>
<a name="ln423">  struct ospf_neighbor *nbr;</a>
<a name="ln424"> </a>
<a name="ln425">  /* Neighbor priority. */</a>
<a name="ln426">  u_char priority;</a>
<a name="ln427"> </a>
<a name="ln428">  /* Poll timer value. */</a>
<a name="ln429">  u_int32_t v_poll;</a>
<a name="ln430"> </a>
<a name="ln431">  /* Poll timer thread. */</a>
<a name="ln432">  struct thread *t_poll;</a>
<a name="ln433"> </a>
<a name="ln434">  /* State change. */</a>
<a name="ln435">  u_int32_t state_change;</a>
<a name="ln436">};</a>
<a name="ln437"> </a>
<a name="ln438">/* Macro. */</a>
<a name="ln439">#define OSPF_AREA_SAME(X,Y) \</a>
<a name="ln440">        (memcmp ((X-&gt;area_id), (Y-&gt;area_id), IPV4_MAX_BYTELEN) == 0)</a>
<a name="ln441"> </a>
<a name="ln442">#define IS_OSPF_ABR(O)		((O)-&gt;flags &amp; OSPF_FLAG_ABR)</a>
<a name="ln443">#define IS_OSPF_ASBR(O)		((O)-&gt;flags &amp; OSPF_FLAG_ASBR)</a>
<a name="ln444"> </a>
<a name="ln445">#define OSPF_IS_AREA_ID_BACKBONE(I) ((I).s_addr == OSPF_AREA_BACKBONE)</a>
<a name="ln446">#define OSPF_IS_AREA_BACKBONE(A) OSPF_IS_AREA_ID_BACKBONE ((A)-&gt;area_id)</a>
<a name="ln447"> </a>
<a name="ln448">#ifdef roundup</a>
<a name="ln449">#  define ROUNDUP(val, gran)	roundup(val, gran)</a>
<a name="ln450">#else /* roundup */</a>
<a name="ln451">#  define ROUNDUP(val, gran)	(((val) - 1 | (gran) - 1) + 1)</a>
<a name="ln452">#endif /* roundup */</a>
<a name="ln453"> </a>
<a name="ln454">#define LSA_OPTIONS_GET(area) \</a>
<a name="ln455">        (((area)-&gt;external_routing == OSPF_AREA_DEFAULT) ? OSPF_OPTION_E : 0)</a>
<a name="ln456">#define LSA_OPTIONS_NSSA_GET(area) \</a>
<a name="ln457">        (((area)-&gt;external_routing == OSPF_AREA_NSSA)  ? OSPF_OPTION_NP : 0)</a>
<a name="ln458"> </a>
<a name="ln459">#define OSPF_TIMER_ON(T,F,V)                                                  \</a>
<a name="ln460">    do {                                                                      \</a>
<a name="ln461">      if (!(T))                                                               \</a>
<a name="ln462">	(T) = thread_add_timer (master, (F), ospf, (V));                      \</a>
<a name="ln463">    } while (0)</a>
<a name="ln464"> </a>
<a name="ln465">#define OSPF_AREA_TIMER_ON(T,F,V)                                             \</a>
<a name="ln466">    do {                                                                      \</a>
<a name="ln467">      if (!(T))                                                               \</a>
<a name="ln468">        (T) = thread_add_timer (master, (F), area, (V));                      \</a>
<a name="ln469">    } while (0)</a>
<a name="ln470"> </a>
<a name="ln471">#define OSPF_POLL_TIMER_ON(T,F,V)                                             \</a>
<a name="ln472">    do {                                                                      \</a>
<a name="ln473">      if (!(T))                                                               \</a>
<a name="ln474">        (T) = thread_add_timer (master, (F), nbr_nbma, (V));                  \</a>
<a name="ln475">    } while (0)</a>
<a name="ln476"> </a>
<a name="ln477">#define OSPF_POLL_TIMER_OFF(X)		OSPF_TIMER_OFF((X))</a>
<a name="ln478"> </a>
<a name="ln479">#define OSPF_TIMER_OFF(X)                                                     \</a>
<a name="ln480">    do {                                                                      \</a>
<a name="ln481">      if (X)                                                                  \</a>
<a name="ln482">        {                                                                     \</a>
<a name="ln483">          thread_cancel (X);                                                  \</a>
<a name="ln484">          (X) = NULL;                                                         \</a>
<a name="ln485">        }                                                                     \</a>
<a name="ln486">    } while (0)</a>
<a name="ln487"> </a>
<a name="ln488">/* Extern variables. */</a>
<a name="ln489">extern struct ospf_master *om;</a>
<a name="ln490">extern const struct message ospf_ism_state_msg[];</a>
<a name="ln491">extern const struct message ospf_nsm_state_msg[];</a>
<a name="ln492">extern const struct message ospf_lsa_type_msg[];</a>
<a name="ln493">extern const struct message ospf_link_state_id_type_msg[];</a>
<a name="ln494">extern const struct message ospf_network_type_msg[];</a>
<a name="ln495">extern const int ospf_ism_state_msg_max;</a>
<a name="ln496">extern const int ospf_nsm_state_msg_max;</a>
<a name="ln497">extern const int ospf_lsa_type_msg_max;</a>
<a name="ln498">extern const int ospf_link_state_id_type_msg_max;</a>
<a name="ln499">extern const int ospf_redistributed_proto_max;</a>
<a name="ln500">extern const int ospf_network_type_msg_max;</a>
<a name="ln501">extern struct zclient *zclient;</a>
<a name="ln502">extern struct thread_master *master;</a>
<a name="ln503">extern int ospf_zlog;</a>
<a name="ln504"> </a>
<a name="ln505">/* Prototypes. */</a>
<a name="ln506">extern const char *ospf_redist_string(u_int route_type);</a>
<a name="ln507">extern struct ospf *ospf_lookup (void);</a>
<a name="ln508">extern struct ospf *ospf_get (void);</a>
<a name="ln509">extern void ospf_finish (struct ospf *);</a>
<a name="ln510">extern void ospf_router_id_update (struct ospf *ospf);</a>
<a name="ln511">extern int ospf_network_set (struct ospf *, struct prefix_ipv4 *,</a>
<a name="ln512">			     struct in_addr);</a>
<a name="ln513">extern int ospf_network_unset (struct ospf *, struct prefix_ipv4 *,</a>
<a name="ln514">			       struct in_addr);</a>
<a name="ln515">extern int ospf_area_stub_set (struct ospf *, struct in_addr);</a>
<a name="ln516">extern int ospf_area_stub_unset (struct ospf *, struct in_addr);</a>
<a name="ln517">extern int ospf_area_no_summary_set (struct ospf *, struct in_addr);</a>
<a name="ln518">extern int ospf_area_no_summary_unset (struct ospf *, struct in_addr);</a>
<a name="ln519">extern int ospf_area_nssa_set (struct ospf *, struct in_addr);</a>
<a name="ln520">extern int ospf_area_nssa_unset (struct ospf *, struct in_addr);</a>
<a name="ln521">extern int ospf_area_nssa_translator_role_set (struct ospf *, struct in_addr,</a>
<a name="ln522">					       int);</a>
<a name="ln523">extern int ospf_area_export_list_set (struct ospf *, struct ospf_area *,</a>
<a name="ln524">				      const char *);</a>
<a name="ln525">extern int ospf_area_export_list_unset (struct ospf *, struct ospf_area *);</a>
<a name="ln526">extern int ospf_area_import_list_set (struct ospf *, struct ospf_area *,</a>
<a name="ln527">				      const char *);</a>
<a name="ln528">extern int ospf_area_import_list_unset (struct ospf *, struct ospf_area *);</a>
<a name="ln529">extern int ospf_area_shortcut_set (struct ospf *, struct ospf_area *, int);</a>
<a name="ln530">extern int ospf_area_shortcut_unset (struct ospf *, struct ospf_area *);</a>
<a name="ln531">extern int ospf_timers_refresh_set (struct ospf *, int);</a>
<a name="ln532">extern int ospf_timers_refresh_unset (struct ospf *);</a>
<a name="ln533">extern int ospf_nbr_nbma_set (struct ospf *, struct in_addr);</a>
<a name="ln534">extern int ospf_nbr_nbma_unset (struct ospf *, struct in_addr);</a>
<a name="ln535">extern int ospf_nbr_nbma_priority_set (struct ospf *, struct in_addr, u_char);</a>
<a name="ln536">extern int ospf_nbr_nbma_priority_unset (struct ospf *, struct in_addr);</a>
<a name="ln537">extern int ospf_nbr_nbma_poll_interval_set (struct ospf *, struct in_addr,</a>
<a name="ln538">					    unsigned int);</a>
<a name="ln539">extern int ospf_nbr_nbma_poll_interval_unset (struct ospf *, struct in_addr);</a>
<a name="ln540">extern void ospf_prefix_list_update (struct prefix_list *);</a>
<a name="ln541">extern void ospf_init (void);</a>
<a name="ln542">extern void ospf_if_update (struct ospf *, struct interface *);</a>
<a name="ln543">extern void ospf_ls_upd_queue_empty (struct ospf_interface *);</a>
<a name="ln544">extern void ospf_terminate (void);</a>
<a name="ln545">extern void ospf_nbr_nbma_if_update (struct ospf *, struct ospf_interface *);</a>
<a name="ln546">extern struct ospf_nbr_nbma *ospf_nbr_nbma_lookup (struct ospf *,</a>
<a name="ln547">						   struct in_addr);</a>
<a name="ln548">extern struct ospf_nbr_nbma *ospf_nbr_nbma_lookup_next (struct ospf *,</a>
<a name="ln549">							struct in_addr *,</a>
<a name="ln550">							int);</a>
<a name="ln551">extern int ospf_oi_count (struct interface *);</a>
<a name="ln552"> </a>
<a name="ln553">extern struct ospf_area *ospf_area_get (struct ospf *, struct in_addr, int);</a>
<a name="ln554">extern void ospf_area_check_free (struct ospf *, struct in_addr);</a>
<a name="ln555">extern struct ospf_area *ospf_area_lookup_by_area_id (struct ospf *,</a>
<a name="ln556">						      struct in_addr);</a>
<a name="ln557">extern void ospf_area_add_if (struct ospf_area *, struct ospf_interface *);</a>
<a name="ln558">extern void ospf_area_del_if (struct ospf_area *, struct ospf_interface *);</a>
<a name="ln559"> </a>
<a name="ln560">extern void ospf_interface_area_set (struct interface *);</a>
<a name="ln561">extern void ospf_interface_area_unset (struct interface *);</a>
<a name="ln562"> </a>
<a name="ln563">extern void ospf_route_map_init (void);</a>
<a name="ln564">extern void ospf_snmp_init (void);</a>
<a name="ln565"> </a>
<a name="ln566">extern void ospf_master_init (void);</a>
<a name="ln567"> </a>
<a name="ln568">#endif /* _ZEBRA_OSPFD_H */</a>

</code></pre>
<div class="balloon" rel="489"><p><span style="font-size:18px">&uarr;</span> <a href="https://pvs-studio.com/en/docs/warnings/v707/" target="_blank">V707</a> Giving short names to global variables is considered to be bad practice. It is suggested to rename 'om' variable.</p></div>

<link rel="stylesheet" href="highlight.css">
<script src="highlight.pack.js"></script>
<script src="highlightjs-line-numbers.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
<script>hljs.initLineNumbersOnLoad();</script>
<script>
  $(document).ready(function() {
      $('.balloon').each(function () {
          var bl = $(this);
          var line = bl.attr('rel');
          var text = $('a[name="ln'+line+'"]').text();

          var space_count = 0;
          for(var i = 0; i<text.length; i++){
              var char = text[i];
              if((char !== ' ')&&(char !== '\t'))break;
              if(char === '\t')space_count++;
              space_count++;
          }

          bl.css('margin-left', space_count*8);
          $('a[name="ln'+line+'"]').after(bl);
      });

      window.location = window.location;
  });
</script>
</body>
</html>
