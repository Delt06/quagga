
<html>
<head>

  <meta http-equiv="Content-Type" content="text/html; charset=US-ASCII" />
  <title>bgp_debug.c</title>

  <link rel="stylesheet" href="../style.css"/>
  <script src="../jquery-3.5.1.min.js"></script>
</head>
<body>

<pre><code class = "cpp">
<a name="ln1">/* BGP-4, BGP-4+ packet debug routine</a>
<a name="ln2">   Copyright (C) 1996, 97, 99 Kunihiro Ishiguro</a>
<a name="ln3"> </a>
<a name="ln4">This file is part of GNU Zebra.</a>
<a name="ln5"> </a>
<a name="ln6">GNU Zebra is free software; you can redistribute it and/or modify it</a>
<a name="ln7">under the terms of the GNU General Public License as published by the</a>
<a name="ln8">Free Software Foundation; either version 2, or (at your option) any</a>
<a name="ln9">later version.</a>
<a name="ln10"> </a>
<a name="ln11">GNU Zebra is distributed in the hope that it will be useful, but</a>
<a name="ln12">WITHOUT ANY WARRANTY; without even the implied warranty of</a>
<a name="ln13">MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</a>
<a name="ln14">General Public License for more details.</a>
<a name="ln15"> </a>
<a name="ln16">You should have received a copy of the GNU General Public License</a>
<a name="ln17">along with GNU Zebra; see the file COPYING.  If not, write to the Free</a>
<a name="ln18">Software Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA</a>
<a name="ln19">02111-1307, USA.  */</a>
<a name="ln20"> </a>
<a name="ln21">#include &lt;zebra.h&gt;</a>
<a name="ln22"> </a>
<a name="ln23">#include &lt;lib/version.h&gt;</a>
<a name="ln24">#include &quot;prefix.h&quot;</a>
<a name="ln25">#include &quot;linklist.h&quot;</a>
<a name="ln26">#include &quot;stream.h&quot;</a>
<a name="ln27">#include &quot;command.h&quot;</a>
<a name="ln28">#include &quot;str.h&quot;</a>
<a name="ln29">#include &quot;log.h&quot;</a>
<a name="ln30">#include &quot;sockunion.h&quot;</a>
<a name="ln31">#include &quot;filter.h&quot;</a>
<a name="ln32">#include &quot;memory.h&quot;</a>
<a name="ln33"> </a>
<a name="ln34">#include &quot;bgpd/bgpd.h&quot;</a>
<a name="ln35">#include &quot;bgpd/bgp_aspath.h&quot;</a>
<a name="ln36">#include &quot;bgpd/bgp_route.h&quot;</a>
<a name="ln37">#include &quot;bgpd/bgp_attr.h&quot;</a>
<a name="ln38">#include &quot;bgpd/bgp_debug.h&quot;</a>
<a name="ln39">#include &quot;bgpd/bgp_community.h&quot;</a>
<a name="ln40"> </a>
<a name="ln41">unsigned long conf_bgp_debug_as4;</a>
<a name="ln42">unsigned long conf_bgp_debug_fsm;</a>
<a name="ln43">unsigned long conf_bgp_debug_events;</a>
<a name="ln44">unsigned long conf_bgp_debug_packet;</a>
<a name="ln45">unsigned long conf_bgp_debug_filter;</a>
<a name="ln46">unsigned long conf_bgp_debug_keepalive;</a>
<a name="ln47">unsigned long conf_bgp_debug_update;</a>
<a name="ln48">unsigned long conf_bgp_debug_normal;</a>
<a name="ln49">unsigned long conf_bgp_debug_zebra;</a>
<a name="ln50">unsigned long conf_bgp_debug_allow_martians;</a>
<a name="ln51">unsigned long conf_bgp_debug_nht;</a>
<a name="ln52"> </a>
<a name="ln53">unsigned long term_bgp_debug_as4;</a>
<a name="ln54">unsigned long term_bgp_debug_fsm;</a>
<a name="ln55">unsigned long term_bgp_debug_events;</a>
<a name="ln56">unsigned long term_bgp_debug_packet;</a>
<a name="ln57">unsigned long term_bgp_debug_filter;</a>
<a name="ln58">unsigned long term_bgp_debug_keepalive;</a>
<a name="ln59">unsigned long term_bgp_debug_update;</a>
<a name="ln60">unsigned long term_bgp_debug_normal;</a>
<a name="ln61">unsigned long term_bgp_debug_zebra;</a>
<a name="ln62">unsigned long term_bgp_debug_allow_martians;</a>
<a name="ln63">unsigned long term_bgp_debug_nht;</a>
<a name="ln64"> </a>
<a name="ln65">/* messages for BGP-4 status */</a>
<a name="ln66">const struct message bgp_status_msg[] = </a>
<a name="ln67">{</a>
<a name="ln68">  { Idle, &quot;Idle&quot; },</a>
<a name="ln69">  { Connect, &quot;Connect&quot; },</a>
<a name="ln70">  { Active, &quot;Active&quot; },</a>
<a name="ln71">  { OpenSent, &quot;OpenSent&quot; },</a>
<a name="ln72">  { OpenConfirm, &quot;OpenConfirm&quot; },</a>
<a name="ln73">  { Established, &quot;Established&quot; },</a>
<a name="ln74">  { Clearing,    &quot;Clearing&quot;    },</a>
<a name="ln75">  { Deleted,     &quot;Deleted&quot;     },</a>
<a name="ln76">};</a>
<a name="ln77">#define BGP_DEBUG_MSG_MAX(msg) const int msg ## _max = array_size (msg)</a>
<a name="ln78">BGP_DEBUG_MSG_MAX (bgp_status_msg);</a>
<a name="ln79"> </a>
<a name="ln80">/* BGP message type string. */</a>
<a name="ln81">const char *bgp_type_str[] =</a>
<a name="ln82">{</a>
<a name="ln83">  NULL,</a>
<a name="ln84">  &quot;OPEN&quot;,</a>
<a name="ln85">  &quot;UPDATE&quot;,</a>
<a name="ln86">  &quot;NOTIFICATION&quot;,</a>
<a name="ln87">  &quot;KEEPALIVE&quot;,</a>
<a name="ln88">  &quot;ROUTE-REFRESH&quot;,</a>
<a name="ln89">  &quot;CAPABILITY&quot;,</a>
<a name="ln90">  NULL,</a>
<a name="ln91">};</a>
<a name="ln92"> </a>
<a name="ln93">/* message for BGP-4 Notify */</a>
<a name="ln94">static const struct message bgp_notify_msg[] = </a>
<a name="ln95">{</a>
<a name="ln96">  { BGP_NOTIFY_HEADER_ERR, &quot;Message Header Error&quot;},</a>
<a name="ln97">  { BGP_NOTIFY_OPEN_ERR, &quot;OPEN Message Error&quot;},</a>
<a name="ln98">  { BGP_NOTIFY_UPDATE_ERR, &quot;UPDATE Message Error&quot;},</a>
<a name="ln99">  { BGP_NOTIFY_HOLD_ERR, &quot;Hold Timer Expired&quot;},</a>
<a name="ln100">  { BGP_NOTIFY_FSM_ERR, &quot;Finite State Machine Error&quot;},</a>
<a name="ln101">  { BGP_NOTIFY_CEASE, &quot;Cease&quot;},</a>
<a name="ln102">  { BGP_NOTIFY_CAPABILITY_ERR, &quot;CAPABILITY Message Error&quot;},</a>
<a name="ln103">};</a>
<a name="ln104">BGP_DEBUG_MSG_MAX (bgp_notify_msg);</a>
<a name="ln105"> </a>
<a name="ln106">static const struct message bgp_notify_head_msg[] = </a>
<a name="ln107">{</a>
<a name="ln108">  { BGP_NOTIFY_HEADER_NOT_SYNC, &quot;/Connection Not Synchronized&quot;},</a>
<a name="ln109">  { BGP_NOTIFY_HEADER_BAD_MESLEN, &quot;/Bad Message Length&quot;},</a>
<a name="ln110">  { BGP_NOTIFY_HEADER_BAD_MESTYPE, &quot;/Bad Message Type&quot;},</a>
<a name="ln111">};</a>
<a name="ln112">BGP_DEBUG_MSG_MAX (bgp_notify_head_msg);</a>
<a name="ln113"> </a>
<a name="ln114">static const struct message bgp_notify_open_msg[] = </a>
<a name="ln115">{</a>
<a name="ln116">  { BGP_NOTIFY_SUBCODE_UNSPECIFIC, &quot;/Unspecific&quot;},</a>
<a name="ln117">  { BGP_NOTIFY_OPEN_UNSUP_VERSION, &quot;/Unsupported Version Number&quot; },</a>
<a name="ln118">  { BGP_NOTIFY_OPEN_BAD_PEER_AS, &quot;/Bad Peer AS&quot;},</a>
<a name="ln119">  { BGP_NOTIFY_OPEN_BAD_BGP_IDENT, &quot;/Bad BGP Identifier&quot;},</a>
<a name="ln120">  { BGP_NOTIFY_OPEN_UNSUP_PARAM, &quot;/Unsupported Optional Parameter&quot;},</a>
<a name="ln121">  { BGP_NOTIFY_OPEN_AUTH_FAILURE, &quot;/Authentication Failure&quot;},</a>
<a name="ln122">  { BGP_NOTIFY_OPEN_UNACEP_HOLDTIME, &quot;/Unacceptable Hold Time&quot;}, </a>
<a name="ln123">  { BGP_NOTIFY_OPEN_UNSUP_CAPBL, &quot;/Unsupported Capability&quot;},</a>
<a name="ln124">};</a>
<a name="ln125">BGP_DEBUG_MSG_MAX (bgp_notify_open_msg);</a>
<a name="ln126"> </a>
<a name="ln127">static const struct message bgp_notify_update_msg[] = </a>
<a name="ln128">{</a>
<a name="ln129">  { BGP_NOTIFY_SUBCODE_UNSPECIFIC, &quot;/Unspecific&quot;},</a>
<a name="ln130">  { BGP_NOTIFY_UPDATE_MAL_ATTR, &quot;/Malformed Attribute List&quot;},</a>
<a name="ln131">  { BGP_NOTIFY_UPDATE_UNREC_ATTR, &quot;/Unrecognized Well-known Attribute&quot;},</a>
<a name="ln132">  { BGP_NOTIFY_UPDATE_MISS_ATTR, &quot;/Missing Well-known Attribute&quot;},</a>
<a name="ln133">  { BGP_NOTIFY_UPDATE_ATTR_FLAG_ERR, &quot;/Attribute Flags Error&quot;},</a>
<a name="ln134">  { BGP_NOTIFY_UPDATE_ATTR_LENG_ERR, &quot;/Attribute Length Error&quot;},</a>
<a name="ln135">  { BGP_NOTIFY_UPDATE_INVAL_ORIGIN, &quot;/Invalid ORIGIN Attribute&quot;},</a>
<a name="ln136">  { BGP_NOTIFY_UPDATE_AS_ROUTE_LOOP, &quot;/AS Routing Loop&quot;},</a>
<a name="ln137">  { BGP_NOTIFY_UPDATE_INVAL_NEXT_HOP, &quot;/Invalid NEXT_HOP Attribute&quot;},</a>
<a name="ln138">  { BGP_NOTIFY_UPDATE_OPT_ATTR_ERR, &quot;/Optional Attribute Error&quot;},</a>
<a name="ln139">  { BGP_NOTIFY_UPDATE_INVAL_NETWORK, &quot;/Invalid Network Field&quot;},</a>
<a name="ln140">  { BGP_NOTIFY_UPDATE_MAL_AS_PATH, &quot;/Malformed AS_PATH&quot;},</a>
<a name="ln141">};</a>
<a name="ln142">BGP_DEBUG_MSG_MAX (bgp_notify_update_msg);</a>
<a name="ln143"> </a>
<a name="ln144">static const struct message bgp_notify_cease_msg[] =</a>
<a name="ln145">{</a>
<a name="ln146">  { BGP_NOTIFY_SUBCODE_UNSPECIFIC, &quot;/Unspecific&quot;},</a>
<a name="ln147">  { BGP_NOTIFY_CEASE_MAX_PREFIX, &quot;/Maximum Number of Prefixes Reached&quot;},</a>
<a name="ln148">  { BGP_NOTIFY_CEASE_ADMIN_SHUTDOWN, &quot;/Administratively Shutdown&quot;},</a>
<a name="ln149">  { BGP_NOTIFY_CEASE_PEER_UNCONFIG, &quot;/Peer Unconfigured&quot;},</a>
<a name="ln150">  { BGP_NOTIFY_CEASE_ADMIN_RESET, &quot;/Administratively Reset&quot;},</a>
<a name="ln151">  { BGP_NOTIFY_CEASE_CONNECT_REJECT, &quot;/Connection Rejected&quot;},</a>
<a name="ln152">  { BGP_NOTIFY_CEASE_CONFIG_CHANGE, &quot;/Other Configuration Change&quot;},</a>
<a name="ln153">  { BGP_NOTIFY_CEASE_COLLISION_RESOLUTION, &quot;/Connection collision resolution&quot;},</a>
<a name="ln154">  { BGP_NOTIFY_CEASE_OUT_OF_RESOURCE, &quot;/Out of Resource&quot;},</a>
<a name="ln155">};</a>
<a name="ln156">BGP_DEBUG_MSG_MAX (bgp_notify_cease_msg);</a>
<a name="ln157"> </a>
<a name="ln158">static const struct message bgp_notify_capability_msg[] = </a>
<a name="ln159">{</a>
<a name="ln160">  { BGP_NOTIFY_SUBCODE_UNSPECIFIC, &quot;/Unspecific&quot;},</a>
<a name="ln161">  { BGP_NOTIFY_CAPABILITY_INVALID_ACTION, &quot;/Invalid Action Value&quot; },</a>
<a name="ln162">  { BGP_NOTIFY_CAPABILITY_INVALID_LENGTH, &quot;/Invalid Capability Length&quot;},</a>
<a name="ln163">  { BGP_NOTIFY_CAPABILITY_MALFORMED_CODE, &quot;/Malformed Capability Value&quot;},</a>
<a name="ln164">};</a>
<a name="ln165">BGP_DEBUG_MSG_MAX (bgp_notify_capability_msg);</a>
<a name="ln166"> </a>
<a name="ln167">/* Origin strings. */</a>
<a name="ln168">const char *bgp_origin_str[] = {&quot;i&quot;,&quot;e&quot;,&quot;?&quot;};</a>
<a name="ln169">const char *bgp_origin_long_str[] = {&quot;IGP&quot;,&quot;EGP&quot;,&quot;incomplete&quot;};</a>
<a name="ln170"> </a>
<a name="ln171">/* Dump attribute. */</a>
<a name="ln172">int</a>
<a name="ln173">bgp_dump_attr (struct peer *peer, struct attr *attr, char *buf, size_t size)</a>
<a name="ln174">{</a>
<a name="ln175">  if (! attr)</a>
<a name="ln176">    return 0;</a>
<a name="ln177"> </a>
<a name="ln178">  if (CHECK_FLAG (attr-&gt;flag, ATTR_FLAG_BIT (BGP_ATTR_NEXT_HOP)))</a>
<a name="ln179">    snprintf (buf, size, &quot;nexthop %s&quot;, inet_ntoa (attr-&gt;nexthop));</a>
<a name="ln180"> </a>
<a name="ln181">  if (CHECK_FLAG (attr-&gt;flag, ATTR_FLAG_BIT (BGP_ATTR_ORIGIN)))</a>
<a name="ln182">    snprintf (buf + strlen (buf), size - strlen (buf), &quot;, origin %s&quot;,</a>
<a name="ln183">	      bgp_origin_str[attr-&gt;origin]);</a>
<a name="ln184"> </a>
<a name="ln185">  if (attr-&gt;extra)</a>
<a name="ln186">    {</a>
<a name="ln187">      char addrbuf[BUFSIZ];</a>
<a name="ln188"> </a>
<a name="ln189">      /* Add MP case. */</a>
<a name="ln190">      if (attr-&gt;extra-&gt;mp_nexthop_len == 16 </a>
<a name="ln191">          || attr-&gt;extra-&gt;mp_nexthop_len == 32)</a>
<a name="ln192">        snprintf (buf + strlen (buf), size - strlen (buf), &quot;, mp_nexthop %s&quot;,</a>
<a name="ln193">                  inet_ntop (AF_INET6, &amp;attr-&gt;extra-&gt;mp_nexthop_global, </a>
<a name="ln194">                             addrbuf, BUFSIZ));</a>
<a name="ln195"> </a>
<a name="ln196">      if (attr-&gt;extra-&gt;mp_nexthop_len == 32)</a>
<a name="ln197">        snprintf (buf + strlen (buf), size - strlen (buf), &quot;(%s)&quot;,</a>
<a name="ln198">                  inet_ntop (AF_INET6, &amp;attr-&gt;extra-&gt;mp_nexthop_local, </a>
<a name="ln199">                             addrbuf, BUFSIZ));</a>
<a name="ln200">    }</a>
<a name="ln201"> </a>
<a name="ln202">  if (CHECK_FLAG (attr-&gt;flag, ATTR_FLAG_BIT (BGP_ATTR_LOCAL_PREF)))</a>
<a name="ln203">    snprintf (buf + strlen (buf), size - strlen (buf), &quot;, localpref %u&quot;,</a>
<a name="ln204">	      attr-&gt;local_pref);</a>
<a name="ln205"> </a>
<a name="ln206">  if (CHECK_FLAG (attr-&gt;flag, ATTR_FLAG_BIT (BGP_ATTR_MULTI_EXIT_DISC))) </a>
<a name="ln207">    snprintf (buf + strlen (buf), size - strlen (buf), &quot;, metric %u&quot;,</a>
<a name="ln208">	      attr-&gt;med);</a>
<a name="ln209"> </a>
<a name="ln210">  if (CHECK_FLAG (attr-&gt;flag, ATTR_FLAG_BIT (BGP_ATTR_COMMUNITIES))) </a>
<a name="ln211">    snprintf (buf + strlen (buf), size - strlen (buf), &quot;, community %s&quot;,</a>
<a name="ln212">	      community_str (attr-&gt;community));</a>
<a name="ln213"> </a>
<a name="ln214">  if (CHECK_FLAG (attr-&gt;flag, ATTR_FLAG_BIT (BGP_ATTR_ATOMIC_AGGREGATE)))</a>
<a name="ln215">    snprintf (buf + strlen (buf), size - strlen (buf), &quot;, atomic-aggregate&quot;);</a>
<a name="ln216"> </a>
<a name="ln217">  if (CHECK_FLAG (attr-&gt;flag, ATTR_FLAG_BIT (BGP_ATTR_AGGREGATOR)))</a>
<a name="ln218">    snprintf (buf + strlen (buf), size - strlen (buf), &quot;, aggregated by %u %s&quot;,</a>
<a name="ln219">	      attr-&gt;extra-&gt;aggregator_as,</a>
<a name="ln220">	      inet_ntoa (attr-&gt;extra-&gt;aggregator_addr));</a>
<a name="ln221"> </a>
<a name="ln222">  if (CHECK_FLAG (attr-&gt;flag, ATTR_FLAG_BIT (BGP_ATTR_ORIGINATOR_ID)))</a>
<a name="ln223">    snprintf (buf + strlen (buf), size - strlen (buf), &quot;, originator %s&quot;,</a>
<a name="ln224">	      inet_ntoa (attr-&gt;extra-&gt;originator_id));</a>
<a name="ln225"> </a>
<a name="ln226">  if (CHECK_FLAG (attr-&gt;flag, ATTR_FLAG_BIT (BGP_ATTR_CLUSTER_LIST)))</a>
<a name="ln227">    {</a>
<a name="ln228">      int i;</a>
<a name="ln229"> </a>
<a name="ln230">      snprintf (buf + strlen (buf), size - strlen (buf), &quot;, clusterlist&quot;);</a>
<a name="ln231">      for (i = 0; i &lt; attr-&gt;extra-&gt;cluster-&gt;length / 4; i++)</a>
<a name="ln232">	snprintf (buf + strlen (buf), size - strlen (buf), &quot; %s&quot;,</a>
<a name="ln233">		  inet_ntoa (attr-&gt;extra-&gt;cluster-&gt;list[i]));</a>
<a name="ln234">    }</a>
<a name="ln235"> </a>
<a name="ln236">  if (CHECK_FLAG (attr-&gt;flag, ATTR_FLAG_BIT (BGP_ATTR_AS_PATH))) </a>
<a name="ln237">    snprintf (buf + strlen (buf), size - strlen (buf), &quot;, path %s&quot;,</a>
<a name="ln238">	      aspath_print (attr-&gt;aspath));</a>
<a name="ln239"> </a>
<a name="ln240">  if (strlen (buf) &gt; 1)</a>
<a name="ln241">    return 1;</a>
<a name="ln242">  else</a>
<a name="ln243">    return 0;</a>
<a name="ln244">}</a>
<a name="ln245"> </a>
<a name="ln246">/* dump notify packet */</a>
<a name="ln247">void</a>
<a name="ln248">bgp_notify_print(struct peer *peer, struct bgp_notify *bgp_notify, </a>
<a name="ln249">                 const char *direct)</a>
<a name="ln250">{</a>
<a name="ln251">  const char *subcode_str;</a>
<a name="ln252">  const char *code_str;</a>
<a name="ln253"> </a>
<a name="ln254">  subcode_str = &quot;&quot;;</a>
<a name="ln255">  code_str = LOOKUP_DEF (bgp_notify_msg, bgp_notify-&gt;code,</a>
<a name="ln256">                         &quot;Unrecognized Error Code&quot;);</a>
<a name="ln257"> </a>
<a name="ln258">  switch (bgp_notify-&gt;code)</a>
<a name="ln259">    {</a>
<a name="ln260">    case BGP_NOTIFY_HEADER_ERR:</a>
<a name="ln261">      subcode_str = LOOKUP_DEF (bgp_notify_head_msg, bgp_notify-&gt;subcode,</a>
<a name="ln262">                                &quot;Unrecognized Error Subcode&quot;);</a>
<a name="ln263">      break;</a>
<a name="ln264">    case BGP_NOTIFY_OPEN_ERR:</a>
<a name="ln265">      subcode_str = LOOKUP_DEF (bgp_notify_open_msg, bgp_notify-&gt;subcode,</a>
<a name="ln266">                                &quot;Unrecognized Error Subcode&quot;);</a>
<a name="ln267">      break;</a>
<a name="ln268">    case BGP_NOTIFY_UPDATE_ERR:</a>
<a name="ln269">      subcode_str = LOOKUP_DEF (bgp_notify_update_msg, bgp_notify-&gt;subcode,</a>
<a name="ln270">                                &quot;Unrecognized Error Subcode&quot;);</a>
<a name="ln271">      break;</a>
<a name="ln272">    case BGP_NOTIFY_HOLD_ERR:</a>
<a name="ln273">      break;</a>
<a name="ln274">    case BGP_NOTIFY_FSM_ERR:</a>
<a name="ln275">      break;</a>
<a name="ln276">    case BGP_NOTIFY_CEASE:</a>
<a name="ln277">      subcode_str = LOOKUP_DEF (bgp_notify_cease_msg, bgp_notify-&gt;subcode,</a>
<a name="ln278">                                &quot;Unrecognized Error Subcode&quot;);</a>
<a name="ln279">      break;</a>
<a name="ln280">    case BGP_NOTIFY_CAPABILITY_ERR:</a>
<a name="ln281">      subcode_str = LOOKUP_DEF (bgp_notify_capability_msg, bgp_notify-&gt;subcode,</a>
<a name="ln282">                                &quot;Unrecognized Error Subcode&quot;);</a>
<a name="ln283">      break;</a>
<a name="ln284">    }</a>
<a name="ln285"> </a>
<a name="ln286">  if (bgp_flag_check (peer-&gt;bgp, BGP_FLAG_LOG_NEIGHBOR_CHANGES))</a>
<a name="ln287">    zlog_info (&quot;%%NOTIFICATION: %s neighbor %s %d/%d (%s%s) %d bytes %s&quot;,</a>
<a name="ln288">              strcmp (direct, &quot;received&quot;) == 0 ? &quot;received from&quot; : &quot;sent to&quot;,</a>
<a name="ln289">              peer-&gt;host, bgp_notify-&gt;code, bgp_notify-&gt;subcode,</a>
<a name="ln290">              code_str, subcode_str, bgp_notify-&gt;length,</a>
<a name="ln291">              bgp_notify-&gt;data ? bgp_notify-&gt;data : &quot;&quot;);</a>
<a name="ln292">  else if (BGP_DEBUG (normal, NORMAL))</a>
<a name="ln293">    plog_debug (peer-&gt;log, &quot;%s %s NOTIFICATION %d/%d (%s%s) %d bytes %s&quot;,</a>
<a name="ln294">	       peer ? peer-&gt;host : &quot;&quot;,</a>
<a name="ln295">	       direct, bgp_notify-&gt;code, bgp_notify-&gt;subcode,</a>
<a name="ln296">	       code_str, subcode_str, bgp_notify-&gt;length,</a>
<a name="ln297">	       bgp_notify-&gt;data ? bgp_notify-&gt;data : &quot;&quot;);</a>
<a name="ln298">}</a>
<a name="ln299"> </a>
<a name="ln300">/* Debug option setting interface. */</a>
<a name="ln301">unsigned long bgp_debug_option = 0;</a>
<a name="ln302"> </a>
<a name="ln303">int  </a>
<a name="ln304">debug (unsigned int option)</a>
<a name="ln305">{</a>
<a name="ln306">  return bgp_debug_option &amp; option; </a>
<a name="ln307">}</a>
<a name="ln308"> </a>
<a name="ln309">DEFUN (debug_bgp_as4,</a>
<a name="ln310">       debug_bgp_as4_cmd,</a>
<a name="ln311">       &quot;debug bgp as4&quot;,</a>
<a name="ln312">       DEBUG_STR</a>
<a name="ln313">       BGP_STR</a>
<a name="ln314">       &quot;BGP AS4 actions\n&quot;)</a>
<a name="ln315">{</a>
<a name="ln316">  if (vty-&gt;node == CONFIG_NODE)</a>
<a name="ln317">    DEBUG_ON (as4, AS4);</a>
<a name="ln318">  else</a>
<a name="ln319">    {</a>
<a name="ln320">      TERM_DEBUG_ON (as4, AS4);</a>
<a name="ln321">      vty_out (vty, &quot;BGP as4 debugging is on%s&quot;, VTY_NEWLINE);</a>
<a name="ln322">    }</a>
<a name="ln323">  return CMD_SUCCESS;</a>
<a name="ln324">}</a>
<a name="ln325"> </a>
<a name="ln326">DEFUN (no_debug_bgp_as4,</a>
<a name="ln327">       no_debug_bgp_as4_cmd,</a>
<a name="ln328">       &quot;no debug bgp as4&quot;,</a>
<a name="ln329">       NO_STR</a>
<a name="ln330">       DEBUG_STR</a>
<a name="ln331">       BGP_STR</a>
<a name="ln332">       &quot;BGP AS4 actions\n&quot;)</a>
<a name="ln333">{</a>
<a name="ln334">  if (vty-&gt;node == CONFIG_NODE)</a>
<a name="ln335">    DEBUG_OFF (as4, AS4);</a>
<a name="ln336">  else</a>
<a name="ln337">    {</a>
<a name="ln338">      TERM_DEBUG_OFF (as4, AS4);</a>
<a name="ln339">      vty_out (vty, &quot;BGP as4 debugging is off%s&quot;, VTY_NEWLINE);</a>
<a name="ln340">    }</a>
<a name="ln341">  return CMD_SUCCESS;</a>
<a name="ln342">}</a>
<a name="ln343"> </a>
<a name="ln344">ALIAS (no_debug_bgp_as4,</a>
<a name="ln345">       undebug_bgp_as4_cmd,</a>
<a name="ln346">       &quot;undebug bgp as4&quot;,</a>
<a name="ln347">       UNDEBUG_STR</a>
<a name="ln348">       BGP_STR</a>
<a name="ln349">       &quot;BGP AS4 actions\n&quot;)</a>
<a name="ln350"> </a>
<a name="ln351">DEFUN (debug_bgp_as4_segment,</a>
<a name="ln352">       debug_bgp_as4_segment_cmd,</a>
<a name="ln353">       &quot;debug bgp as4 segment&quot;,</a>
<a name="ln354">       DEBUG_STR</a>
<a name="ln355">       BGP_STR</a>
<a name="ln356">       &quot;BGP AS4 actions\n&quot;</a>
<a name="ln357">       &quot;BGP AS4 aspath segment handling\n&quot;)</a>
<a name="ln358">{</a>
<a name="ln359">  if (vty-&gt;node == CONFIG_NODE)</a>
<a name="ln360">    DEBUG_ON (as4, AS4_SEGMENT);</a>
<a name="ln361">  else</a>
<a name="ln362">    {</a>
<a name="ln363">      TERM_DEBUG_ON (as4, AS4_SEGMENT);</a>
<a name="ln364">      vty_out (vty, &quot;BGP as4 segment debugging is on%s&quot;, VTY_NEWLINE);</a>
<a name="ln365">    }</a>
<a name="ln366">  return CMD_SUCCESS;</a>
<a name="ln367">}</a>
<a name="ln368"> </a>
<a name="ln369">DEFUN (no_debug_bgp_as4_segment,</a>
<a name="ln370">       no_debug_bgp_as4_segment_cmd,</a>
<a name="ln371">       &quot;no debug bgp as4 segment&quot;,</a>
<a name="ln372">       NO_STR</a>
<a name="ln373">       DEBUG_STR</a>
<a name="ln374">       BGP_STR</a>
<a name="ln375">       &quot;BGP AS4 actions\n&quot;</a>
<a name="ln376">       &quot;BGP AS4 aspath segment handling\n&quot;)</a>
<a name="ln377">{</a>
<a name="ln378">  if (vty-&gt;node == CONFIG_NODE)</a>
<a name="ln379">    DEBUG_OFF (as4, AS4_SEGMENT);</a>
<a name="ln380">  else</a>
<a name="ln381">    {</a>
<a name="ln382">      TERM_DEBUG_OFF (as4, AS4_SEGMENT);</a>
<a name="ln383">      vty_out (vty, &quot;BGP as4 segment debugging is off%s&quot;, VTY_NEWLINE);</a>
<a name="ln384">    }</a>
<a name="ln385">  return CMD_SUCCESS;</a>
<a name="ln386">}</a>
<a name="ln387"> </a>
<a name="ln388">ALIAS (no_debug_bgp_as4_segment,</a>
<a name="ln389">       undebug_bgp_as4_segment_cmd,</a>
<a name="ln390">       &quot;undebug bgp as4 segment&quot;,</a>
<a name="ln391">       UNDEBUG_STR</a>
<a name="ln392">       BGP_STR</a>
<a name="ln393">       &quot;BGP AS4 actions\n&quot;</a>
<a name="ln394">       &quot;BGP AS4 aspath segment handling\n&quot;)</a>
<a name="ln395"> </a>
<a name="ln396">DEFUN (debug_bgp_fsm,</a>
<a name="ln397">       debug_bgp_fsm_cmd,</a>
<a name="ln398">       &quot;debug bgp fsm&quot;,</a>
<a name="ln399">       DEBUG_STR</a>
<a name="ln400">       BGP_STR</a>
<a name="ln401">       &quot;BGP Finite State Machine\n&quot;)</a>
<a name="ln402">{</a>
<a name="ln403">  if (vty-&gt;node == CONFIG_NODE)</a>
<a name="ln404">    DEBUG_ON (fsm, FSM);</a>
<a name="ln405">  else</a>
<a name="ln406">    {</a>
<a name="ln407">      TERM_DEBUG_ON (fsm, FSM);</a>
<a name="ln408">      vty_out (vty, &quot;BGP fsm debugging is on%s&quot;, VTY_NEWLINE);</a>
<a name="ln409">    }</a>
<a name="ln410">  return CMD_SUCCESS;</a>
<a name="ln411">}</a>
<a name="ln412"> </a>
<a name="ln413">DEFUN (no_debug_bgp_fsm,</a>
<a name="ln414">       no_debug_bgp_fsm_cmd,</a>
<a name="ln415">       &quot;no debug bgp fsm&quot;,</a>
<a name="ln416">       NO_STR</a>
<a name="ln417">       DEBUG_STR</a>
<a name="ln418">       BGP_STR</a>
<a name="ln419">       &quot;Finite State Machine\n&quot;)</a>
<a name="ln420">{</a>
<a name="ln421">  if (vty-&gt;node == CONFIG_NODE)</a>
<a name="ln422">    DEBUG_OFF (fsm, FSM);</a>
<a name="ln423">  else</a>
<a name="ln424">    {</a>
<a name="ln425">      TERM_DEBUG_OFF (fsm, FSM);</a>
<a name="ln426">      vty_out (vty, &quot;BGP fsm debugging is off%s&quot;, VTY_NEWLINE);</a>
<a name="ln427">    }</a>
<a name="ln428">  return CMD_SUCCESS;</a>
<a name="ln429">}</a>
<a name="ln430"> </a>
<a name="ln431">ALIAS (no_debug_bgp_fsm,</a>
<a name="ln432">       undebug_bgp_fsm_cmd,</a>
<a name="ln433">       &quot;undebug bgp fsm&quot;,</a>
<a name="ln434">       UNDEBUG_STR</a>
<a name="ln435">       BGP_STR</a>
<a name="ln436">       &quot;Finite State Machine\n&quot;)</a>
<a name="ln437"> </a>
<a name="ln438">DEFUN (debug_bgp_events,</a>
<a name="ln439">       debug_bgp_events_cmd,</a>
<a name="ln440">       &quot;debug bgp events&quot;,</a>
<a name="ln441">       DEBUG_STR</a>
<a name="ln442">       BGP_STR</a>
<a name="ln443">       &quot;BGP events\n&quot;)</a>
<a name="ln444">{</a>
<a name="ln445">  if (vty-&gt;node == CONFIG_NODE)</a>
<a name="ln446">    DEBUG_ON (events, EVENTS);</a>
<a name="ln447">  else</a>
<a name="ln448">    {</a>
<a name="ln449">      TERM_DEBUG_ON (events, EVENTS);</a>
<a name="ln450">      vty_out (vty, &quot;BGP events debugging is on%s&quot;, VTY_NEWLINE);</a>
<a name="ln451">    }</a>
<a name="ln452">  return CMD_SUCCESS;</a>
<a name="ln453">}</a>
<a name="ln454"> </a>
<a name="ln455">DEFUN (no_debug_bgp_events,</a>
<a name="ln456">       no_debug_bgp_events_cmd,</a>
<a name="ln457">       &quot;no debug bgp events&quot;,</a>
<a name="ln458">       NO_STR</a>
<a name="ln459">       DEBUG_STR</a>
<a name="ln460">       BGP_STR</a>
<a name="ln461">       &quot;BGP events\n&quot;)</a>
<a name="ln462">{</a>
<a name="ln463">  if (vty-&gt;node == CONFIG_NODE)</a>
<a name="ln464">    DEBUG_OFF (events, EVENTS);</a>
<a name="ln465">  else</a>
<a name="ln466">    {</a>
<a name="ln467">      TERM_DEBUG_OFF (events, EVENTS);</a>
<a name="ln468">      vty_out (vty, &quot;BGP events debugging is off%s&quot;, VTY_NEWLINE);</a>
<a name="ln469">    }</a>
<a name="ln470">  return CMD_SUCCESS;</a>
<a name="ln471">}</a>
<a name="ln472"> </a>
<a name="ln473">ALIAS (no_debug_bgp_events,</a>
<a name="ln474">       undebug_bgp_events_cmd,</a>
<a name="ln475">       &quot;undebug bgp events&quot;,</a>
<a name="ln476">       UNDEBUG_STR</a>
<a name="ln477">       BGP_STR</a>
<a name="ln478">       &quot;BGP events\n&quot;)</a>
<a name="ln479"> </a>
<a name="ln480">DEFUN (debug_bgp_nht,</a>
<a name="ln481">       debug_bgp_nht_cmd,</a>
<a name="ln482">       &quot;debug bgp nht&quot;,</a>
<a name="ln483">       DEBUG_STR</a>
<a name="ln484">       BGP_STR</a>
<a name="ln485">       &quot;BGP nexthop tracking events\n&quot;)</a>
<a name="ln486">{</a>
<a name="ln487">  if (vty-&gt;node == CONFIG_NODE)</a>
<a name="ln488">    DEBUG_ON (nht, NHT);</a>
<a name="ln489">  else</a>
<a name="ln490">    {</a>
<a name="ln491">      TERM_DEBUG_ON (nht, NHT);</a>
<a name="ln492">      vty_out (vty, &quot;BGP nexthop tracking debugging is on%s&quot;, VTY_NEWLINE);</a>
<a name="ln493">    }</a>
<a name="ln494">  return CMD_SUCCESS;</a>
<a name="ln495">}</a>
<a name="ln496"> </a>
<a name="ln497">DEFUN (no_debug_bgp_nht,</a>
<a name="ln498">       no_debug_bgp_nht_cmd,</a>
<a name="ln499">       &quot;no debug bgp nht&quot;,</a>
<a name="ln500">       NO_STR</a>
<a name="ln501">       DEBUG_STR</a>
<a name="ln502">       BGP_STR</a>
<a name="ln503">       &quot;BGP nexthop tracking events\n&quot;)</a>
<a name="ln504">{</a>
<a name="ln505">  if (vty-&gt;node == CONFIG_NODE)</a>
<a name="ln506">    DEBUG_OFF (nht, NHT);</a>
<a name="ln507">  else</a>
<a name="ln508">    {</a>
<a name="ln509">      TERM_DEBUG_OFF (nht, NHT);</a>
<a name="ln510">      vty_out (vty, &quot;BGP nexthop tracking debugging is off%s&quot;, VTY_NEWLINE);</a>
<a name="ln511">    }</a>
<a name="ln512">  return CMD_SUCCESS;</a>
<a name="ln513">}</a>
<a name="ln514"> </a>
<a name="ln515">ALIAS (no_debug_bgp_nht,</a>
<a name="ln516">       undebug_bgp_nht_cmd,</a>
<a name="ln517">       &quot;undebug bgp nht&quot;,</a>
<a name="ln518">       UNDEBUG_STR</a>
<a name="ln519">       BGP_STR</a>
<a name="ln520">       &quot;BGP next-hop tracking updates\n&quot;)</a>
<a name="ln521"> </a>
<a name="ln522">DEFUN (debug_bgp_filter,</a>
<a name="ln523">       debug_bgp_filter_cmd,</a>
<a name="ln524">       &quot;debug bgp filters&quot;,</a>
<a name="ln525">       DEBUG_STR</a>
<a name="ln526">       BGP_STR</a>
<a name="ln527">       &quot;BGP filters\n&quot;)</a>
<a name="ln528">{</a>
<a name="ln529">  if (vty-&gt;node == CONFIG_NODE)</a>
<a name="ln530">    DEBUG_ON (filter, FILTER);</a>
<a name="ln531">  else</a>
<a name="ln532">    {</a>
<a name="ln533">      TERM_DEBUG_ON (filter, FILTER);</a>
<a name="ln534">      vty_out (vty, &quot;BGP filters debugging is on%s&quot;, VTY_NEWLINE);</a>
<a name="ln535">    }</a>
<a name="ln536">  return CMD_SUCCESS;</a>
<a name="ln537">}</a>
<a name="ln538"> </a>
<a name="ln539">DEFUN (no_debug_bgp_filter,</a>
<a name="ln540">       no_debug_bgp_filter_cmd,</a>
<a name="ln541">       &quot;no debug bgp filters&quot;,</a>
<a name="ln542">       NO_STR</a>
<a name="ln543">       DEBUG_STR</a>
<a name="ln544">       BGP_STR</a>
<a name="ln545">       &quot;BGP filters\n&quot;)</a>
<a name="ln546">{</a>
<a name="ln547">  if (vty-&gt;node == CONFIG_NODE)</a>
<a name="ln548">    DEBUG_OFF (filter, FILTER);</a>
<a name="ln549">  else</a>
<a name="ln550">    {</a>
<a name="ln551">      TERM_DEBUG_OFF (filter, FILTER);</a>
<a name="ln552">      vty_out (vty, &quot;BGP filters debugging is off%s&quot;, VTY_NEWLINE);</a>
<a name="ln553">    }</a>
<a name="ln554">  return CMD_SUCCESS;</a>
<a name="ln555">}</a>
<a name="ln556"> </a>
<a name="ln557">ALIAS (no_debug_bgp_filter,</a>
<a name="ln558">       undebug_bgp_filter_cmd,</a>
<a name="ln559">       &quot;undebug bgp filters&quot;,</a>
<a name="ln560">       UNDEBUG_STR</a>
<a name="ln561">       BGP_STR</a>
<a name="ln562">       &quot;BGP filters\n&quot;)</a>
<a name="ln563"> </a>
<a name="ln564">DEFUN (debug_bgp_keepalive,</a>
<a name="ln565">       debug_bgp_keepalive_cmd,</a>
<a name="ln566">       &quot;debug bgp keepalives&quot;,</a>
<a name="ln567">       DEBUG_STR</a>
<a name="ln568">       BGP_STR</a>
<a name="ln569">       &quot;BGP keepalives\n&quot;)</a>
<a name="ln570">{</a>
<a name="ln571">  if (vty-&gt;node == CONFIG_NODE)</a>
<a name="ln572">    DEBUG_ON (keepalive, KEEPALIVE);</a>
<a name="ln573">  else</a>
<a name="ln574">    {</a>
<a name="ln575">      TERM_DEBUG_ON (keepalive, KEEPALIVE);</a>
<a name="ln576">      vty_out (vty, &quot;BGP keepalives debugging is on%s&quot;, VTY_NEWLINE);</a>
<a name="ln577">    }</a>
<a name="ln578">  return CMD_SUCCESS;</a>
<a name="ln579">}</a>
<a name="ln580"> </a>
<a name="ln581">DEFUN (no_debug_bgp_keepalive,</a>
<a name="ln582">       no_debug_bgp_keepalive_cmd,</a>
<a name="ln583">       &quot;no debug bgp keepalives&quot;,</a>
<a name="ln584">       NO_STR</a>
<a name="ln585">       DEBUG_STR</a>
<a name="ln586">       BGP_STR</a>
<a name="ln587">       &quot;BGP keepalives\n&quot;)</a>
<a name="ln588">{</a>
<a name="ln589">  if (vty-&gt;node == CONFIG_NODE)</a>
<a name="ln590">    DEBUG_OFF (keepalive, KEEPALIVE);</a>
<a name="ln591">  else</a>
<a name="ln592">    {</a>
<a name="ln593">      TERM_DEBUG_OFF (keepalive, KEEPALIVE);</a>
<a name="ln594">      vty_out (vty, &quot;BGP keepalives debugging is off%s&quot;, VTY_NEWLINE);</a>
<a name="ln595">    }</a>
<a name="ln596">  return CMD_SUCCESS;</a>
<a name="ln597">}</a>
<a name="ln598"> </a>
<a name="ln599">ALIAS (no_debug_bgp_keepalive,</a>
<a name="ln600">       undebug_bgp_keepalive_cmd,</a>
<a name="ln601">       &quot;undebug bgp keepalives&quot;,</a>
<a name="ln602">       UNDEBUG_STR</a>
<a name="ln603">       BGP_STR</a>
<a name="ln604">       &quot;BGP keepalives\n&quot;)</a>
<a name="ln605"> </a>
<a name="ln606">DEFUN (debug_bgp_update,</a>
<a name="ln607">       debug_bgp_update_cmd,</a>
<a name="ln608">       &quot;debug bgp updates&quot;,</a>
<a name="ln609">       DEBUG_STR</a>
<a name="ln610">       BGP_STR</a>
<a name="ln611">       &quot;BGP updates\n&quot;)</a>
<a name="ln612">{</a>
<a name="ln613">  if (vty-&gt;node == CONFIG_NODE)</a>
<a name="ln614">    {</a>
<a name="ln615">      DEBUG_ON (update, UPDATE_IN);</a>
<a name="ln616">      DEBUG_ON (update, UPDATE_OUT);</a>
<a name="ln617">    }</a>
<a name="ln618">  else</a>
<a name="ln619">    {</a>
<a name="ln620">      TERM_DEBUG_ON (update, UPDATE_IN);</a>
<a name="ln621">      TERM_DEBUG_ON (update, UPDATE_OUT);</a>
<a name="ln622">      vty_out (vty, &quot;BGP updates debugging is on%s&quot;, VTY_NEWLINE);</a>
<a name="ln623">    }</a>
<a name="ln624">  return CMD_SUCCESS;</a>
<a name="ln625">}</a>
<a name="ln626"> </a>
<a name="ln627">DEFUN (debug_bgp_update_direct,</a>
<a name="ln628">       debug_bgp_update_direct_cmd,</a>
<a name="ln629">       &quot;debug bgp updates (in|out)&quot;,</a>
<a name="ln630">       DEBUG_STR</a>
<a name="ln631">       BGP_STR</a>
<a name="ln632">       &quot;BGP updates\n&quot;</a>
<a name="ln633">       &quot;Inbound updates\n&quot;</a>
<a name="ln634">       &quot;Outbound updates\n&quot;)</a>
<a name="ln635">{</a>
<a name="ln636">  if (vty-&gt;node == CONFIG_NODE)</a>
<a name="ln637">    {</a>
<a name="ln638">      if (strncmp (&quot;i&quot;, argv[0], 1) == 0)</a>
<a name="ln639">	{</a>
<a name="ln640">	  DEBUG_OFF (update, UPDATE_OUT);</a>
<a name="ln641">	  DEBUG_ON (update, UPDATE_IN);</a>
<a name="ln642">	}</a>
<a name="ln643">      else</a>
<a name="ln644">	{	</a>
<a name="ln645">	  DEBUG_OFF (update, UPDATE_IN);</a>
<a name="ln646">	  DEBUG_ON (update, UPDATE_OUT);</a>
<a name="ln647">	}</a>
<a name="ln648">    }</a>
<a name="ln649">  else</a>
<a name="ln650">    {</a>
<a name="ln651">      if (strncmp (&quot;i&quot;, argv[0], 1) == 0)</a>
<a name="ln652">	{</a>
<a name="ln653">	  TERM_DEBUG_OFF (update, UPDATE_OUT);</a>
<a name="ln654">	  TERM_DEBUG_ON (update, UPDATE_IN);</a>
<a name="ln655">	  vty_out (vty, &quot;BGP updates debugging is on (inbound)%s&quot;, VTY_NEWLINE);</a>
<a name="ln656">	}</a>
<a name="ln657">      else</a>
<a name="ln658">	{</a>
<a name="ln659">	  TERM_DEBUG_OFF (update, UPDATE_IN);</a>
<a name="ln660">	  TERM_DEBUG_ON (update, UPDATE_OUT);</a>
<a name="ln661">	  vty_out (vty, &quot;BGP updates debugging is on (outbound)%s&quot;, VTY_NEWLINE);</a>
<a name="ln662">	}</a>
<a name="ln663">    }</a>
<a name="ln664">  return CMD_SUCCESS;</a>
<a name="ln665">}</a>
<a name="ln666"> </a>
<a name="ln667">DEFUN (no_debug_bgp_update,</a>
<a name="ln668">       no_debug_bgp_update_cmd,</a>
<a name="ln669">       &quot;no debug bgp updates&quot;,</a>
<a name="ln670">       NO_STR</a>
<a name="ln671">       DEBUG_STR</a>
<a name="ln672">       BGP_STR</a>
<a name="ln673">       &quot;BGP updates\n&quot;)</a>
<a name="ln674">{</a>
<a name="ln675">  if (vty-&gt;node == CONFIG_NODE)</a>
<a name="ln676">    {</a>
<a name="ln677">      DEBUG_OFF (update, UPDATE_IN);</a>
<a name="ln678">      DEBUG_OFF (update, UPDATE_OUT);</a>
<a name="ln679">    }</a>
<a name="ln680">  else</a>
<a name="ln681">    {</a>
<a name="ln682">      TERM_DEBUG_OFF (update, UPDATE_IN);</a>
<a name="ln683">      TERM_DEBUG_OFF (update, UPDATE_OUT);</a>
<a name="ln684">      vty_out (vty, &quot;BGP updates debugging is off%s&quot;, VTY_NEWLINE);</a>
<a name="ln685">    }</a>
<a name="ln686">  return CMD_SUCCESS;</a>
<a name="ln687">}</a>
<a name="ln688"> </a>
<a name="ln689">ALIAS (no_debug_bgp_update,</a>
<a name="ln690">       undebug_bgp_update_cmd,</a>
<a name="ln691">       &quot;undebug bgp updates&quot;,</a>
<a name="ln692">       UNDEBUG_STR</a>
<a name="ln693">       BGP_STR</a>
<a name="ln694">       &quot;BGP updates\n&quot;)</a>
<a name="ln695"> </a>
<a name="ln696">DEFUN (debug_bgp_normal,</a>
<a name="ln697">       debug_bgp_normal_cmd,</a>
<a name="ln698">       &quot;debug bgp&quot;,</a>
<a name="ln699">       DEBUG_STR</a>
<a name="ln700">       BGP_STR)</a>
<a name="ln701">{</a>
<a name="ln702">  if (vty-&gt;node == CONFIG_NODE)</a>
<a name="ln703">    DEBUG_ON (normal, NORMAL);</a>
<a name="ln704">  else</a>
<a name="ln705">    {</a>
<a name="ln706">      TERM_DEBUG_ON (normal, NORMAL);</a>
<a name="ln707">      vty_out (vty, &quot;BGP debugging is on%s&quot;, VTY_NEWLINE);</a>
<a name="ln708">    }</a>
<a name="ln709">  return CMD_SUCCESS;</a>
<a name="ln710">}</a>
<a name="ln711"> </a>
<a name="ln712">DEFUN (no_debug_bgp_normal,</a>
<a name="ln713">       no_debug_bgp_normal_cmd,</a>
<a name="ln714">       &quot;no debug bgp&quot;,</a>
<a name="ln715">       NO_STR</a>
<a name="ln716">       DEBUG_STR</a>
<a name="ln717">       BGP_STR)</a>
<a name="ln718">{</a>
<a name="ln719">  if (vty-&gt;node == CONFIG_NODE)</a>
<a name="ln720">    DEBUG_OFF (normal, NORMAL);</a>
<a name="ln721">  else</a>
<a name="ln722">    {</a>
<a name="ln723">      TERM_DEBUG_OFF (normal, NORMAL);</a>
<a name="ln724">      vty_out (vty, &quot;BGP debugging is off%s&quot;, VTY_NEWLINE);</a>
<a name="ln725">    }</a>
<a name="ln726">  return CMD_SUCCESS;</a>
<a name="ln727">}</a>
<a name="ln728"> </a>
<a name="ln729">ALIAS (no_debug_bgp_normal,</a>
<a name="ln730">       undebug_bgp_normal_cmd,</a>
<a name="ln731">       &quot;undebug bgp&quot;,</a>
<a name="ln732">       UNDEBUG_STR</a>
<a name="ln733">       BGP_STR)</a>
<a name="ln734"> </a>
<a name="ln735">DEFUN (debug_bgp_zebra,</a>
<a name="ln736">       debug_bgp_zebra_cmd,</a>
<a name="ln737">       &quot;debug bgp zebra&quot;,</a>
<a name="ln738">       DEBUG_STR</a>
<a name="ln739">       BGP_STR</a>
<a name="ln740">       &quot;BGP Zebra messages\n&quot;)</a>
<a name="ln741">{</a>
<a name="ln742">  if (vty-&gt;node == CONFIG_NODE)</a>
<a name="ln743">    DEBUG_ON (zebra, ZEBRA);</a>
<a name="ln744">  else</a>
<a name="ln745">    {</a>
<a name="ln746">      TERM_DEBUG_ON (zebra, ZEBRA);</a>
<a name="ln747">      vty_out (vty, &quot;BGP zebra debugging is on%s&quot;, VTY_NEWLINE);</a>
<a name="ln748">    }</a>
<a name="ln749">  return CMD_SUCCESS;</a>
<a name="ln750">}</a>
<a name="ln751"> </a>
<a name="ln752">DEFUN (no_debug_bgp_zebra,</a>
<a name="ln753">       no_debug_bgp_zebra_cmd,</a>
<a name="ln754">       &quot;no debug bgp zebra&quot;,</a>
<a name="ln755">       NO_STR</a>
<a name="ln756">       DEBUG_STR</a>
<a name="ln757">       BGP_STR</a>
<a name="ln758">       &quot;BGP Zebra messages\n&quot;)</a>
<a name="ln759">{</a>
<a name="ln760">  if (vty-&gt;node == CONFIG_NODE)</a>
<a name="ln761">    DEBUG_OFF (zebra, ZEBRA);</a>
<a name="ln762">  else</a>
<a name="ln763">    {</a>
<a name="ln764">      TERM_DEBUG_OFF (zebra, ZEBRA);</a>
<a name="ln765">      vty_out (vty, &quot;BGP zebra debugging is off%s&quot;, VTY_NEWLINE);</a>
<a name="ln766">    }</a>
<a name="ln767">  return CMD_SUCCESS;</a>
<a name="ln768">}</a>
<a name="ln769"> </a>
<a name="ln770">ALIAS (no_debug_bgp_zebra,</a>
<a name="ln771">       undebug_bgp_zebra_cmd,</a>
<a name="ln772">       &quot;undebug bgp zebra&quot;,</a>
<a name="ln773">       UNDEBUG_STR</a>
<a name="ln774">       BGP_STR</a>
<a name="ln775">       &quot;BGP Zebra messages\n&quot;)</a>
<a name="ln776"> </a>
<a name="ln777">DEFUN (debug_bgp_allow_martians,</a>
<a name="ln778">       debug_bgp_allow_martians_cmd,</a>
<a name="ln779">       &quot;debug bgp allow-martians&quot;,</a>
<a name="ln780">       DEBUG_STR</a>
<a name="ln781">       BGP_STR</a>
<a name="ln782">       &quot;BGP allow martian next hops\n&quot;)</a>
<a name="ln783">{</a>
<a name="ln784">  if (vty-&gt;node == CONFIG_NODE)</a>
<a name="ln785">    DEBUG_ON (allow_martians, ALLOW_MARTIANS);</a>
<a name="ln786">  else</a>
<a name="ln787">    {</a>
<a name="ln788">      TERM_DEBUG_ON (allow_martians, ALLOW_MARTIANS);</a>
<a name="ln789">      vty_out (vty, &quot;BGP allow_martian next hop debugging is on%s&quot;, VTY_NEWLINE);</a>
<a name="ln790">    }</a>
<a name="ln791">  return CMD_SUCCESS;</a>
<a name="ln792">}</a>
<a name="ln793"> </a>
<a name="ln794">DEFUN (no_debug_bgp_allow_martians,</a>
<a name="ln795">       no_debug_bgp_allow_martians_cmd,</a>
<a name="ln796">       &quot;no debug bgp allow-martians&quot;,</a>
<a name="ln797">       NO_STR</a>
<a name="ln798">       DEBUG_STR</a>
<a name="ln799">       BGP_STR</a>
<a name="ln800">       &quot;BGP allow martian next hops\n&quot;)</a>
<a name="ln801">{</a>
<a name="ln802">  if (vty-&gt;node == CONFIG_NODE)</a>
<a name="ln803">    DEBUG_OFF (allow_martians, ALLOW_MARTIANS);</a>
<a name="ln804">  else</a>
<a name="ln805">    {</a>
<a name="ln806">      TERM_DEBUG_OFF (allow_martians, ALLOW_MARTIANS);</a>
<a name="ln807">      vty_out (vty, &quot;BGP allow martian next hop debugging is off%s&quot;, VTY_NEWLINE);</a>
<a name="ln808">    }</a>
<a name="ln809">  return CMD_SUCCESS;</a>
<a name="ln810">}</a>
<a name="ln811"> </a>
<a name="ln812">ALIAS (no_debug_bgp_allow_martians,</a>
<a name="ln813">       undebug_bgp_allow_martians_cmd,</a>
<a name="ln814">       &quot;undebug bgp allow-martians&quot;,</a>
<a name="ln815">       UNDEBUG_STR</a>
<a name="ln816">       BGP_STR</a>
<a name="ln817">       &quot;BGP allow martian next hops\n&quot;)</a>
<a name="ln818"> </a>
<a name="ln819">DEFUN (no_debug_bgp_all,</a>
<a name="ln820">       no_debug_bgp_all_cmd,</a>
<a name="ln821">       &quot;no debug all bgp&quot;,</a>
<a name="ln822">       NO_STR</a>
<a name="ln823">       DEBUG_STR</a>
<a name="ln824">       &quot;Enable all debugging\n&quot;</a>
<a name="ln825">       BGP_STR)</a>
<a name="ln826">{</a>
<a name="ln827">  TERM_DEBUG_OFF (normal, NORMAL);</a>
<a name="ln828">  TERM_DEBUG_OFF (events, EVENTS);</a>
<a name="ln829">  TERM_DEBUG_OFF (keepalive, KEEPALIVE);</a>
<a name="ln830">  TERM_DEBUG_OFF (update, UPDATE_IN);</a>
<a name="ln831">  TERM_DEBUG_OFF (update, UPDATE_OUT);</a>
<a name="ln832">  TERM_DEBUG_OFF (as4, AS4);</a>
<a name="ln833">  TERM_DEBUG_OFF (as4, AS4_SEGMENT);</a>
<a name="ln834">  TERM_DEBUG_OFF (fsm, FSM);</a>
<a name="ln835">  TERM_DEBUG_OFF (filter, FILTER);</a>
<a name="ln836">  TERM_DEBUG_OFF (zebra, ZEBRA);</a>
<a name="ln837">  TERM_DEBUG_OFF (allow_martians, ALLOW_MARTIANS);</a>
<a name="ln838">  vty_out (vty, &quot;All possible debugging has been turned off%s&quot;, VTY_NEWLINE);</a>
<a name="ln839">      </a>
<a name="ln840">  return CMD_SUCCESS;</a>
<a name="ln841">}</a>
<a name="ln842"> </a>
<a name="ln843">ALIAS (no_debug_bgp_all,</a>
<a name="ln844">       undebug_bgp_all_cmd,</a>
<a name="ln845">       &quot;undebug all bgp&quot;,</a>
<a name="ln846">       UNDEBUG_STR</a>
<a name="ln847">       &quot;Enable all debugging\n&quot;</a>
<a name="ln848">       BGP_STR)</a>
<a name="ln849"> </a>
<a name="ln850">DEFUN (show_debugging_bgp,</a>
<a name="ln851">       show_debugging_bgp_cmd,</a>
<a name="ln852">       &quot;show debugging bgp&quot;,</a>
<a name="ln853">       SHOW_STR</a>
<a name="ln854">       DEBUG_STR</a>
<a name="ln855">       BGP_STR)</a>
<a name="ln856">{</a>
<a name="ln857">  vty_out (vty, &quot;BGP debugging status:%s&quot;, VTY_NEWLINE);</a>
<a name="ln858"> </a>
<a name="ln859">  if (BGP_DEBUG (normal, NORMAL))</a>
<a name="ln860">    vty_out (vty, &quot;  BGP debugging is on%s&quot;, VTY_NEWLINE);</a>
<a name="ln861">  if (BGP_DEBUG (events, EVENTS))</a>
<a name="ln862">    vty_out (vty, &quot;  BGP events debugging is on%s&quot;, VTY_NEWLINE);</a>
<a name="ln863">  if (BGP_DEBUG (keepalive, KEEPALIVE))</a>
<a name="ln864">    vty_out (vty, &quot;  BGP keepalives debugging is on%s&quot;, VTY_NEWLINE);</a>
<a name="ln865">  if (BGP_DEBUG (update, UPDATE_IN) &amp;&amp; BGP_DEBUG (update, UPDATE_OUT))</a>
<a name="ln866">    vty_out (vty, &quot;  BGP updates debugging is on%s&quot;, VTY_NEWLINE);</a>
<a name="ln867">  else if (BGP_DEBUG (update, UPDATE_IN))</a>
<a name="ln868">    vty_out (vty, &quot;  BGP updates debugging is on (inbound)%s&quot;, VTY_NEWLINE);</a>
<a name="ln869">  else if (BGP_DEBUG (update, UPDATE_OUT))</a>
<a name="ln870">    vty_out (vty, &quot;  BGP updates debugging is on (outbound)%s&quot;, VTY_NEWLINE);</a>
<a name="ln871">  if (BGP_DEBUG (fsm, FSM))</a>
<a name="ln872">    vty_out (vty, &quot;  BGP fsm debugging is on%s&quot;, VTY_NEWLINE);</a>
<a name="ln873">  if (BGP_DEBUG (filter, FILTER))</a>
<a name="ln874">    vty_out (vty, &quot;  BGP filter debugging is on%s&quot;, VTY_NEWLINE);</a>
<a name="ln875">  if (BGP_DEBUG (zebra, ZEBRA))</a>
<a name="ln876">    vty_out (vty, &quot;  BGP zebra debugging is on%s&quot;, VTY_NEWLINE);</a>
<a name="ln877">  if (BGP_DEBUG (as4, AS4))</a>
<a name="ln878">    vty_out (vty, &quot;  BGP as4 debugging is on%s&quot;, VTY_NEWLINE);</a>
<a name="ln879">  if (BGP_DEBUG (as4, AS4_SEGMENT))</a>
<a name="ln880">    vty_out (vty, &quot;  BGP as4 aspath segment debugging is on%s&quot;, VTY_NEWLINE);</a>
<a name="ln881">  if (BGP_DEBUG (allow_martians, ALLOW_MARTIANS))</a>
<a name="ln882">    vty_out (vty, &quot;  BGP allow martian next hop debugging is on%s&quot;, VTY_NEWLINE);</a>
<a name="ln883">  if (BGP_DEBUG (nht, NHT))</a>
<a name="ln884">    vty_out (vty, &quot;  BGP next-hop tracking debugging is on%s&quot;, VTY_NEWLINE);</a>
<a name="ln885">  vty_out (vty, &quot;%s&quot;, VTY_NEWLINE);</a>
<a name="ln886">  return CMD_SUCCESS;</a>
<a name="ln887">}</a>
<a name="ln888"> </a>
<a name="ln889">static int</a>
<a name="ln890">bgp_config_write_debug (struct vty *vty)</a>
<a name="ln891">{</a>
<a name="ln892">  int write = 0;</a>
<a name="ln893"> </a>
<a name="ln894">  if (CONF_BGP_DEBUG (normal, NORMAL))</a>
<a name="ln895">    {</a>
<a name="ln896">      vty_out (vty, &quot;debug bgp%s&quot;, VTY_NEWLINE);</a>
<a name="ln897">      write++;</a>
<a name="ln898">    }</a>
<a name="ln899"> </a>
<a name="ln900">  if (CONF_BGP_DEBUG (as4, AS4))</a>
<a name="ln901">    {</a>
<a name="ln902">      vty_out (vty, &quot;debug bgp as4%s&quot;, VTY_NEWLINE);</a>
<a name="ln903">      write++;</a>
<a name="ln904">    }</a>
<a name="ln905"> </a>
<a name="ln906">  if (CONF_BGP_DEBUG (as4, AS4_SEGMENT))</a>
<a name="ln907">    {</a>
<a name="ln908">      vty_out (vty, &quot;debug bgp as4 segment%s&quot;, VTY_NEWLINE);</a>
<a name="ln909">      write++;</a>
<a name="ln910">    }</a>
<a name="ln911"> </a>
<a name="ln912">  if (CONF_BGP_DEBUG (events, EVENTS))</a>
<a name="ln913">    {</a>
<a name="ln914">      vty_out (vty, &quot;debug bgp events%s&quot;, VTY_NEWLINE);</a>
<a name="ln915">      write++;</a>
<a name="ln916">    }</a>
<a name="ln917"> </a>
<a name="ln918">  if (CONF_BGP_DEBUG (keepalive, KEEPALIVE))</a>
<a name="ln919">    {</a>
<a name="ln920">      vty_out (vty, &quot;debug bgp keepalives%s&quot;, VTY_NEWLINE);</a>
<a name="ln921">      write++;</a>
<a name="ln922">    }</a>
<a name="ln923"> </a>
<a name="ln924">  if (CONF_BGP_DEBUG (update, UPDATE_IN) &amp;&amp; CONF_BGP_DEBUG (update, UPDATE_OUT))</a>
<a name="ln925">    {</a>
<a name="ln926">      vty_out (vty, &quot;debug bgp updates%s&quot;, VTY_NEWLINE);</a>
<a name="ln927">      write++;</a>
<a name="ln928">    }</a>
<a name="ln929">  else if (CONF_BGP_DEBUG (update, UPDATE_IN))</a>
<a name="ln930">    {</a>
<a name="ln931">      vty_out (vty, &quot;debug bgp updates in%s&quot;, VTY_NEWLINE);</a>
<a name="ln932">      write++;</a>
<a name="ln933">    }</a>
<a name="ln934">  else if (CONF_BGP_DEBUG (update, UPDATE_OUT))</a>
<a name="ln935">    {</a>
<a name="ln936">      vty_out (vty, &quot;debug bgp updates out%s&quot;, VTY_NEWLINE);</a>
<a name="ln937">      write++;</a>
<a name="ln938">    }</a>
<a name="ln939"> </a>
<a name="ln940">  if (CONF_BGP_DEBUG (fsm, FSM))</a>
<a name="ln941">    {</a>
<a name="ln942">      vty_out (vty, &quot;debug bgp fsm%s&quot;, VTY_NEWLINE);</a>
<a name="ln943">      write++;</a>
<a name="ln944">    }</a>
<a name="ln945"> </a>
<a name="ln946">  if (CONF_BGP_DEBUG (filter, FILTER))</a>
<a name="ln947">    {</a>
<a name="ln948">      vty_out (vty, &quot;debug bgp filters%s&quot;, VTY_NEWLINE);</a>
<a name="ln949">      write++;</a>
<a name="ln950">    }</a>
<a name="ln951"> </a>
<a name="ln952">  if (CONF_BGP_DEBUG (zebra, ZEBRA))</a>
<a name="ln953">    {</a>
<a name="ln954">      vty_out (vty, &quot;debug bgp zebra%s&quot;, VTY_NEWLINE);</a>
<a name="ln955">      write++;</a>
<a name="ln956">    }</a>
<a name="ln957"> </a>
<a name="ln958">  if (CONF_BGP_DEBUG (allow_martians, ALLOW_MARTIANS))</a>
<a name="ln959">    {</a>
<a name="ln960">      vty_out (vty, &quot;debug bgp allow-martians%s&quot;, VTY_NEWLINE);</a>
<a name="ln961">      write++;</a>
<a name="ln962">    }</a>
<a name="ln963">  </a>
<a name="ln964">  if (CONF_BGP_DEBUG (nht, NHT))</a>
<a name="ln965">    {</a>
<a name="ln966">      vty_out (vty, &quot;debug bgp nht%s&quot;, VTY_NEWLINE);</a>
<a name="ln967">      write++;</a>
<a name="ln968">    }</a>
<a name="ln969"> </a>
<a name="ln970">  return write;</a>
<a name="ln971">}</a>
<a name="ln972"> </a>
<a name="ln973">static struct cmd_node debug_node =</a>
<a name="ln974">{</a>
<a name="ln975">  DEBUG_NODE,</a>
<a name="ln976">  &quot;&quot;,</a>
<a name="ln977">  1</a>
<a name="ln978">};</a>
<a name="ln979"> </a>
<a name="ln980">void</a>
<a name="ln981">bgp_debug_init (void)</a>
<a name="ln982">{</a>
<a name="ln983">  install_node (&amp;debug_node, bgp_config_write_debug);</a>
<a name="ln984"> </a>
<a name="ln985">  install_element (ENABLE_NODE, &amp;show_debugging_bgp_cmd);</a>
<a name="ln986"> </a>
<a name="ln987">  install_element (ENABLE_NODE, &amp;debug_bgp_as4_cmd);</a>
<a name="ln988">  install_element (CONFIG_NODE, &amp;debug_bgp_as4_cmd);</a>
<a name="ln989">  install_element (ENABLE_NODE, &amp;debug_bgp_as4_segment_cmd);</a>
<a name="ln990">  install_element (CONFIG_NODE, &amp;debug_bgp_as4_segment_cmd);</a>
<a name="ln991"> </a>
<a name="ln992">  install_element (ENABLE_NODE, &amp;debug_bgp_fsm_cmd);</a>
<a name="ln993">  install_element (CONFIG_NODE, &amp;debug_bgp_fsm_cmd);</a>
<a name="ln994">  install_element (ENABLE_NODE, &amp;debug_bgp_events_cmd);</a>
<a name="ln995">  install_element (CONFIG_NODE, &amp;debug_bgp_events_cmd);</a>
<a name="ln996">  install_element (ENABLE_NODE, &amp;debug_bgp_nht_cmd);</a>
<a name="ln997">  install_element (CONFIG_NODE, &amp;debug_bgp_nht_cmd);</a>
<a name="ln998">  install_element (ENABLE_NODE, &amp;debug_bgp_filter_cmd);</a>
<a name="ln999">  install_element (CONFIG_NODE, &amp;debug_bgp_filter_cmd);</a>
<a name="ln1000">  install_element (ENABLE_NODE, &amp;debug_bgp_keepalive_cmd);</a>
<a name="ln1001">  install_element (CONFIG_NODE, &amp;debug_bgp_keepalive_cmd);</a>
<a name="ln1002">  install_element (ENABLE_NODE, &amp;debug_bgp_update_cmd);</a>
<a name="ln1003">  install_element (CONFIG_NODE, &amp;debug_bgp_update_cmd);</a>
<a name="ln1004">  install_element (ENABLE_NODE, &amp;debug_bgp_update_direct_cmd);</a>
<a name="ln1005">  install_element (CONFIG_NODE, &amp;debug_bgp_update_direct_cmd);</a>
<a name="ln1006">  install_element (ENABLE_NODE, &amp;debug_bgp_normal_cmd);</a>
<a name="ln1007">  install_element (CONFIG_NODE, &amp;debug_bgp_normal_cmd);</a>
<a name="ln1008">  install_element (ENABLE_NODE, &amp;debug_bgp_zebra_cmd);</a>
<a name="ln1009">  install_element (CONFIG_NODE, &amp;debug_bgp_zebra_cmd);</a>
<a name="ln1010">  install_element (ENABLE_NODE, &amp;debug_bgp_allow_martians_cmd);</a>
<a name="ln1011">  install_element (CONFIG_NODE, &amp;debug_bgp_allow_martians_cmd);</a>
<a name="ln1012"> </a>
<a name="ln1013">  install_element (ENABLE_NODE, &amp;no_debug_bgp_as4_cmd);</a>
<a name="ln1014">  install_element (ENABLE_NODE, &amp;undebug_bgp_as4_cmd);</a>
<a name="ln1015">  install_element (CONFIG_NODE, &amp;no_debug_bgp_as4_cmd);</a>
<a name="ln1016">  install_element (ENABLE_NODE, &amp;no_debug_bgp_as4_segment_cmd);</a>
<a name="ln1017">  install_element (ENABLE_NODE, &amp;undebug_bgp_as4_segment_cmd);</a>
<a name="ln1018">  install_element (CONFIG_NODE, &amp;no_debug_bgp_as4_segment_cmd);</a>
<a name="ln1019"> </a>
<a name="ln1020">  install_element (ENABLE_NODE, &amp;no_debug_bgp_fsm_cmd);</a>
<a name="ln1021">  install_element (ENABLE_NODE, &amp;undebug_bgp_fsm_cmd);</a>
<a name="ln1022">  install_element (CONFIG_NODE, &amp;no_debug_bgp_fsm_cmd);</a>
<a name="ln1023">  install_element (ENABLE_NODE, &amp;no_debug_bgp_events_cmd);</a>
<a name="ln1024">  install_element (ENABLE_NODE, &amp;undebug_bgp_events_cmd);</a>
<a name="ln1025">  install_element (CONFIG_NODE, &amp;no_debug_bgp_events_cmd);</a>
<a name="ln1026">  install_element (ENABLE_NODE, &amp;no_debug_bgp_nht_cmd);</a>
<a name="ln1027">  install_element (ENABLE_NODE, &amp;undebug_bgp_nht_cmd);</a>
<a name="ln1028">  install_element (CONFIG_NODE, &amp;no_debug_bgp_nht_cmd);</a>
<a name="ln1029">  install_element (ENABLE_NODE, &amp;no_debug_bgp_filter_cmd);</a>
<a name="ln1030">  install_element (ENABLE_NODE, &amp;undebug_bgp_filter_cmd);</a>
<a name="ln1031">  install_element (CONFIG_NODE, &amp;no_debug_bgp_filter_cmd);</a>
<a name="ln1032">  install_element (ENABLE_NODE, &amp;no_debug_bgp_keepalive_cmd);</a>
<a name="ln1033">  install_element (ENABLE_NODE, &amp;undebug_bgp_keepalive_cmd);</a>
<a name="ln1034">  install_element (CONFIG_NODE, &amp;no_debug_bgp_keepalive_cmd);</a>
<a name="ln1035">  install_element (ENABLE_NODE, &amp;no_debug_bgp_update_cmd);</a>
<a name="ln1036">  install_element (ENABLE_NODE, &amp;undebug_bgp_update_cmd);</a>
<a name="ln1037">  install_element (CONFIG_NODE, &amp;no_debug_bgp_update_cmd);</a>
<a name="ln1038">  install_element (ENABLE_NODE, &amp;no_debug_bgp_normal_cmd);</a>
<a name="ln1039">  install_element (ENABLE_NODE, &amp;undebug_bgp_normal_cmd);</a>
<a name="ln1040">  install_element (CONFIG_NODE, &amp;no_debug_bgp_normal_cmd);</a>
<a name="ln1041">  install_element (ENABLE_NODE, &amp;no_debug_bgp_zebra_cmd);</a>
<a name="ln1042">  install_element (ENABLE_NODE, &amp;undebug_bgp_zebra_cmd);</a>
<a name="ln1043">  install_element (CONFIG_NODE, &amp;no_debug_bgp_zebra_cmd);</a>
<a name="ln1044">  install_element (ENABLE_NODE, &amp;no_debug_bgp_allow_martians_cmd);</a>
<a name="ln1045">  install_element (ENABLE_NODE, &amp;undebug_bgp_allow_martians_cmd);</a>
<a name="ln1046">  install_element (CONFIG_NODE, &amp;no_debug_bgp_allow_martians_cmd);</a>
<a name="ln1047">  install_element (ENABLE_NODE, &amp;no_debug_bgp_all_cmd);</a>
<a name="ln1048">  install_element (ENABLE_NODE, &amp;undebug_bgp_all_cmd);</a>
<a name="ln1049">}</a>

</code></pre>
<div class="balloon" rel="7"><p><span style="font-size:18px">&uarr;</span> <a href="https://pvs-studio.com/en/docs/warnings/v1042/" target="_blank">V1042</a> This file is marked with copyleft license, which requires you to open the derived source code.</p></div>

<link rel="stylesheet" href="highlight.css">
<script src="highlight.pack.js"></script>
<script src="highlightjs-line-numbers.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
<script>hljs.initLineNumbersOnLoad();</script>
<script>
  $(document).ready(function() {
      $('.balloon').each(function () {
          var bl = $(this);
          var line = bl.attr('rel');
          var text = $('a[name="ln'+line+'"]').text();

          var space_count = 0;
          for(var i = 0; i<text.length; i++){
              var char = text[i];
              if((char !== ' ')&&(char !== '\t'))break;
              if(char === '\t')space_count++;
              space_count++;
          }

          bl.css('margin-left', space_count*8);
          $('a[name="ln'+line+'"]').after(bl);
      });

      window.location = window.location;
  });
</script>
</body>
</html>
